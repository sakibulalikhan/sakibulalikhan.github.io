<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>denied - A Web Challenge Walkthrough from AmateursCTF 2024 - Offens!ve Blogs - Sakibul Ali Khan</title><meta name="description" content="The AmateursCTF 2024 had a tricky web puzzle called 'denied.' They gave us a file named index.js for this challenge. When we went to the&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="stylesheet" href="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/prism-black.css"><script type="text/javascript" async src="https://www.googletagmanager.com/gtag/js?id=G-BG46SGW391"></script><script type="text/javascript">window.dataLayer = window.dataLayer || [];
				  function gtag(){dataLayer.push(arguments);}
				  gtag('js', new Date());
				  gtag('config', 'G-BG46SGW391' , { 'anonymize_ip': true });
				  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BG46SGW391"></script><script>window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-BG46SGW391');</script><link rel="canonical" href="https://sakibulalikhan.pages.dev/denied-amateursctf-2024-writeup.html"><link rel="alternate" type="application/atom+xml" href="https://sakibulalikhan.pages.dev/feed.xml"><link rel="alternate" type="application/json" href="https://sakibulalikhan.pages.dev/feed.json"><meta property="og:title" content="denied - A Web Challenge Walkthrough from AmateursCTF 2024"><meta property="og:image" content="https://sakibulalikhan.pages.dev/media/posts/28/CTF_WEB_5_April-2.png"><meta property="og:image:width" content="1150"><meta property="og:image:height" content="422"><meta property="og:site_name" content="Offens!ve Blogs - Sakibul Ali Khan"><meta property="og:description" content="The AmateursCTF 2024 had a tricky web puzzle called 'denied.' They gave us a file named index.js for this challenge. When we went to the&hellip;"><meta property="og:url" content="https://sakibulalikhan.pages.dev/denied-amateursctf-2024-writeup.html"><meta property="og:type" content="article"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@sakibulalikhan"><meta name="twitter:title" content="denied - A Web Challenge Walkthrough from AmateursCTF 2024"><meta name="twitter:description" content="The AmateursCTF 2024 had a tricky web puzzle called 'denied.' They gave us a file named index.js for this challenge. When we went to the&hellip;"><meta name="twitter:image" content="https://sakibulalikhan.pages.dev/media/posts/28/CTF_WEB_5_April-2.png"><link rel="shortcut icon" href="https://sakibulalikhan.pages.dev/media/website/pen-tux.png" type="image/png"><link rel="preload" href="https://sakibulalikhan.pages.dev/assets/dynamic/fonts/montserrat/montserrat.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="https://sakibulalikhan.pages.dev/assets/dynamic/fonts/montserrat/montserrat-italic.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://sakibulalikhan.pages.dev/assets/css/style.css?v=02cd692510ca9aa8d5354f2181132b2a"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://sakibulalikhan.pages.dev/denied-amateursctf-2024-writeup.html"},"headline":"denied - A Web Challenge Walkthrough from AmateursCTF 2024","datePublished":"2024-04-06T00:57+06:00","dateModified":"2024-04-07T23:35+06:00","image":{"@type":"ImageObject","url":"https://sakibulalikhan.pages.dev/media/posts/28/CTF_WEB_5_April-2.png","height":422,"width":1150},"description":"The AmateursCTF 2024 had a tricky web puzzle called 'denied.' They gave us a file named index.js for this challenge. When we went to the&hellip;","author":{"@type":"Person","name":"Sakibul Ali Khan","url":"https://sakibulalikhan.pages.dev/authors/sakibulalikhan/"},"publisher":{"@type":"Organization","name":"Sakibul Ali Khan","logo":{"@type":"ImageObject","url":"https://sakibulalikhan.pages.dev/media/website/pen-tux-2.png","height":500,"width":500}}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript><script type="text/javascript">(function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "kza4v42pst");</script><style>.extlink::after {
				background-color: currentColor;
				content: "";
				display: inline-block;
				height: 16px; 
				margin-left: 5px;
				position: relative;
				top: 0px;
				width: 16px; 
			}
		.extlink.extlink-icon-5::after { mask-image: url("data:image/svg+xml;utf8,<svg viewBox='0 0 24 24' fill='none' stroke='%23000000' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' xmlns='http://www.w3.org/2000/svg'><path d='M22 12A10 10 0 1 1 12 2'/><path d='M22 2 12 12'/><path d='M16 2h6v6'/></svg>"); }</style></head><body class="post-template"><div class="container container--center"><script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="sakibulalikhan" data-description="Support me on Buy me a coffee!" data-message="" data-color="#FF813F" data-position="Right" data-x_margin="18" data-y_margin="18"></script><script defer="defer" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"token": "22757d4facf2459dbb19685ef5c4bae1"}'></script><script src="https://mpeztrack.com/v1.0.0/eztrack.min.js" type="text/javascript"></script><script>mpEZTrack.init("3799246d338f6a319e081a697ab7eca4");</script><header class="header"><div class="header__logo"><a class="logo" href="https://sakibulalikhan.pages.dev/"><img src="https://sakibulalikhan.pages.dev/media/website/pen-tux-2.png" alt="Offens!ve Blogs - Sakibul Ali Khan" width="500" height="500"></a></div><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://sakibulalikhan.pages.dev/" target="_self">Home</a></li><li class="has-submenu"><a href="https://sakibulalikhan.pages.dev/tags/ctf-writeups/" target="_self" aria-haspopup="true">CTF Writeups</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://sakibulalikhan.pages.dev/tags/hackthebox/" title="HackTheBox" target="_self">HackTheBox</a></li><li><a href="https://sakibulalikhan.pages.dev/tags/tryhackme/" title="TryHackMe" target="_self">TryHackMe</a></li><li><a href="https://sakibulalikhan.pages.dev/tags/hackviser/" title="Hackviser" target="_self">Hackviser</a></li><li><a href="https://sakibulalikhan.pages.dev/tags/ctftime/" title="CTFtime" target="_self">CTFtime</a></li></ul></li><li><a href="https://sakibulalikhan.pages.dev/about.html" title="About Me" target="_self">About</a></li><li><a href="https://docs.google.com/document/d/10NGJ-Hn7zm6TEEfJIg3K3gqg3wLZ-6BLT77npYOHm4k/edit" title="Sakibul Ali Khan - Resume" target="_blank" rel="Sakibul Ali Khan">Resume</a></li><li><a href="https://sakibulalikhan.pages.dev/contact.html" title="Contact" target="_self">Contact</a></li></ul></nav></header><main class="content"><article class="post"><header><h1 class="post__title">denied - A Web Challenge Walkthrough from AmateursCTF 2024</h1><div class="post__meta"><time datetime="2024-04-06T00:57" class="post__date">Apr 6, 2024 </time><span class="post__author"><a href="https://sakibulalikhan.pages.dev/authors/sakibulalikhan/" class="feed__author">Sakibul Ali Khan</a></span></div><div class="post__tags"><a href="https://sakibulalikhan.pages.dev/tags/ctf-writeups/" class="invert">CTF Writeups</a> <a href="https://sakibulalikhan.pages.dev/tags/ctftime/" class="invert">CTFtime</a> <a href="https://sakibulalikhan.pages.dev/tags/web-security/" class="invert">Web Security</a></div></header><figure class="post__image post__cover"><img src="https://sakibulalikhan.pages.dev/media/posts/28/CTF_WEB_5_April-2.png" srcset="https://sakibulalikhan.pages.dev/media/posts/28/responsive/CTF_WEB_5_April-2-xs.png 300w, https://sakibulalikhan.pages.dev/media/posts/28/responsive/CTF_WEB_5_April-2-sm.png 480w, https://sakibulalikhan.pages.dev/media/posts/28/responsive/CTF_WEB_5_April-2-md.png 768w, https://sakibulalikhan.pages.dev/media/posts/28/responsive/CTF_WEB_5_April-2-lg.png 1024w" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" loading="eager" height="422" width="1150" alt="denied - A Web Challenge Walkthrough from AmateursCTF 2024"></figure><div class="post__entry"><p>The AmateursCTF 2024 had a tricky web puzzle called "denied." They gave us a file named index.js for this challenge. When we went to the website, all we saw was a message saying <code>Bad!</code> Nothing else, even when we peeked at the code behind the page.</p><figure class="post__image"><img decoding="async" loading="lazy" src="https://sakibulalikhan.pages.dev/media/posts/28/Screenshot-2024-04-06-010542.png" alt="denied - AmateursCTF 2024 Writeup" width="1918" height="663" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://sakibulalikhan.pages.dev/media/posts/28/responsive/Screenshot-2024-04-06-010542-xs.png 300w, https://sakibulalikhan.pages.dev/media/posts/28/responsive/Screenshot-2024-04-06-010542-sm.png 480w, https://sakibulalikhan.pages.dev/media/posts/28/responsive/Screenshot-2024-04-06-010542-md.png 768w, https://sakibulalikhan.pages.dev/media/posts/28/responsive/Screenshot-2024-04-06-010542-lg.png 1024w"></figure><p>Let's checked out the <code>index.js</code> file to see what it was hiding:</p><p><strong>index.js:</strong></p><pre class="language-javascript line-numbers"><code>const express = require('express')
const app = express()
const port = 3000

app.get('/', (req, res) =&gt; {
  if (req.method == "GET") return res.send("Bad!");
  res.cookie('flag', process.env.FLAG ?? "flag{fake_flag}")
  res.send('Winner!')
})

app.listen(port, () =&gt; {
  console.log(`Example app listening on port ${port}`)
})</code></pre><p>This code sets up a basic Express.js server. It listens on port 3000. When you visit the root URL ("/") with a GET request, it checks if the request method is GET; if it is, it sends "Bad!" as the response. Otherwise, it sets a cookie named 'flag' with the value from the environment variable <code>process.env.FLAG</code>, or if that's not set, it uses "flag{fake_flag}". Finally, it sends "Winner!" as the response.</p><p>We decided to use a tool called BurpSuite to help us out. We intercepted and replayed requests using BurpSuite's Repeater, trying different methods.</p><figure class="post__image"><img decoding="async" loading="lazy" src="https://sakibulalikhan.pages.dev/media/posts/28/Screenshot-2024-04-06-010847.png" alt="denied - AmateursCTF 2024 Writeup" width="525" height="279" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://sakibulalikhan.pages.dev/media/posts/28/responsive/Screenshot-2024-04-06-010847-xs.png 300w, https://sakibulalikhan.pages.dev/media/posts/28/responsive/Screenshot-2024-04-06-010847-sm.png 480w, https://sakibulalikhan.pages.dev/media/posts/28/responsive/Screenshot-2024-04-06-010847-md.png 768w, https://sakibulalikhan.pages.dev/media/posts/28/responsive/Screenshot-2024-04-06-010847-lg.png 1024w"></figure><p>After a few tries, we found out that only <code>GET</code> and <code>HEAD</code> methods worked, as shown by an <code>OPTIONS</code> request.</p><p>We went with the <code>HEAD</code> method and, lo and behold, we found a hidden, URL-encoded flag!</p><figure class="post__image"><img decoding="async" loading="lazy" src="https://sakibulalikhan.pages.dev/media/posts/28/Screenshot-2024-04-06-012005.png" alt="denied - AmateursCTF 2024 Writeup" width="549" height="292" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://sakibulalikhan.pages.dev/media/posts/28/responsive/Screenshot-2024-04-06-012005-xs.png 300w, https://sakibulalikhan.pages.dev/media/posts/28/responsive/Screenshot-2024-04-06-012005-sm.png 480w, https://sakibulalikhan.pages.dev/media/posts/28/responsive/Screenshot-2024-04-06-012005-md.png 768w, https://sakibulalikhan.pages.dev/media/posts/28/responsive/Screenshot-2024-04-06-012005-lg.png 1024w"></figure><p>To decode the flag, we used BurpSuite's <code>Decoder</code> feature and selected "Decode as URL" from the menu.</p><figure class="post__image"><img decoding="async" loading="lazy" src="https://sakibulalikhan.pages.dev/media/posts/28/Screenshot-2024-04-06-012243.png" alt="denied - AmateursCTF 2024 Writeup" width="554" height="153" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://sakibulalikhan.pages.dev/media/posts/28/responsive/Screenshot-2024-04-06-012243-xs.png 300w, https://sakibulalikhan.pages.dev/media/posts/28/responsive/Screenshot-2024-04-06-012243-sm.png 480w, https://sakibulalikhan.pages.dev/media/posts/28/responsive/Screenshot-2024-04-06-012243-md.png 768w, https://sakibulalikhan.pages.dev/media/posts/28/responsive/Screenshot-2024-04-06-012243-lg.png 1024w"></figure><p>And there it was, the secret CTF challenge flag, decoded and ready for victory!</p><p>In the end, cracking the "Denied" challenge at AmateursCTF 2024 taught us the importance of not giving up and using our brains. By playing around with different methods and tools like BurpSuite, we were able to solve the puzzle and win. This challenge showed us that persistence and thinking outside the box are key in the world of cybersecurity puzzles.</p><p> </p></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on Apr 7, 2024</p><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fsakibulalikhan.pages.dev%2Fdenied-amateursctf-2024-writeup.html" class="js-share invert facebook" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#facebook"/></svg> <span>Facebook</span> </a><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Fdenied-amateursctf-2024-writeup.html&amp;via=sakibulalikhan&amp;text=denied%20-%20A%20Web%20Challenge%20Walkthrough%20from%20AmateursCTF%202024" class="js-share invert twitter" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#twitter"/></svg> <span>Twitter</span> </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Fdenied-amateursctf-2024-writeup.html&amp;media=https%3A%2F%2Fsakibulalikhan.pages.dev%2Fmedia%2Fposts%2F28%2FCTF_WEB_5_April-2.png&amp;description=denied%20-%20A%20Web%20Challenge%20Walkthrough%20from%20AmateursCTF%202024" class="js-share invert pinterest" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#pinterest"/></svg> <span>Pinterest</span> </a><a href="https://mix.com/add?url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Fdenied-amateursctf-2024-writeup.html" class="js-share invert mix" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#mix"/></svg> <span>Mix</span> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Fdenied-amateursctf-2024-writeup.html" class="js-share invert linkedin" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#linkedin"/></svg> <span>LinkedIn</span> </a><a href="https://buffer.com/add?text=denied%20-%20A%20Web%20Challenge%20Walkthrough%20from%20AmateursCTF%202024&amp;url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Fdenied-amateursctf-2024-writeup.html" class="js-share invert buffer" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#buffer"/></svg> <span>Buffer</span> </a><a href="https://api.whatsapp.com/send?text=denied%20-%20A%20Web%20Challenge%20Walkthrough%20from%20AmateursCTF%202024 https%3A%2F%2Fsakibulalikhan.pages.dev%2Fdenied-amateursctf-2024-writeup.html" class="js-share invert whatsapp" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#whatsapp"/></svg> <span>WhatsApp</span></a></div></footer><nav class="pagination"><div class="pagination__title"><span>Read other posts</span></div><div class="pagination__buttons"><a href="https://sakibulalikhan.pages.dev/makeshift-cyber-apocalypse-2024-hacker-royale-ctf-writeup.html" class="btn previous" rel="prev" aria-label="[MISSING TRANSLATION]:  Makeshift - Cyber Apocalypse 2024: Hacker Royale CTF Writeup "><span class="btn__icon">←</span> <span class="btn__text">Makeshift - Cyber Apocalypse 2024: Hacker Royale CTF Writeup</span> </a><a href="https://sakibulalikhan.pages.dev/optimize-battery-health-how-to-set-charge-thresholds-for-asus-laptops-on-linux-made-easy.html" class="btn next" rel="next" aria-label="[MISSING TRANSLATION]:  Optimize Battery Health: How to Set Charge Thresholds for ASUS Laptops on Linux Made Easy "><span class="btn__text">Optimize Battery Health: How to Set Charge Thresholds for ASUS Laptops on Linux Made Easy</span> <span class="btn__icon">→</span></a></div></nav></article><div class="post__comments"><div class="comments"><div class="comments-wrapper"><h2>Comments</h2><div id="disqus_thread"></div><noscript>Please enable JS to use the comments form.</noscript><script type="text/javascript">var disqus_config = function () {
							this.page.url = 'https://sakibulalikhan.pages.dev/denied-amateursctf-2024-writeup.html';
							this.page.identifier = '28'; 
							this.language = 'en_US';
						};
						
						
				var disqus_element_to_check = document.getElementById('disqus_thread');

				if ('IntersectionObserver' in window) {
					var iObserver = new IntersectionObserver(
						(entries, observer) => {
							entries.forEach(entry => {
								if (entry.intersectionRatio >= 0.1) {
									(function () {
										var d = document, s = d.createElement('script');
										s.src = 'https://'+('sakibulalikhan-github-io').trim()+'.disqus.com/embed.js';
										s.setAttribute('data-timestamp', +new Date());
										(d.head || d.body).appendChild(s);
									})();
									observer.unobserve(entry.target);
								}
							});
						},
						{
							threshold: [0, 0.2, 0.5, 1]
						}
					);

					iObserver.observe(disqus_element_to_check);
				} else {
					(function () {
						var d = document, s = d.createElement('script');
						s.src = 'https://'+('sakibulalikhan-github-io').trim()+'.disqus.com/embed.js';
						s.setAttribute('data-timestamp', +new Date());
						(d.head || d.body).appendChild(s);
					})();
				}</script><script type="text/javascript"></script></div></div></div></main><footer class="footer"><div class="footer__inner"><div class="footer__copyright"><p class="align-center">Sakibul Ali Khan • © 2024 • Offens!ve Blogs</p></div></div></footer></div><script defer="defer" src="https://sakibulalikhan.pages.dev/assets/js/scripts.min.js?v=c2232aa7558e9517946129d2a1b8c770"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script><script defer="defer" src="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/prism.js"></script><script defer="defer" src="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/prism-line-numbers.min.js"></script><script defer="defer" src="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/clipboard.min.js"></script><script defer="defer" src="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/prism-copy-to-clipboard.min.js"></script><script src="https://sakibulalikhan.pages.dev/media/plugins/pagePrefetching/quicklink.umd.js"></script><script>window.addEventListener('load', () => {
					quicklink.listen({
						prerender: false,
						el: document.querySelector('body'),
						delay: 0,
						limit: Infinity,
						throttle: Infinity,
						timeout: 2000
					});
				});</script></body></html>