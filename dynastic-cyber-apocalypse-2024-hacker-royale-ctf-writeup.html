<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Dynastic - Cyber Apocalypse 2024: Hacker Royale CTF Writeup - Offens!ve Blogs - Sakibul Ali Khan</title><meta name="description" content="In the heart of the Cyber Apocalypse 2024: Hacker Royale CTF by HackTheBox, participants were thrust into a life-or-death scenario with the “Dynastic” challenge. With&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="stylesheet" href="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/prism-black.css"><link rel="canonical" href="https://sakibulalikhan.pages.dev/dynastic-cyber-apocalypse-2024-hacker-royale-ctf-writeup.html"><link rel="alternate" type="application/atom+xml" href="https://sakibulalikhan.pages.dev/feed.xml"><link rel="alternate" type="application/json" href="https://sakibulalikhan.pages.dev/feed.json"><meta property="og:title" content="Dynastic - Cyber Apocalypse 2024: Hacker Royale CTF Writeup"><meta property="og:image" content="https://sakibulalikhan.pages.dev/media/posts/26/Dynastic-Cyber-Apocalypse-2024-Hacker-Royale-CTF-Writeup.png"><meta property="og:image:width" content="1582"><meta property="og:image:height" content="828"><meta property="og:site_name" content="Offens!ve Blogs - Sakibul Ali Khan"><meta property="og:description" content="In the heart of the Cyber Apocalypse 2024: Hacker Royale CTF by HackTheBox, participants were thrust into a life-or-death scenario with the “Dynastic” challenge. With&hellip;"><meta property="og:url" content="https://sakibulalikhan.pages.dev/dynastic-cyber-apocalypse-2024-hacker-royale-ctf-writeup.html"><meta property="og:type" content="article"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@sakibulalikhan"><meta name="twitter:title" content="Dynastic - Cyber Apocalypse 2024: Hacker Royale CTF Writeup"><meta name="twitter:description" content="In the heart of the Cyber Apocalypse 2024: Hacker Royale CTF by HackTheBox, participants were thrust into a life-or-death scenario with the “Dynastic” challenge. With&hellip;"><meta name="twitter:image" content="https://sakibulalikhan.pages.dev/media/posts/26/Dynastic-Cyber-Apocalypse-2024-Hacker-Royale-CTF-Writeup.png"><link rel="shortcut icon" href="https://sakibulalikhan.pages.dev/media/website/pen-tux.png" type="image/png"><link rel="preload" href="https://sakibulalikhan.pages.dev/assets/dynamic/fonts/montserrat/montserrat.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="https://sakibulalikhan.pages.dev/assets/dynamic/fonts/montserrat/montserrat-italic.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://sakibulalikhan.pages.dev/assets/css/style.css?v=02cd692510ca9aa8d5354f2181132b2a"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://sakibulalikhan.pages.dev/dynastic-cyber-apocalypse-2024-hacker-royale-ctf-writeup.html"},"headline":"Dynastic - Cyber Apocalypse 2024: Hacker Royale CTF Writeup","datePublished":"2024-03-16T05:29","dateModified":"2024-03-16T05:29","image":{"@type":"ImageObject","url":"https://sakibulalikhan.pages.dev/media/posts/26/Dynastic-Cyber-Apocalypse-2024-Hacker-Royale-CTF-Writeup.png","height":828,"width":1582},"description":"In the heart of the Cyber Apocalypse 2024: Hacker Royale CTF by HackTheBox, participants were thrust into a life-or-death scenario with the “Dynastic” challenge. With&hellip;","author":{"@type":"Person","name":"Sakibul Ali Khan","url":"https://sakibulalikhan.pages.dev/authors/sakibulalikhan/"},"publisher":{"@type":"Organization","name":"Sakibul Ali Khan","logo":{"@type":"ImageObject","url":"https://sakibulalikhan.pages.dev/media/website/pen-tux-2.png","height":500,"width":500}}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript><script type="text/javascript">(function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "kza4v42pst");</script><style>.extlink::after {
				background-color: currentColor;
				content: "";
				display: inline-block;
				height: 16px; 
				margin-left: 5px;
				position: relative;
				top: 0px;
				width: 16px; 
			}
		.extlink.extlink-icon-5::after { mask-image: url("data:image/svg+xml;utf8,<svg viewBox='0 0 24 24' fill='none' stroke='%23000000' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' xmlns='http://www.w3.org/2000/svg'><path d='M22 12A10 10 0 1 1 12 2'/><path d='M22 2 12 12'/><path d='M16 2h6v6'/></svg>"); }</style></head><body class="post-template"><div class="container container--center"><script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="sakibulalikhan" data-description="Support me on Buy me a coffee!" data-message="" data-color="#FF813F" data-position="Right" data-x_margin="18" data-y_margin="18"></script><script defer="defer" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"token": "22757d4facf2459dbb19685ef5c4bae1"}'></script><script src="https://mpeztrack.com/v1.0.0/eztrack.min.js" type="text/javascript"></script><script>mpEZTrack.init("3799246d338f6a319e081a697ab7eca4");</script><header class="header"><div class="header__logo"><a class="logo" href="https://sakibulalikhan.pages.dev/"><img src="https://sakibulalikhan.pages.dev/media/website/pen-tux-2.png" alt="Offens!ve Blogs - Sakibul Ali Khan" width="500" height="500"></a></div><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://sakibulalikhan.pages.dev/" target="_self">Home</a></li><li class="has-submenu"><a href="https://sakibulalikhan.pages.dev/tags/ctf-writeups/" target="_self" aria-haspopup="true">CTF Writeups</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://sakibulalikhan.pages.dev/tags/hackthebox/" title="HackTheBox" target="_self">HackTheBox</a></li><li><a href="https://sakibulalikhan.pages.dev/tags/tryhackme/" title="TryHackMe" target="_self">TryHackMe</a></li><li><a href="https://sakibulalikhan.pages.dev/tags/hackviser/" title="Hackviser" target="_self">Hackviser</a></li><li><a href="https://sakibulalikhan.pages.dev/tags/ctftime/" title="CTFtime" target="_self">CTFtime</a></li></ul></li><li><a href="" title="About Me" target="_self">About</a></li><li><a href="https://docs.google.com/document/d/10NGJ-Hn7zm6TEEfJIg3K3gqg3wLZ-6BLT77npYOHm4k/edit" title="Sakibul Ali Khan - Resume" target="_blank" rel="Sakibul Ali Khan">Resume</a></li><li><a href="" title="Contact" target="_self">Contact</a></li></ul></nav></header><main class="content"><article class="post"><header><h1 class="post__title">Dynastic - Cyber Apocalypse 2024: Hacker Royale CTF Writeup</h1><div class="post__meta"><time datetime="2024-03-16T05:29" class="post__date">Mar 16, 2024 </time><span class="post__author"><a href="https://sakibulalikhan.pages.dev/authors/sakibulalikhan/" class="feed__author">Sakibul Ali Khan</a></span></div><div class="post__tags"><a href="https://sakibulalikhan.pages.dev/tags/crypto/" class="invert">Crypto</a> <a href="https://sakibulalikhan.pages.dev/tags/ctf-writeups/" class="invert">CTF Writeups</a> <a href="https://sakibulalikhan.pages.dev/tags/ctftime/" class="invert">CTFtime</a> <a href="https://sakibulalikhan.pages.dev/tags/hackthebox/" class="invert">HackTheBox</a></div></header><figure class="post__image post__cover"><img src="https://sakibulalikhan.pages.dev/media/posts/26/Dynastic-Cyber-Apocalypse-2024-Hacker-Royale-CTF-Writeup.png" srcset="https://sakibulalikhan.pages.dev/media/posts/26/responsive/Dynastic-Cyber-Apocalypse-2024-Hacker-Royale-CTF-Writeup-xs.png 300w, https://sakibulalikhan.pages.dev/media/posts/26/responsive/Dynastic-Cyber-Apocalypse-2024-Hacker-Royale-CTF-Writeup-sm.png 480w, https://sakibulalikhan.pages.dev/media/posts/26/responsive/Dynastic-Cyber-Apocalypse-2024-Hacker-Royale-CTF-Writeup-md.png 768w, https://sakibulalikhan.pages.dev/media/posts/26/responsive/Dynastic-Cyber-Apocalypse-2024-Hacker-Royale-CTF-Writeup-lg.png 1024w" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" loading="eager" height="828" width="1582" alt="Dynastic - Cyber Apocalypse 2024: Hacker Royale CTF Writeup"></figure><div class="post__entry"><div class="cl-preview-section"><p>In the heart of the Cyber Apocalypse 2024: Hacker Royale CTF by HackTheBox, participants were thrust into a life-or-death scenario with the “Dynastic” challenge. With time ticking away and a lethal gas threatening to fill the chamber, the players had to decrypt a mysterious message to unlock their way to safety. Let’s dive into the eerie world of “Dynastic” and unravel its secrets.</p></div><div class="cl-preview-section"><p><strong>Challenge Description:</strong></p></div><div class="cl-preview-section"><p>Upon entering the challenge, participants found themselves trapped in a sealed gas chamber. A foreboding message revealed that within minutes, the chamber would be filled with deadly hydrogen cyanide. To escape this grim fate, they needed to unlock both the handcuffs restraining them and the exit door, using the same elusive passcode. The only clue: cryptic letters etched into the walls and a disturbing image of a Roman emperor.</p></div><div class="cl-preview-section"><p><strong>The Journey Begins:</strong></p></div><div class="cl-preview-section"><p>To decrypt the passcode, participants were provided with a Python script named <code>source.py</code> and an output file <code>output.txt</code>. The script revealed a custom encryption method based on an identity mapping scheme, encrypting the flag provided in <code>FLAG</code> variable.</p></div><div class="cl-preview-section"><pre class="language-python line-numbers"><code>from secret import FLAG
from random import randint

def to_identity_map(a):
    return ord(a) - 0x41

def from_identity_map(a):
    return chr(a % 26 + 0x41)

def encrypt(m):
    c = ''
    for i in range(len(m)):
        ch = m[i]
        if not ch.isalpha():
            ech = ch
        else:
            chi = to_identity_map(ch)
            ech = from_identity_map(chi + i)
        c += ech
    return c

with open('output.txt', 'w') as f:
    f.write('Make sure you wrap the decrypted text with the HTB flag format :-]\n')
    f.write(encrypt(FLAG))
</code></pre></div><div class="cl-preview-section"><p>The output file <code>output.txt</code> contained the encrypted message, hinting at the form of the final flag.</p></div><div class="cl-preview-section"><pre><code>Make sure you wrap the decrypted text with the HTB flag format :-]
DJF_CTA_SWYH_NPDKK_MBZ_QPHTIGPMZY_KRZSQE?!_ZL_CN_PGLIMCU_YU_KJODME_RYGZXL
</code></pre></div><div class="cl-preview-section"><p><strong>Cracking the Code:</strong></p></div><div class="cl-preview-section"><p>To decipher the encrypted message and obtain the flag, participants needed to reverse engineer the encryption process. Armed with the provided <code>to_identity_map</code> and <code>from_identity_map</code> functions, they could decrypt the ciphertext.</p></div><div class="cl-preview-section"><pre class="language-python line-numbers"><code>def to_identity_map(a):
    return ord(a) - 0x41

def from_identity_map(a):
    return chr(a % 26 + 0x41)

def decrypt(ciphertext):
    m = ''
    for i in range(len(ciphertext)):
        ch = ciphertext[i]
        if not ch.isalpha():
            dch = ch
        else:
            dchi = from_identity_map(to_identity_map(ch) - i)
            dch = dchi
        m += dch
    return m

ciphertext = "DJF_CTA_SWYH_NPDKK_MBZ_QPHTIGPMZY_KRZSQE?!_ZL_CN_PGLIMCU_YU_KJODME_RYGZXL"
plaintext = decrypt(ciphertext)
print(plaintext)
</code></pre></div><div class="cl-preview-section"><p><strong>Celebrating Victory:</strong></p></div><div class="cl-preview-section"><p>With the decryption script in hand, participants ran it to reveal the hidden message and claim their well-deserved victory.</p></div><div class="cl-preview-section"><pre><code>HTB{DID_YOU_KNOW_ABOUT_THE_TRITHEMIUS_CIPHER?!_IT_IS_SIMILAR_TO_CAESAR_CIPHER}
</code></pre></div><div class="cl-preview-section"><p><strong>Conclusion:</strong></p></div><div class="cl-preview-section"><p>The “Dynastic” challenge provided an exhilarating experience, combining cryptography and problem-solving skills under intense pressure. Participants emerged victorious by unraveling the mysteries within the encrypted message, ultimately escaping the grim fate of the gas chamber. As the Cyber Apocalypse 2024: Hacker Royale continued, participants braced themselves for even more thrilling challenges that lay ahead.</p></div><div class="cl-preview-section"><p>Stay tuned for more exciting CTF adventures!</p></div></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on Mar 16, 2024</p><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fsakibulalikhan.pages.dev%2Fdynastic-cyber-apocalypse-2024-hacker-royale-ctf-writeup.html" class="js-share invert facebook" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#facebook"/></svg> <span>Facebook</span> </a><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Fdynastic-cyber-apocalypse-2024-hacker-royale-ctf-writeup.html&amp;via=sakibulalikhan&amp;text=Dynastic%20-%20Cyber%20Apocalypse%202024%3A%20Hacker%20Royale%20CTF%20Writeup" class="js-share invert twitter" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#twitter"/></svg> <span>Twitter</span> </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Fdynastic-cyber-apocalypse-2024-hacker-royale-ctf-writeup.html&amp;media=https%3A%2F%2Fsakibulalikhan.pages.dev%2Fmedia%2Fposts%2F26%2FDynastic-Cyber-Apocalypse-2024-Hacker-Royale-CTF-Writeup.png&amp;description=Dynastic%20-%20Cyber%20Apocalypse%202024%3A%20Hacker%20Royale%20CTF%20Writeup" class="js-share invert pinterest" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#pinterest"/></svg> <span>Pinterest</span> </a><a href="https://mix.com/add?url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Fdynastic-cyber-apocalypse-2024-hacker-royale-ctf-writeup.html" class="js-share invert mix" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#mix"/></svg> <span>Mix</span> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Fdynastic-cyber-apocalypse-2024-hacker-royale-ctf-writeup.html" class="js-share invert linkedin" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#linkedin"/></svg> <span>LinkedIn</span> </a><a href="https://buffer.com/add?text=Dynastic%20-%20Cyber%20Apocalypse%202024%3A%20Hacker%20Royale%20CTF%20Writeup&amp;url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Fdynastic-cyber-apocalypse-2024-hacker-royale-ctf-writeup.html" class="js-share invert buffer" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#buffer"/></svg> <span>Buffer</span> </a><a href="https://api.whatsapp.com/send?text=Dynastic%20-%20Cyber%20Apocalypse%202024%3A%20Hacker%20Royale%20CTF%20Writeup https%3A%2F%2Fsakibulalikhan.pages.dev%2Fdynastic-cyber-apocalypse-2024-hacker-royale-ctf-writeup.html" class="js-share invert whatsapp" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#whatsapp"/></svg> <span>WhatsApp</span></a></div></footer><nav class="pagination"><div class="pagination__title"><span>Read other posts</span></div><div class="pagination__buttons"><a href="https://sakibulalikhan.pages.dev/hackviser-command-injection-filter-bypass.html" class="btn previous" rel="prev" aria-label="[MISSING TRANSLATION]:  Hackviser - Command Injection Filter Bypass "><span class="btn__icon">←</span> <span class="btn__text">Hackviser - Command Injection Filter Bypass</span> </a><a href="https://sakibulalikhan.pages.dev/makeshift-cyber-apocalypse-2024-hacker-royale-ctf-writeup.html" class="btn next" rel="next" aria-label="[MISSING TRANSLATION]:  Makeshift - Cyber Apocalypse 2024: Hacker Royale CTF Writeup "><span class="btn__text">Makeshift - Cyber Apocalypse 2024: Hacker Royale CTF Writeup</span> <span class="btn__icon">→</span></a></div></nav></article><div class="post__comments"><div class="comments"><div class="comments-wrapper"><h2>Comments</h2><div id="disqus_thread"></div><noscript>Please enable JS to use the comments form.</noscript><script type="text/javascript">var disqus_config = function () {
							this.page.url = 'https://sakibulalikhan.pages.dev/dynastic-cyber-apocalypse-2024-hacker-royale-ctf-writeup.html';
							this.page.identifier = '26'; 
							this.language = 'en_US';
						};
						
						
				var disqus_element_to_check = document.getElementById('disqus_thread');

				if ('IntersectionObserver' in window) {
					var iObserver = new IntersectionObserver(
						(entries, observer) => {
							entries.forEach(entry => {
								if (entry.intersectionRatio >= 0.1) {
									(function () {
										var d = document, s = d.createElement('script');
										s.src = 'https://'+('sakibulalikhan-github-io').trim()+'.disqus.com/embed.js';
										s.setAttribute('data-timestamp', +new Date());
										(d.head || d.body).appendChild(s);
									})();
									observer.unobserve(entry.target);
								}
							});
						},
						{
							threshold: [0, 0.2, 0.5, 1]
						}
					);

					iObserver.observe(disqus_element_to_check);
				} else {
					(function () {
						var d = document, s = d.createElement('script');
						s.src = 'https://'+('sakibulalikhan-github-io').trim()+'.disqus.com/embed.js';
						s.setAttribute('data-timestamp', +new Date());
						(d.head || d.body).appendChild(s);
					})();
				}</script><script type="text/javascript"></script></div></div></div></main><footer class="footer"><div class="footer__inner"><div class="footer__copyright"><p class="align-center">Sakibul Ali Khan • © 2024 • Offens!ve Blogs</p></div></div></footer></div><script defer="defer" src="https://sakibulalikhan.pages.dev/assets/js/scripts.min.js?v=c2232aa7558e9517946129d2a1b8c770"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script><script defer="defer" src="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/prism.js"></script><script defer="defer" src="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/prism-line-numbers.min.js"></script><script defer="defer" src="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/clipboard.min.js"></script><script defer="defer" src="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/prism-copy-to-clipboard.min.js"></script><script src="https://sakibulalikhan.pages.dev/media/plugins/pagePrefetching/quicklink.umd.js"></script><script>window.addEventListener('load', () => {
					quicklink.listen({
						prerender: false,
						el: document.querySelector('body'),
						delay: 0,
						limit: Infinity,
						throttle: Infinity,
						timeout: 2000
					});
				});</script></body></html>